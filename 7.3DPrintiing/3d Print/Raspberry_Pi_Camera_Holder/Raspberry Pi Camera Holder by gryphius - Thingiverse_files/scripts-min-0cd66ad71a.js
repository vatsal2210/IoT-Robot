var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function u(u){return u}function e(){return!1}function a(){}function r(){}a.prototype={chain:function(e,a){var r=this[e];if(!r)throw new Error("unknown hook "+e);this[e]=r===u?a:function(){var u=Array.prototype.slice.call(arguments,0);return u[0]=r.apply(null,u),a.apply(null,u)}},set:function(u,e){if(!this[u])throw new Error("unknown hook "+u);this[u]=e},addNoop:function(e){this[e]=u},addFalse:function(u){this[u]=e}},Markdown.HookCollection=a,r.prototype={set:function(u,e){this["s_"+u]=e},get:function(u){return this["s_"+u]}},Markdown.Converter=function(e){function n(u){return u=u.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(\n+)/gm,function(u,e,a,r,n,t,c){return e=e.toLowerCase(),O.set(e,x(a)),n?r+c:(t&&Q.set(e,t.replace(/"/g,"&quot;")),"")})}function t(u){return u=u.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,f),u=u.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,f),u=u.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,f),u=u.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,f),u=u.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,f)}function c(u){return u=u.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(z.push(u)-1)+"K\n\n"}function f(u,e){return c(e)}function o(u,e,a){u=K.preBlockGamut(u,T),u=h(u);var r="<hr />\n";return u=u.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,r),u=u.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,r),u=u.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,r),u=v(u),u=_(u),u=S(u),u=K.postBlockGamut(u,T),u=t(u),u=A(u,e,a)}function d(u){return u=K.preSpanGamut(u),u=$(u),u=p(u),u=W(u),u=b(u),u=i(u),u=N(u),u=u.replace(/~P/g,"://"),u=x(u),u=P(u),u=u.replace(/  +\n/g," <br>\n"),u=K.postSpanGamut(u)}function p(u){var e=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return u=u.replace(e,function(u){var e=u.replace(/(.)<\/?code>(?=.)/g,"$1`");return e=D(e,"!"==u.charAt(1)?"\\`*_/":"\\`*_")})}function i(u){return-1===u.indexOf("[")?u:(u=u.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,l),u=u.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,l),u=u.replace(/(\[([^\[\]]+)\])()()()()()/g,l))}function l(u,e,a,r,n,t,c,f){void 0==f&&(f="");var o=e,d=a.replace(/:\/\//g,"~P"),p=r.toLowerCase(),i=n,l=f;if(""==i)if(""==p&&(p=d.toLowerCase().replace(/ ?\n/g," ")),i="#"+p,void 0!=O.get(p))i=O.get(p),void 0!=Q.get(p)&&(l=Q.get(p));else{if(!(o.search(/\(\s*\)$/m)>-1))return o;i=""}i=q(i);var b='<a href="'+i+'"';return""!=l&&(l=g(l),l=D(l,"*_"),b+=' title="'+l+'"'),b+=">"+d+"</a>"}function b(u){return-1===u.indexOf("![")?u:(u=u.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,s),u=u.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,s))}function g(u){return u.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(u,e,a,r,n,t,c,f){var o=e,d=a,p=r.toLowerCase(),i=n,l=f;if(l||(l=""),""==i){if(""==p&&(p=d.toLowerCase().replace(/ ?\n/g," ")),i="#"+p,void 0==O.get(p))return o;i=O.get(p),void 0!=Q.get(p)&&(l=Q.get(p))}d=D(g(d),"*_[]()"),i=D(i,"*_");var b='<img src="'+i+'" alt="'+d+'"';return l=g(l),l=D(l,"*_"),b+=' title="'+l+'"',b+=" />"}function h(u){return u=u.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(u,e){return"<h1>"+d(e)+"</h1>\n\n"}),u=u.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(u,e){return"<h2>"+d(e)+"</h2>\n\n"}),u=u.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(u,e,a){var r=e.length;return"<h"+r+">"+d(a)+"</h"+r+">\n\n"})}function v(u,e){u+="~0";var a=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return B?u=u.replace(a,function(u,a,r){var n,t=a,c=r.search(/[*+-]/g)>-1?"ul":"ol";"ol"===c&&(n=parseInt(r,10));var f=m(t,c,e);f=f.replace(/\s+$/,"");var o="<"+c;return n&&1!==n&&(o+=' start="'+n+'"'),f=o+">"+f+"</"+c+">\n"}):(a=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,u=u.replace(a,function(u,e,a,r){var n,t=e,c=a,f=r.search(/[*+-]/g)>-1?"ul":"ol";"ol"===f&&(n=parseInt(r,10));var o=m(c,f),d="<"+f;return n&&1!==n&&(d+=' start="'+n+'"'),o=t+d+">\n"+o+"</"+f+">\n"})),u=u.replace(/~0/,"")}function m(u,e){B++,u=u.replace(/\n{2,}$/,"\n"),u+="~0";var a=Z[e],r=new RegExp("(^[ \\t]*)("+a+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+a+")[ \\t]+))","gm"),n=!1;return u=u.replace(r,function(u,e,a,r){var t=r,c=/\n\n$/.test(t),f=c||t.search(/\n{2,}/)>-1,d=f||n;return t=o(G(t),!0,!d),n=c,"<li>"+t+"</li>\n"}),u=u.replace(/~0/g,""),B--,u}function _(u){return u+="~0",u=u.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(u,e,a){var r=e,n=a;return r=w(G(r)),r=L(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code>"+r+"\n</code></pre>","\n\n"+r+"\n\n"+n}),u=u.replace(/~0/,"")}function $(u){return u=u.replace(/(^|[^\\`])(`+)(?!`)([^\r]*?[^`])\2(?!`)/gm,function(u,e,a,r){var n=r;return n=n.replace(/^([ \t]*)/g,""),n=n.replace(/[ \t]*$/g,""),n=w(n),n=n.replace(/:\/\//g,"~P"),e+"<code>"+n+"</code>"})}function w(u){return u=u.replace(/&/g,"&"),u=u.replace(/</g,"&lt;"),u=u.replace(/>/g,"&gt;"),u=D(u,"*_{}[]\\",!1)}function C(u){return-1===u.indexOf("*")&&-1===u.indexOf("_")?u:(u=I(u),u=u.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)\2(?=\S)([^\r]*?\S)\2\2(?!\2)(?=[\W_]|$)/g,"$1<strong>$3</strong>"),u=u.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)(?=\S)((?:(?!\2)[^\r])*?\S)\2(?!\2)(?=[\W_]|$)/g,"$1<em>$3</em>"),M(u))}function k(u){return-1===u.indexOf("*")&&-1===u.indexOf("_")?u:(u=I(u),u=u.replace(/(?=[^\r][*_]|[*_])(^|(?=\W__|(?!\*)[\W_]\*\*|\w\*\*\w)[^\r])(\*\*|__)(?!\2)(?=\S)((?:|[^\r]*?(?!\2)[^\r])(?=\S_|\w|\S\*\*(?:[\W_]|$)).)(?=__(?:\W|$)|\*\*(?:[^*]|$))\2/g,"$1<strong>$3</strong>"),u=u.replace(/(?=[^\r][*_]|[*_])(^|(?=\W_|(?!\*)(?:[\W_]\*|\D\*(?=\w)\D))[^\r])(\*|_)(?!\2\2\2)(?=\S)((?:(?!\2)[^\r])*?(?=[^\s_]_|(?=\w)\D\*\D|[^\s*]\*(?:[\W_]|$)).)(?=_(?:\W|$)|\*(?:[^*]|$))\2/g,"$1<em>$3</em>"),M(u))}function S(u){return u=u.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(u,e){var a=e;return a=a.replace(/^[ \t]*>[ \t]?/gm,"~0"),a=a.replace(/~0/g,""),a=a.replace(/^[ \t]+$/gm,""),a=o(a),a=a.replace(/(^|\n)/g,"$1  "),a=a.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(u,e){var a=e;return a=a.replace(/^  /gm,"~0"),a=a.replace(/~0/g,"")}),c("<blockquote>\n"+a+"\n</blockquote>")})}function A(u,e,a){u=u.replace(/^\n+/g,""),u=u.replace(/\n+$/g,"");for(var r=u.split(/\n{2,}/g),n=[],t=/~K(\d+)K/,c=r.length,f=0;c>f;f++){var o=r[f];t.test(o)?n.push(o):/\S/.test(o)&&(o=d(o),o=o.replace(/^([ \t]*)/g,a?"":"<p>"),a||(o+="</p>"),n.push(o))}if(!e){c=n.length;for(var f=0;c>f;f++)for(var p=!0;p;)p=!1,n[f]=n[f].replace(/~K(\d+)K/g,function(u,e){return p=!0,z[e]})}return n.join("\n\n")}function x(u){return u=u.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&"),u=u.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function W(u){return u=u.replace(/\\(\\)/g,R),u=u.replace(/\\([`*_{}\[\]()>#+-.!])/g,R)}function E(u,e,a,r){if(e)return u;if(")"!==r.charAt(r.length-1))return"<"+a+r+">";for(var n=r.match(/[()]/g),t=0,c=0;c<n.length;c++)"("===n[c]?0>=t?t=1:t++:t--;var f="";if(0>t){var o=new RegExp("\\){1,"+-t+"}$");r=r.replace(o,function(u){return f=u,""})}if(f){var d=r.charAt(r.length-1);X.test(d)||(f=d+f,r=r.substr(0,r.length-1))}return"<"+a+r+">"+f}function N(u){u=u.replace(F,E);var e=function(u,e){var a=q(e);return'<a href="'+a+'">'+K.plainLinkText(e)+"</a>"};return u=u.replace(/<((https?|ftp):[^'">\s]+)>/gi,e)}function y(u){return u=u.replace(/~E(\d+)E/g,function(u,e){var a=parseInt(e);return String.fromCharCode(a)})}function G(u){return u=u.replace(/^(\t|[ ]{1,4})/gm,"~0"),u=u.replace(/~0/g,"")}function L(u){if(!/\t/.test(u))return u;var e,a=["    ","   ","  "," "],r=0;return u.replace(/[\n\t]/g,function(u,n){return"\n"===u?(r=n+1,u):(e=(n-r)%4,r=n+1,a[e])})}function q(u){return u=g(u),u=D(u,"*_:()[]")}function D(u,e,a){var r="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";a&&(r="\\\\"+r);var n=new RegExp(r,"g");return u=u.replace(n,R)}function R(u,e){var a=e.charCodeAt(0);return"~E"+a+"E"}var K=this.hooks=new a;K.addNoop("plainLinkText"),K.addNoop("preConversion"),K.addNoop("postNormalization"),K.addNoop("preBlockGamut"),K.addNoop("postBlockGamut"),K.addNoop("preSpanGamut"),K.addNoop("postSpanGamut"),K.addNoop("postConversion");var O,Q,z,B;e=e||{};var I=u,M=u;e.nonAsciiLetters&&!function(){var u=/[Q\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376-\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u064a\u0660-\u0669\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07c0-\u07ea\u07f4-\u07f5\u07fa\u0904-\u0939\u093d\u0950\u0958-\u0961\u0966-\u096f\u0971-\u0972\u097b-\u097f\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0be6-\u0bef\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60-\u0d61\u0d66-\u0d6f\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e50-\u0e59\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edd\u0f00\u0f20-\u0f29\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1000-\u102a\u103f-\u1049\u1050-\u1055\u105a-\u105d\u1061\u1065-\u1066\u106e-\u1070\u1075-\u1081\u108e\u1090-\u1099\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1877\u1880-\u18a8\u18aa\u1900-\u191c\u1946-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u19d0-\u19d9\u1a00-\u1a16\u1b05-\u1b33\u1b45-\u1b4b\u1b50-\u1b59\u1b83-\u1ba0\u1bae-\u1bb9\u1c00-\u1c23\u1c40-\u1c49\u1c4d-\u1c7d\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u203f-\u2040\u2054\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183-\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c6f\u2c71-\u2c7d\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fc3\ua000-\ua48c\ua500-\ua60c\ua610-\ua62b\ua640-\ua65f\ua662-\ua66e\ua67f-\ua697\ua717-\ua71f\ua722-\ua788\ua78b-\ua78c\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8d0-\ua8d9\ua900-\ua925\ua930-\ua946\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa50-\uaa59\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe33-\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/g,e="Q".charCodeAt(0),a="A".charCodeAt(0),r="Z".charCodeAt(0),n="a".charCodeAt(0)-r-1;I=function(t){return t.replace(u,function(u){for(var t,c=u.charCodeAt(0),f="";c>0;)t=c%51+a,t>=e&&t++,t>r&&(t+=n),f=String.fromCharCode(t)+f,c=c/51|0;return"Q"+f+"Q"})},M=function(u){return u.replace(/Q([A-PR-Za-z]{1,3})Q/g,function(u,t){for(var c,f=0,o=0;o<t.length;o++)c=t.charCodeAt(o),c>r&&(c-=n),c>e&&c--,c-=a,f=51*f+c;return String.fromCharCode(f)})}}();var P=e.asteriskIntraWordEmphasis?k:C;this.makeHtml=function(u){if(O)throw new Error("Recursive call to converter.makeHtml");return O=new r,Q=new r,z=[],B=0,u=K.preConversion(u),u=u.replace(/~/g,"~T"),u=u.replace(/\$/g,"~D"),u=u.replace(/\r\n/g,"\n"),u=u.replace(/\r/g,"\n"),u="\n\n"+u+"\n\n",u=L(u),u=u.replace(/^[ \t]+$/gm,""),u=K.postNormalization(u),u=t(u),u=n(u),u=o(u),u=y(u),u=u.replace(/~D/g,"$$"),u=u.replace(/~T/g,"~"),u=K.postConversion(u),z=Q=O=null,u};var T=function(u){return o(u)},Z={ol:"\\d+[.]",ul:"[*+-]"},H="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",j="[-A-Z0-9+&@#/%=~_|[\\])]",F=new RegExp('(="|<)?\\b(https?|ftp)(://'+H+"*"+j+")(?=$|\\W)","gi"),X=new RegExp(j,"i")}}();!function(){function r(r){return r.replace(/<[^>]*>?/gi,t)}function t(r){return r.match(i)||r.match(s)||r.match(a)?r:""}function e(r){if(""==r)return"";var t=/<\/?\w+[^>]*(\s|$|>)/g,e=r.toLowerCase().match(t),n=(e||[]).length;if(0==n)return r;for(var o,i,s,a="<p><img><br><li><hr>",c=[],h=[],u=!1,f=0;n>f;f++)if(o=e[f].replace(/<\/?(\w+).*/,"$1"),!(c[f]||a.search("<"+o+">")>-1)){if(i=e[f],s=-1,!/^<\//.test(i))for(var p=f+1;n>p;p++)if(!c[p]&&e[p]=="</"+o+">"){s=p;break}-1==s?u=h[f]=!0:c[s]=!0}if(!u)return r;var f=0;return r=r.replace(t,function(r){var t=h[f]?"":r;return f++,t})}var n,o;"object"==typeof exports&&"function"==typeof require?(n=exports,o=require("./Markdown.Converter").Converter):(n=window.Markdown,o=n.Converter),n.getSanitizingConverter=function(){var t=new o;return t.hooks.chain("postConversion",r),t.hooks.chain("postConversion",e),t};var i=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol(?: start="\d+")?|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,s=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)*[\]$]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,a=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)*[\]$]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i}();!function($){"use strict";var Modal=function(element,options){this.init(element,options)};Modal.prototype={constructor:Modal,init:function(element,options){this.options=options;this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote);var manager=typeof this.options.manager==="function"?this.options.manager.call(this):this.options.manager;manager=manager.appendModal?manager:$(manager).modalmanager().data("modalmanager");manager.appendModal(this)},toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var that=this,e=$.Event("show");if(this.isShown)return;this.$element.triggerHandler(e);if(e.isDefaultPrevented())return;if(this.options.width){this.$element.css("width",this.options.width);var that=this;this.$element.css("margin-left",function(){if(/%/gi.test(that.options.width)){return-(parseInt(that.options.width)/2)+"%"}else{return-($(this).width()/2)+"px"}})}var prop=this.options.height?"height":"max-height";var value=this.options.height||this.options.maxHeight;if(value){this.$element.find(".modal-body").css("overflow","auto").css(prop,value)}this.escape();this.tab();this.options.loading&&this.loading()},hide:function(e){e&&e.preventDefault();e=$.Event("hide");this.$element.triggerHandler(e);if(!this.isShown||e.isDefaultPrevented())return this.isShown=false;this.isShown=false;this.escape();this.tab();this.isLoading&&this.loading();$(document).off("focusin.modal");this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",true);$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},tab:function(){var that=this;if(this.isShown&&this.options.consumeTab){this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(e){if(e.keyCode&&e.keyCode==9){var $next=$(this),$rollover=$(this);that.$element.find("[data-tabindex]:enabled:not([readonly])").each(function(e){if(!e.shiftKey){$next=$next.data("tabindex")<$(this).data("tabindex")?$next=$(this):$rollover=$(this)}else{$next=$next.data("tabindex")>$(this).data("tabindex")?$next=$(this):$rollover=$(this)}});$next[0]!==$(this)[0]?$next.focus():$rollover.focus();e.preventDefault()}})}else if(!this.isShown){this.$element.off("keydown.tabindex.modal")}},escape:function(){var that=this;if(this.isShown&&this.options.keyboard){if(!this.$element.attr("tabindex"))this.$element.attr("tabindex",-1);this.$element.on("keyup.dismiss.modal",function(e){e.which==27&&that.hide()})}else if(!this.isShown){this.$element.off("keyup.dismiss.modal")}},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end);that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout);that.hideModal()})},hideModal:function(){this.$element.hide().triggerHandler("hidden");var prop=this.options.height?"height":"max-height";var value=this.options.height||this.options.maxHeight;if(value){this.$element.find(".modal-body").css("overflow","").css(prop,"")}},removeLoading:function(){this.$loading.remove();this.$loading=null;this.isLoading=false},loading:function(callback){callback=callback||function(){};var animate=this.$element.hasClass("fade")?"fade":"";if(!this.isLoading){var doAnimate=$.support.transition&&animate;this.$loading=$('<div class="loading-mask '+animate+'">').append(this.options.spinner).appendTo(this.$element);if(doAnimate)this.$loading[0].offsetWidth;this.$loading.addClass("in");this.isLoading=true;doAnimate?this.$loading.one($.support.transition.end,callback):callback()}else if(this.isLoading&&this.$loading){this.$loading.removeClass("in");var that=this;$.support.transition&&this.$element.hasClass("fade")?this.$loading.one($.support.transition.end,function(){that.removeLoading()}):that.removeLoading()}else if(callback){callback(this.isLoading)}},focus:function(){var $focusElem=this.$element.find(this.options.focusOn);$focusElem=$focusElem.length?$focusElem:this.$element;$focusElem.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var that=this;setTimeout(function(){that.$element.addClass("animated").addClass(that.options.attentionAnimation)},0)}this.focus()},destroy:function(){var e=$.Event("destroy");this.$element.triggerHandler(e);if(e.isDefaultPrevented())return;this.teardown()},teardown:function(){if(!this.$parent.length){this.$element.remove();this.$element=null;return}if(this.$parent!==this.$element.parent()){this.$element.appendTo(this.$parent)}this.$element.off(".modal");this.$element.removeData("modal");this.$element.removeClass("in").attr("aria-hidden",true)}};$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),typeof option=="object"&&option);if(!data)$this.data("modal",data=new Modal(this,options));if(typeof option=="string")data[option]();else if(options.show)data.show()})};$.fn.modal.defaults={keyboard:true,backdrop:true,loading:false,show:true,width:null,height:null,maxHeight:null,modalOverflow:false,consumeTab:true,focusOn:null,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'};$.fn.modal.Constructor=Modal;$(function(){$(document).off(".modal").on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault();$target.modal(option).one("hide",function(){$this.focus()})})})}(window.jQuery);
!function($){"use strict";var ModalManager=function(element,options){this.init(element,options)};ModalManager.prototype={constructor:ModalManager,init:function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.modalmanager.defaults,this.$element.data(),typeof options=="object"&&options);this.stack=[];this.backdropCount=0},createModal:function(element,options){$(element).modal($.extend({manager:this},options))},appendModal:function(modal){this.stack.push(modal);var that=this;modal.$element.on("show.modalmanager",targetIsSelf(function(e){modal.isShown=true;var transition=$.support.transition&&modal.$element.hasClass("fade");that.$element.toggleClass("modal-open",that.hasOpenModal()).toggleClass("page-overflow",$(window).height()<that.$element.height());modal.$parent=modal.$element.parent();modal.$container=that.createContainer(modal);modal.$element.appendTo(modal.$container);var modalOverflow=$(window).height()<modal.$element.height()||modal.options.modalOverflow;that.backdrop(modal,function(){modal.$element.show();if(transition){modal.$element[0].style.display="run-in";modal.$element[0].offsetWidth;modal.$element.one($.support.transition.end,function(){modal.$element[0].style.display="block"})}modal.$element.toggleClass("modal-overflow",modalOverflow).css("margin-top",modalOverflow?0:0-modal.$element.height()/2).addClass("in").attr("aria-hidden",false);var complete=function(){that.setFocus();modal.$element.triggerHandler("shown")};transition?modal.$element.one($.support.transition.end,complete):complete()})}));modal.$element.on("hidden.modalmanager",targetIsSelf(function(e){that.backdrop(modal);if(modal.$backdrop){$.support.transition&&modal.$element.hasClass("fade")?modal.$backdrop.one($.support.transition.end,function(){that.destroyModal(modal)}):that.destroyModal(modal)}else{that.destroyModal(modal)}}));modal.$element.on("destroy.modalmanager",targetIsSelf(function(e){that.removeModal(modal)}))},destroyModal:function(modal){modal.destroy();var hasOpenModal=this.hasOpenModal();this.$element.toggleClass("modal-open",hasOpenModal);if(!hasOpenModal){this.$element.removeClass("page-overflow")}this.removeContainer(modal);this.setFocus()},hasOpenModal:function(){for(var i=0;i<this.stack.length;i++){if(this.stack[i].isShown)return true}return false},setFocus:function(){var topModal;for(var i=0;i<this.stack.length;i++){if(this.stack[i].isShown)topModal=this.stack[i]}if(!topModal)return;topModal.focus()},removeModal:function(modal){modal.$element.off(".modalmanager");if(modal.$backdrop)this.removeBackdrop.call(modal);this.stack.splice(this.getIndexOfModal(modal),1)},getModalAt:function(index){return this.stack[index]},getIndexOfModal:function(modal){for(var i=0;i<this.stack.length;i++){if(modal===this.stack[i])return i}},removeBackdrop:function(modal){modal.$backdrop.remove();modal.$backdrop=null},createBackdrop:function(animate){var $backdrop;if(!this.isLoading){$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(this.$element)}else{$backdrop=this.$loading;$backdrop.off(".modalmanager");this.$spinner.remove();this.isLoading=false;this.$loading=this.$spinner=null}return $backdrop},removeContainer:function(modal){modal.$container.remove();modal.$container=null},createContainer:function(modal){var $container;$container=$('<div class="modal-scrollable">').css("z-index",getzIndex("modal",modal?this.getIndexOfModal(modal):this.stack.length)).appendTo(this.$element);if(modal&&modal.options.backdrop!="static"){$container.on("click.modal",targetIsSelf(function(e){modal.hide()}))}else if(modal){$container.on("click.modal",targetIsSelf(function(e){modal.attention()}))}return $container},backdrop:function(modal,callback){var animate=modal.$element.hasClass("fade")?"fade":"",showBackdrop=modal.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(modal.isShown&&showBackdrop){var doAnimate=$.support.transition&&animate&&!this.isLoading;modal.$backdrop=this.createBackdrop(animate);modal.$backdrop.css("z-index",getzIndex("backdrop",this.getIndexOfModal(modal)));if(doAnimate)modal.$backdrop[0].offsetWidth;modal.$backdrop.addClass("in");this.backdropCount+=1;doAnimate?modal.$backdrop.one($.support.transition.end,callback):callback()}else if(!modal.isShown&&modal.$backdrop){modal.$backdrop.removeClass("in");this.backdropCount-=1;var that=this;$.support.transition&&modal.$element.hasClass("fade")?modal.$backdrop.one($.support.transition.end,function(){that.removeBackdrop(modal)}):that.removeBackdrop(modal)}else if(callback){callback()}},removeLoading:function(){this.$loading&&this.$loading.remove();this.$loading=null;this.isLoading=false},loading:function(callback){callback=callback||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",$(window).height()<this.$element.height());if(!this.isLoading){this.$loading=this.createBackdrop("fade");this.$loading[0].offsetWidth;this.$loading.css("z-index",getzIndex("backdrop",this.stack.length)).addClass("in");var $spinner=$(this.options.spinner).css("z-index",getzIndex("modal",this.stack.length)).appendTo(this.$element).addClass("in");this.$spinner=$(this.createContainer()).append($spinner).on("click.modalmanager",$.proxy(this.loading,this));this.isLoading=true;$.support.transition?this.$loading.one($.support.transition.end,callback):callback()}else if(this.isLoading&&this.$loading){this.$loading.removeClass("in");if(this.$spinner)this.$spinner.remove();var that=this;$.support.transition?this.$loading.one($.support.transition.end,function(){that.removeLoading()}):that.removeLoading()}else if(callback){callback(this.isLoading)}}};var getzIndex=function(){var zIndexFactor,baseIndex={};return function(type,pos){if(typeof zIndexFactor==="undefined"){var $baseModal=$('<div class="modal hide" />').appendTo("body"),$baseBackdrop=$('<div class="modal-backdrop hide" />').appendTo("body");baseIndex["modal"]=+$baseModal.css("z-index"),baseIndex["backdrop"]=+$baseBackdrop.css("z-index"),zIndexFactor=baseIndex["modal"]-baseIndex["backdrop"];$baseModal.remove();$baseBackdrop.remove();$baseBackdrop=$baseModal=null}return baseIndex[type]+zIndexFactor*pos}}();function targetIsSelf(callback){return function(e){if(this===e.target){return callback.apply(this,arguments)}}}$.fn.modalmanager=function(option){return this.each(function(){var $this=$(this),data=$this.data("modalmanager");if(!data)$this.data("modalmanager",data=new ModalManager(this,option));if(typeof option==="string")data[option]()})};$.fn.modalmanager.defaults={backdropLimit:999,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>'};$.fn.modalmanager.Constructor=ModalManager}(jQuery);
!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".item.active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle()),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0]});if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(document).on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;return n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=e(n),r.length||(r=t.parent()),r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||(s.toggleClass("open"),n.focus()),!1},keydown:function(t){var n,r,s,o,u,a;if(!/(38|40|27)/.test(t.keyCode))return;n=e(this),t.preventDefault(),t.stopPropagation();if(n.is(".disabled, :disabled"))return;o=i(n),u=o.hasClass("open");if(!u||u&&t.keyCode==27)return n.click();r=e("[role=menu] li:not(.divider) a",o);if(!r.length)return;a=r.index(r.filter(":focus")),t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<r.length-1&&a++,~a||(a=0),r.eq(a).focus()}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(document).on("click.dropdown.data-api touchstart.dropdown.data-api",r).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.offset(o).addClass(s).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip();return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.detach(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);n[n.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!1}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&r.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))},e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);var Dialog=function(){var self={};self.opts={};self.cmds={file_select:{header:"Open File",button:"Open"},thing_select:{header:"Open Thing",button:"Open"},thing_save:{header:"Save Thing",button:"Save"},thing_search:{header:"Search Things",button:"Open"}};self.result=null;self.cmd="";self.access_code="";self.callback="";self.init=function(opts){self.opts=opts;$.receiveMessage(function(msg){self.receiveMessage(msg.data)},self.opts.target_url)};self.receiveMessage=function(data){msg=JSON.parse(data);self.cmd=msg.cmd;self.access_code=msg.access_code;self.callback=msg.params.callback;if($.inArray(msg.cmd,Object.keys(self.cmds))>-1){$("#dialog-body").html('<img src="/img/ajax-loader.gif"/>');$("#dialog-title").html(self.cmds[msg.cmd].header);$("#dialog-btn-open").html(self.cmds[msg.cmd].button);$("#dialog").modal({keyboard:false,show:true,backdrop:"static"}).on("shown",function(){$("body").css("overflow","hidden")});$("#dialog-body").load("/ajax/dialogs/"+msg.cmd,msg.params)}else if(msg.cmd=="echo"){self.log("Received Echo Request");Dialog.sendMessage(msg)}else{self.log('Received Unknown Cmd: "'+msg.cmd+'" Data: '+data)}};self.sendMessage=function(data){msg=JSON.stringify({callback:self.callback,result:data});$.postMessage(msg,self.opts.target_url,self.opts.target)};self.close=function(){self.sendMessage({status:"cancelled"});$("#dialog").modal("hide");$("body").css("overflow","auto")};self.open=function(e){if(self.cmd=="thing_save"){if($("input:text[name=name]").val()===""){alert("You must enter a name.");$("input:text[name=name]").focus();return false}if($("select[name=category]").val()===""){alert("You must select a category.");$("select[name=category]").focus();return false}if($("select[name=license]").val()===""){alert("You must select a license.");$("select[name=license]").focus();return false}self.result={name:$("input:text[name=name]").val(),description:$("textarea[name=description]").val(),category:$("select[name=category] option:selected").val(),tags:$("input:text[name=tags]").val(),license:$("select[name=license] option:selected").val(),is_published:$("input[name=is_published]:checked").val(),is_wip:$("input[name=is_wip]:checked").val()}}if(self.result!==null){self.sendMessage(self.result);self.result=null;$("#dialog").modal("hide");$("body").css("overflow","auto")}else{alert("Nothing Selected!")}};self.selectListItem=function(e,result){self.result=result;$(".dialog-list-item").each(function(){$(this).removeClass("selected")});$(e).addClass("selected")};self.log=function(msg){if(window.console){console.log("[THINGIVERSE] "+msg)}};return self}();$("[id^=tab-]").live("mouseover",function(){if(!$(this).hasClass("selected")){$("#marker-"+$(this).attr("id")).show()}});$("[id^=tab-]").live("mouseout",function(){if(!$(this).hasClass("selected")){$("#marker-"+$(this).attr("id")).hide()}});$("[id^=tab-]").live("click",function(){if(!$(this).hasClass("selected")){$("[id^=tab-]").each(function(){$(this).removeClass("selected")});$("[id^=marker-tab-]").each(function(){$(this).hide()});$(this).addClass("selected");$("#marker-"+$(this).attr("id")).show();$("#dialog-list").html('<img src="/img/ajax-loader.gif"/>');$.ajax({url:"/ajax/dialogs/list_"+$(this).attr("id").match(/-(.*)/)[1]+"_things"}).done(function(html){$("#dialog-list").html(html)})}});$("#dialog-search-q, #dialog-search-tags").live("keypress",function(e){if(e.which==13){e.preventDefault();$.ajax({url:"/ajax/dialogs/thing_search",data:{q:$("#dialog-search-q").val(),tags:$("#dialog-search-tags").val()}}).done(function(html){$("#dialog-body").html(html)})}});$("#view-more-button").live("click",function(e){if(page<pages){page++;$("#view-more-status").show();$.ajax({url:"/ajax/dialogs/thing_search_results",data:{q:$("#dialog-search-q").val(),page:page}}).done(function(html){$("#dialog-search-results").append(html);$("#view-more-status").hide();if(page>=pages){$("#view-more-button").hide()}})}});!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.sortable=t(e.jQuery)}(this,function(e){"use strict";var t,a,r=e(),n=[],i=function(e){e.off("dragstart.h5s"),e.off("dragend.h5s"),e.off("selectstart.h5s"),e.off("dragover.h5s"),e.off("dragenter.h5s"),e.off("drop.h5s")},d=function(e){e.off("dragover.h5s"),e.off("dragenter.h5s"),e.off("drop.h5s")},o=function(e,t){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text",""),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(t.item,t.x,t.y)},s=function(e,t){return t.x||(t.x=parseInt(e.pageX-t.draggedItem.offset().left)),t.y||(t.y=parseInt(e.pageY-t.draggedItem.offset().top)),t},f=function(e){return{item:e[0],draggedItem:e}},l=function(e,t){var a=f(t);a=s(e,a),o(e,a)},h=function(e,t){return"undefined"==typeof e?t:e},g=function(e){e.removeData("opts"),e.removeData("connectWith"),e.removeData("items"),e.removeAttr("aria-dropeffect")},c=function(e){e.removeAttr("aria-grabbed"),e.removeAttr("draggable"),e.removeAttr("role")},u=function(e,t){return e[0]===t[0]?!0:void 0!==e.data("connectWith")?e.data("connectWith")===t.data("connectWith"):!1},p=function(e){var t=e.data("opts")||{},a=e.children(t.items),r=t.handle?a.find(t.handle):a;d(e),g(e),r.off("mousedown.h5s"),i(a),c(a)},m=function(t){var a=t.data("opts"),r=t.children(a.items),n=a.handle?r.find(a.handle):r;t.attr("aria-dropeffect","move"),n.attr("draggable","true"),"function"!=typeof document.createElement("span").dragDrop||a.disableIEFix||n.on("mousedown.h5s",function(){-1!==r.index(this)?this.dragDrop():e(this).parents(a.items)[0].dragDrop()})},v=function(e){var t=e.data("opts"),a=e.children(t.items),r=t.handle?a.find(t.handle):a;e.attr("aria-dropeffect","none"),r.attr("draggable",!1),r.off("mousedown.h5s")},b=function(e){var t=e.data("opts"),a=e.children(t.items),r=t.handle?a.find(t.handle):a;i(a),r.off("mousedown.h5s"),d(e)},x=function(i,d){var s=e(i),f=String(d);return d=e.extend({connectWith:!1,placeholder:null,dragImage:null,disableIEFix:!1,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging"},d),s.each(function(){var i=e(this);if(/enable|disable|destroy/.test(f))return void x[f](i);d=h(i.data("opts"),d),i.data("opts",d),b(i);var s,g,c,p=i.children(d.items),v=null===d.placeholder?e("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="'+d.placeholderClass+'"/>'):e(d.placeholder).addClass(d.placeholderClass);if(!i.attr("data-sortable-id")){var I=n.length;n[I]=i,i.attr("data-sortable-id",I),p.attr("data-item-sortable-id",I)}i.data("items",d.items),r=r.add(v),d.connectWith&&i.data("connectWith",d.connectWith),m(i),p.attr("role","option"),p.attr("aria-grabbed","false"),p.on("dragstart.h5s",function(r){r.stopImmediatePropagation(),d.dragImage?(o(r.originalEvent,{item:d.dragImage,x:0,y:0}),console.log("WARNING: dragImage option is deprecated and will be removed in the future!")):l(r.originalEvent,e(this),d.dragImage),t=e(this),t.addClass(d.draggingClass),t.attr("aria-grabbed","true"),s=t.index(),a=t.height(),g=e(this).parent(),t.parent().triggerHandler("sortstart",{item:t,startparent:g})}),p.on("dragend.h5s",function(){t&&(t.removeClass(d.draggingClass),t.attr("aria-grabbed","false"),t.show(),r.detach(),c=e(this).parent(),t.parent().triggerHandler("sortstop",{item:t,startparent:g}),(s!==t.index()||g.get(0)!==c.get(0))&&t.parent().triggerHandler("sortupdate",{item:t,index:c.children(c.data("items")).index(t),oldindex:p.index(t),elementIndex:t.index(),oldElementIndex:s,startparent:g,endparent:c}),t=null,a=null)}),e(this).add([v]).on("drop.h5s",function(a){return u(i,e(t).parent())?(a.stopPropagation(),r.filter(":visible").after(t),t.trigger("dragend.h5s"),!1):void 0}),p.add([this,v]).on("dragover.h5s dragenter.h5s",function(n){if(u(i,e(t).parent())){if(n.preventDefault(),n.originalEvent.dataTransfer.dropEffect="move",p.is(this)){var o=e(this).height();if(d.forcePlaceholderSize&&v.height(a),o>a){var s=o-a,f=e(this).offset().top;if(v.index()<e(this).index()&&n.originalEvent.pageY<f+s)return!1;if(v.index()>e(this).index()&&n.originalEvent.pageY>f+o-s)return!1}t.hide(),v.index()<e(this).index()?e(this).after(v):e(this).before(v),r.not(v).detach()}else r.is(this)||e(this).children(d.items).length||(r.detach(),e(this).append(v));return!1}})})};return x.destroy=function(e){p(e)},x.enable=function(e){m(e)},x.disable=function(e){v(e)},e.fn.sortable=function(e){return x(this,e)},x});(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);(function($){function sc_setScroll(a,b,c){return"transition"==c.transition&&"swing"==b&&(b="ease"),{anims:[],duration:a,orgDuration:a,easing:b,startTime:getTime()}}function sc_startScroll(a,b){for(var c=0,d=a.anims.length;d>c;c++){var e=a.anims[c];e&&e[0][b.transition](e[1],a.duration,a.easing,e[2])}}function sc_stopScroll(a,b){is_boolean(b)||(b=!0),is_object(a.pre)&&sc_stopScroll(a.pre,b);for(var c=0,d=a.anims.length;d>c;c++){var e=a.anims[c];e[0].stop(!0),b&&(e[0].css(e[1]),is_function(e[2])&&e[2]())}is_object(a.post)&&sc_stopScroll(a.post,b)}function sc_afterScroll(a,b,c){switch(b&&b.remove(),c.fx){case"fade":case"crossfade":case"cover-fade":case"uncover-fade":a.css("opacity",1),a.css("filter","")}}function sc_fireCallbacks(a,b,c,d,e){if(b[c]&&b[c].call(a,d),e[c].length)for(var f=0,g=e[c].length;g>f;f++)e[c][f].call(a,d);return[]}function sc_fireQueue(a,b,c){return b.length&&(a.trigger(cf_e(b[0][0],c),b[0][1]),b.shift()),b}function sc_hideHiddenItems(a){a.each(function(){var a=$(this);a.data("_cfs_isHidden",a.is(":hidden")).hide()})}function sc_showHiddenItems(a){a&&a.each(function(){var a=$(this);a.data("_cfs_isHidden")||a.show()})}function sc_clearTimers(a){return a.auto&&clearTimeout(a.auto),a.progress&&clearInterval(a.progress),a}function sc_mapCallbackArguments(a,b,c,d,e,f,g){return{width:g.width,height:g.height,items:{old:a,skipped:b,visible:c},scroll:{items:d,direction:e,duration:f}}}function sc_getDuration(a,b,c,d){var e=a.duration;return"none"==a.fx?0:("auto"==e?e=b.scroll.duration/b.scroll.items*c:10>e&&(e=d/e),1>e?0:("fade"==a.fx&&(e/=2),Math.round(e)))}function nv_showNavi(a,b,c){var d=is_number(a.items.minimum)?a.items.minimum:a.items.visible+1;if("show"==b||"hide"==b)var e=b;else if(d>b){debug(c,"Not enough items ("+b+" total, "+d+" needed): Hiding navigation.");var e="hide"}else var e="show";var f="show"==e?"removeClass":"addClass",g=cf_c("hidden",c);a.auto.button&&a.auto.button[e]()[f](g),a.prev.button&&a.prev.button[e]()[f](g),a.next.button&&a.next.button[e]()[f](g),a.pagination.container&&a.pagination.container[e]()[f](g)}function nv_enableNavi(a,b,c){if(!a.circular&&!a.infinite){var d="removeClass"==b||"addClass"==b?b:!1,e=cf_c("disabled",c);if(a.auto.button&&d&&a.auto.button[d](e),a.prev.button){var f=d||0==b?"addClass":"removeClass";a.prev.button[f](e)}if(a.next.button){var f=d||b==a.items.visible?"addClass":"removeClass";a.next.button[f](e)}}}function go_getObject(a,b){return is_function(b)?b=b.call(a):is_undefined(b)&&(b={}),b}function go_getItemsObject(a,b){return b=go_getObject(a,b),is_number(b)?b={visible:b}:"variable"==b?b={visible:b,width:b,height:b}:is_object(b)||(b={}),b}function go_getScrollObject(a,b){return b=go_getObject(a,b),is_number(b)?b=50>=b?{items:b}:{duration:b}:is_string(b)?b={easing:b}:is_object(b)||(b={}),b}function go_getNaviObject(a,b){if(b=go_getObject(a,b),is_string(b)){var c=cf_getKeyCode(b);b=-1==c?$(b):c}return b}function go_getAutoObject(a,b){return b=go_getNaviObject(a,b),is_jquery(b)?b={button:b}:is_boolean(b)?b={play:b}:is_number(b)&&(b={timeoutDuration:b}),b.progress&&(is_string(b.progress)||is_jquery(b.progress))&&(b.progress={bar:b.progress}),b}function go_complementAutoObject(a,b){return is_function(b.button)&&(b.button=b.button.call(a)),is_string(b.button)&&(b.button=$(b.button)),is_boolean(b.play)||(b.play=!0),is_number(b.delay)||(b.delay=0),is_undefined(b.pauseOnEvent)&&(b.pauseOnEvent=!0),is_boolean(b.pauseOnResize)||(b.pauseOnResize=!0),is_number(b.timeoutDuration)||(b.timeoutDuration=10>b.duration?2500:5*b.duration),b.progress&&(is_function(b.progress.bar)&&(b.progress.bar=b.progress.bar.call(a)),is_string(b.progress.bar)&&(b.progress.bar=$(b.progress.bar)),b.progress.bar?(is_function(b.progress.updater)||(b.progress.updater=$.fn.carouFredSel.progressbarUpdater),is_number(b.progress.interval)||(b.progress.interval=50)):b.progress=!1),b}function go_getPrevNextObject(a,b){return b=go_getNaviObject(a,b),is_jquery(b)?b={button:b}:is_number(b)&&(b={key:b}),b}function go_complementPrevNextObject(a,b){return is_function(b.button)&&(b.button=b.button.call(a)),is_string(b.button)&&(b.button=$(b.button)),is_string(b.key)&&(b.key=cf_getKeyCode(b.key)),b}function go_getPaginationObject(a,b){return b=go_getNaviObject(a,b),is_jquery(b)?b={container:b}:is_boolean(b)&&(b={keys:b}),b}function go_complementPaginationObject(a,b){return is_function(b.container)&&(b.container=b.container.call(a)),is_string(b.container)&&(b.container=$(b.container)),is_number(b.items)||(b.items=!1),is_boolean(b.keys)||(b.keys=!1),is_function(b.anchorBuilder)||is_false(b.anchorBuilder)||(b.anchorBuilder=$.fn.carouFredSel.pageAnchorBuilder),is_number(b.deviation)||(b.deviation=0),b}function go_getSwipeObject(a,b){return is_function(b)&&(b=b.call(a)),is_undefined(b)&&(b={onTouch:!1}),is_true(b)?b={onTouch:b}:is_number(b)&&(b={items:b}),b}function go_complementSwipeObject(a,b){return is_boolean(b.onTouch)||(b.onTouch=!0),is_boolean(b.onMouse)||(b.onMouse=!1),is_object(b.options)||(b.options={}),is_boolean(b.options.triggerOnTouchEnd)||(b.options.triggerOnTouchEnd=!1),b}function go_getMousewheelObject(a,b){return is_function(b)&&(b=b.call(a)),is_true(b)?b={}:is_number(b)?b={items:b}:is_undefined(b)&&(b=!1),b}function go_complementMousewheelObject(a,b){return b}function gn_getItemIndex(a,b,c,d,e){if(is_string(a)&&(a=$(a,e)),is_object(a)&&(a=$(a,e)),is_jquery(a)?(a=e.children().index(a),is_boolean(c)||(c=!1)):is_boolean(c)||(c=!0),is_number(a)||(a=0),is_number(b)||(b=0),c&&(a+=d.first),a+=b,d.total>0){for(;a>=d.total;)a-=d.total;for(;0>a;)a+=d.total}return a}function gn_getVisibleItemsPrev(a,b,c){for(var d=0,e=0,f=c;f>=0;f--){var g=a.eq(f);if(d+=g.is(":visible")?g[b.d.outerWidth](!0):0,d>b.maxDimension)return e;0==f&&(f=a.length),e++}}function gn_getVisibleItemsPrevFilter(a,b,c){return gn_getItemsPrevFilter(a,b.items.filter,b.items.visibleConf.org,c)}function gn_getScrollItemsPrevFilter(a,b,c,d){return gn_getItemsPrevFilter(a,b.items.filter,d,c)}function gn_getItemsPrevFilter(a,b,c,d){for(var e=0,f=0,g=d,h=a.length;g>=0;g--){if(f++,f==h)return f;var i=a.eq(g);if(i.is(b)&&(e++,e==c))return f;0==g&&(g=h)}}function gn_getVisibleOrg(a,b){return b.items.visibleConf.org||a.children().slice(0,b.items.visible).filter(b.items.filter).length}function gn_getVisibleItemsNext(a,b,c){for(var d=0,e=0,f=c,g=a.length-1;g>=f;f++){var h=a.eq(f);if(d+=h.is(":visible")?h[b.d.outerWidth](!0):0,d>b.maxDimension)return e;if(e++,e==g+1)return e;f==g&&(f=-1)}}function gn_getVisibleItemsNextTestCircular(a,b,c,d){var e=gn_getVisibleItemsNext(a,b,c);return b.circular||c+e>d&&(e=d-c),e}function gn_getVisibleItemsNextFilter(a,b,c){return gn_getItemsNextFilter(a,b.items.filter,b.items.visibleConf.org,c,b.circular)}function gn_getScrollItemsNextFilter(a,b,c,d){return gn_getItemsNextFilter(a,b.items.filter,d+1,c,b.circular)-1}function gn_getItemsNextFilter(a,b,c,d){for(var f=0,g=0,h=d,i=a.length-1;i>=h;h++){if(g++,g>=i)return g;var j=a.eq(h);if(j.is(b)&&(f++,f==c))return g;h==i&&(h=-1)}}function gi_getCurrentItems(a,b){return a.slice(0,b.items.visible)}function gi_getOldItemsPrev(a,b,c){return a.slice(c,b.items.visibleConf.old+c)}function gi_getNewItemsPrev(a,b){return a.slice(0,b.items.visible)}function gi_getOldItemsNext(a,b){return a.slice(0,b.items.visibleConf.old)}function gi_getNewItemsNext(a,b,c){return a.slice(c,b.items.visible+c)}function sz_storeMargin(a,b,c){b.usePadding&&(is_string(c)||(c="_cfs_origCssMargin"),a.each(function(){var a=$(this),d=parseInt(a.css(b.d.marginRight),10);is_number(d)||(d=0),a.data(c,d)}))}function sz_resetMargin(a,b,c){if(b.usePadding){var d=is_boolean(c)?c:!1;is_number(c)||(c=0),sz_storeMargin(a,b,"_cfs_tempCssMargin"),a.each(function(){var a=$(this);a.css(b.d.marginRight,d?a.data("_cfs_tempCssMargin"):c+a.data("_cfs_origCssMargin"))})}}function sz_storeOrigCss(a){a.each(function(){var a=$(this);a.data("_cfs_origCss",a.attr("style")||"")})}function sz_restoreOrigCss(a){a.each(function(){var a=$(this);a.attr("style",a.data("_cfs_origCss")||"")})}function sz_setResponsiveSizes(a,b){var d=(a.items.visible,a.items[a.d.width]),e=a[a.d.height],f=is_percentage(e);b.each(function(){var b=$(this),c=d-ms_getPaddingBorderMargin(b,a,"Width");b[a.d.width](c),f&&b[a.d.height](ms_getPercentage(c,e))})}function sz_setSizes(a,b){var c=a.parent(),d=a.children(),e=gi_getCurrentItems(d,b),f=cf_mapWrapperSizes(ms_getSizes(e,b,!0),b,!1);if(c.css(f),b.usePadding){var g=b.padding,h=g[b.d[1]];b.align&&0>h&&(h=0);var i=e.last();i.css(b.d.marginRight,i.data("_cfs_origCssMargin")+h),a.css(b.d.top,g[b.d[0]]),a.css(b.d.left,g[b.d[3]])}return a.css(b.d.width,f[b.d.width]+2*ms_getTotalSize(d,b,"width")),a.css(b.d.height,ms_getLargestSize(d,b,"height")),f}function ms_getSizes(a,b,c){return[ms_getTotalSize(a,b,"width",c),ms_getLargestSize(a,b,"height",c)]}function ms_getLargestSize(a,b,c,d){return is_boolean(d)||(d=!1),is_number(b[b.d[c]])&&d?b[b.d[c]]:is_number(b.items[b.d[c]])?b.items[b.d[c]]:(c=c.toLowerCase().indexOf("width")>-1?"outerWidth":"outerHeight",ms_getTrueLargestSize(a,b,c))}function ms_getTrueLargestSize(a,b,c){for(var d=0,e=0,f=a.length;f>e;e++){var g=a.eq(e),h=g.is(":visible")?g[b.d[c]](!0):0;h>d&&(d=h)}return d}function ms_getTotalSize(a,b,c,d){if(is_boolean(d)||(d=!1),is_number(b[b.d[c]])&&d)return b[b.d[c]];if(is_number(b.items[b.d[c]]))return b.items[b.d[c]]*a.length;for(var e=c.toLowerCase().indexOf("width")>-1?"outerWidth":"outerHeight",f=0,g=0,h=a.length;h>g;g++){var i=a.eq(g);f+=i.is(":visible")?i[b.d[e]](!0):0}return f}function ms_getParentSize(a,b,c){var d=a.is(":visible");d&&a.hide();var e=a.parent()[b.d[c]]();return d&&a.show(),e}function ms_getMaxDimension(a,b){return is_number(a[a.d.width])?a[a.d.width]:b}function ms_hasVariableSizes(a,b,c){for(var d=!1,e=!1,f=0,g=a.length;g>f;f++){var h=a.eq(f),i=h.is(":visible")?h[b.d[c]](!0):0;d===!1?d=i:d!=i&&(e=!0),0==d&&(e=!0)}return e}function ms_getPaddingBorderMargin(a,b,c){return a[b.d["outer"+c]](!0)-a[b.d[c.toLowerCase()]]()}function ms_getPercentage(a,b){if(is_percentage(b)){if(b=parseInt(b.slice(0,-1),10),!is_number(b))return a;a*=b/100}return a}function cf_e(a,b,c,d,e){return is_boolean(c)||(c=!0),is_boolean(d)||(d=!0),is_boolean(e)||(e=!1),c&&(a=b.events.prefix+a),d&&(a=a+"."+b.events.namespace),d&&e&&(a+=b.serialNumber),a}function cf_c(a,b){return is_string(b.classnames[a])?b.classnames[a]:a}function cf_mapWrapperSizes(a,b,c){is_boolean(c)||(c=!0);var d=b.usePadding&&c?b.padding:[0,0,0,0],e={};return e[b.d.width]=a[0]+d[1]+d[3],e[b.d.height]=a[1]+d[0]+d[2],e}function cf_sortParams(a,b){for(var c=[],d=0,e=a.length;e>d;d++)for(var f=0,g=b.length;g>f;f++)if(b[f].indexOf(typeof a[d])>-1&&is_undefined(c[f])){c[f]=a[d];break}return c}function cf_getPadding(a){if(is_undefined(a))return[0,0,0,0];if(is_number(a))return[a,a,a,a];if(is_string(a)&&(a=a.split("px").join("").split("em").join("").split(" ")),!is_array(a))return[0,0,0,0];for(var b=0;4>b;b++)a[b]=parseInt(a[b],10);switch(a.length){case 0:return[0,0,0,0];case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];default:return[a[0],a[1],a[2],a[3]]}}function cf_getAlignPadding(a,b){var c=is_number(b[b.d.width])?Math.ceil(b[b.d.width]-ms_getTotalSize(a,b,"width")):0;switch(b.align){case"left":return[0,c];case"right":return[c,0];case"center":default:return[Math.ceil(c/2),Math.floor(c/2)]}}function cf_getDimensions(a){for(var b=[["width","innerWidth","outerWidth","height","innerHeight","outerHeight","left","top","marginRight",0,1,2,3],["height","innerHeight","outerHeight","width","innerWidth","outerWidth","top","left","marginBottom",3,2,1,0]],c=b[0].length,d="right"==a.direction||"left"==a.direction?0:1,e={},f=0;c>f;f++)e[b[0][f]]=b[d][f];return e}function cf_getAdjust(a,b,c,d){var e=a;if(is_function(c))e=c.call(d,e);else if(is_string(c)){var f=c.split("+"),g=c.split("-");if(g.length>f.length)var h=!0,i=g[0],j=g[1];else var h=!1,i=f[0],j=f[1];switch(i){case"even":e=1==a%2?a-1:a;break;case"odd":e=0==a%2?a-1:a;break;default:e=a}j=parseInt(j,10),is_number(j)&&(h&&(j=-j),e+=j)}return(!is_number(e)||1>e)&&(e=1),e}function cf_getItemsAdjust(a,b,c,d){return cf_getItemAdjustMinMax(cf_getAdjust(a,b,c,d),b.items.visibleConf)}function cf_getItemAdjustMinMax(a,b){return is_number(b.min)&&b.min>a&&(a=b.min),is_number(b.max)&&a>b.max&&(a=b.max),1>a&&(a=1),a}function cf_getSynchArr(a){is_array(a)||(a=[[a]]),is_array(a[0])||(a=[a]);for(var b=0,c=a.length;c>b;b++)is_string(a[b][0])&&(a[b][0]=$(a[b][0])),is_boolean(a[b][1])||(a[b][1]=!0),is_boolean(a[b][2])||(a[b][2]=!0),is_number(a[b][3])||(a[b][3]=0);return a}function cf_getKeyCode(a){return"right"==a?39:"left"==a?37:"up"==a?38:"down"==a?40:-1}function cf_setCookie(a,b,c){if(a){var d=b.triggerHandler(cf_e("currentPosition",c));$.fn.carouFredSel.cookie.set(a,d)}}function cf_getCookie(a){var b=$.fn.carouFredSel.cookie.get(a);return""==b?0:b}function in_mapCss(a,b){for(var c={},d=0,e=b.length;e>d;d++)c[b[d]]=a.css(b[d]);return c}function in_complementItems(a,b,c,d){return is_object(a.visibleConf)||(a.visibleConf={}),is_object(a.sizesConf)||(a.sizesConf={}),0==a.start&&is_number(d)&&(a.start=d),is_object(a.visible)?(a.visibleConf.min=a.visible.min,a.visibleConf.max=a.visible.max,a.visible=!1):is_string(a.visible)?("variable"==a.visible?a.visibleConf.variable=!0:a.visibleConf.adjust=a.visible,a.visible=!1):is_function(a.visible)&&(a.visibleConf.adjust=a.visible,a.visible=!1),is_string(a.filter)||(a.filter=c.filter(":hidden").length>0?":visible":"*"),a[b.d.width]||(b.responsive?(debug(!0,"Set a "+b.d.width+" for the items!"),a[b.d.width]=ms_getTrueLargestSize(c,b,"outerWidth")):a[b.d.width]=ms_hasVariableSizes(c,b,"outerWidth")?"variable":c[b.d.outerWidth](!0)),a[b.d.height]||(a[b.d.height]=ms_hasVariableSizes(c,b,"outerHeight")?"variable":c[b.d.outerHeight](!0)),a.sizesConf.width=a.width,a.sizesConf.height=a.height,a}function in_complementVisibleItems(a,b){return"variable"==a.items[a.d.width]&&(a.items.visibleConf.variable=!0),a.items.visibleConf.variable||(is_number(a[a.d.width])?a.items.visible=Math.floor(a[a.d.width]/a.items[a.d.width]):(a.items.visible=Math.floor(b/a.items[a.d.width]),a[a.d.width]=a.items.visible*a.items[a.d.width],a.items.visibleConf.adjust||(a.align=!1)),("Infinity"==a.items.visible||1>a.items.visible)&&(debug(!0,'Not a valid number of visible items: Set to "variable".'),a.items.visibleConf.variable=!0)),a}function in_complementPrimarySize(a,b,c){return"auto"==a&&(a=ms_getTrueLargestSize(c,b,"outerWidth")),a}function in_complementSecondarySize(a,b,c){return"auto"==a&&(a=ms_getTrueLargestSize(c,b,"outerHeight")),a||(a=b.items[b.d.height]),a}function in_getAlignPadding(a,b){var c=cf_getAlignPadding(gi_getCurrentItems(b,a),a);return a.padding[a.d[1]]=c[1],a.padding[a.d[3]]=c[0],a}function in_getResponsiveValues(a,b){var d=cf_getItemAdjustMinMax(Math.ceil(a[a.d.width]/a.items[a.d.width]),a.items.visibleConf);d>b.length&&(d=b.length);var e=Math.floor(a[a.d.width]/d);return a.items.visible=d,a.items[a.d.width]=e,a[a.d.width]=d*e,a}function bt_pauseOnHoverConfig(a){if(is_string(a))var b=a.indexOf("immediate")>-1?!0:!1,c=a.indexOf("resume")>-1?!0:!1;else var b=c=!1;return[b,c]}function bt_mousesheelNumber(a){return is_number(a)?a:null}function is_null(a){return null===a}function is_undefined(a){return is_null(a)||a===void 0||""===a||"undefined"===a}function is_array(a){return a instanceof Array}function is_jquery(a){return a instanceof jQuery}function is_object(a){return(a instanceof Object||"object"==typeof a)&&!is_null(a)&&!is_jquery(a)&&!is_array(a)&&!is_function(a)}function is_number(a){return(a instanceof Number||"number"==typeof a)&&!isNaN(a)}function is_string(a){return(a instanceof String||"string"==typeof a)&&!is_undefined(a)&&!is_true(a)&&!is_false(a)}function is_function(a){return a instanceof Function||"function"==typeof a}function is_boolean(a){return a instanceof Boolean||"boolean"==typeof a||is_true(a)||is_false(a)}function is_true(a){return a===!0||"true"===a}function is_false(a){return a===!1||"false"===a}function is_percentage(a){return is_string(a)&&"%"==a.slice(-1)}function getTime(){return(new Date).getTime()}function deprecated(a,b){debug(!0,a+" is DEPRECATED, support for it will be removed. Use "+b+" instead.")}function debug(a,b){if(!is_undefined(window.console)&&!is_undefined(window.console.log)){if(is_object(a)){var c=" ("+a.selector+")";a=a.debug}else var c="";if(!a)return!1;b=is_string(b)?"carouFredSel"+c+": "+b:["carouFredSel"+c+":",b],window.console.log(b)}return!1}$.fn.carouFredSel||($.fn.caroufredsel=$.fn.carouFredSel=function(options,configs){if(0==this.length)return debug(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){$(this).carouFredSel(options,configs)});var $cfs=this,$tt0=this[0],starting_position=!1;$cfs.data("_cfs_isCarousel")&&(starting_position=$cfs.triggerHandler("_cfs_triggerEvent","currentPosition"),$cfs.trigger("_cfs_triggerEvent",["destroy",!0]));var FN={};FN._init=function(a,b,c){a=go_getObject($tt0,a),a.items=go_getItemsObject($tt0,a.items),a.scroll=go_getScrollObject($tt0,a.scroll),a.auto=go_getAutoObject($tt0,a.auto),a.prev=go_getPrevNextObject($tt0,a.prev),a.next=go_getPrevNextObject($tt0,a.next),a.pagination=go_getPaginationObject($tt0,a.pagination),a.swipe=go_getSwipeObject($tt0,a.swipe),a.mousewheel=go_getMousewheelObject($tt0,a.mousewheel),b&&(opts_orig=$.extend(!0,{},$.fn.carouFredSel.defaults,a)),opts=$.extend(!0,{},$.fn.carouFredSel.defaults,a),opts.d=cf_getDimensions(opts),crsl.direction="up"==opts.direction||"left"==opts.direction?"next":"prev";var d=$cfs.children(),e=ms_getParentSize($wrp,opts,"width");if(is_true(opts.cookie)&&(opts.cookie="caroufredsel_cookie_"+conf.serialNumber),opts.maxDimension=ms_getMaxDimension(opts,e),opts.items=in_complementItems(opts.items,opts,d,c),opts[opts.d.width]=in_complementPrimarySize(opts[opts.d.width],opts,d),opts[opts.d.height]=in_complementSecondarySize(opts[opts.d.height],opts,d),opts.responsive&&(is_percentage(opts[opts.d.width])||(opts[opts.d.width]="100%")),is_percentage(opts[opts.d.width])&&(crsl.upDateOnWindowResize=!0,crsl.primarySizePercentage=opts[opts.d.width],opts[opts.d.width]=ms_getPercentage(e,crsl.primarySizePercentage),opts.items.visible||(opts.items.visibleConf.variable=!0)),opts.responsive?(opts.usePadding=!1,opts.padding=[0,0,0,0],opts.align=!1,opts.items.visibleConf.variable=!1):(opts.items.visible||(opts=in_complementVisibleItems(opts,e)),opts[opts.d.width]||(!opts.items.visibleConf.variable&&is_number(opts.items[opts.d.width])&&"*"==opts.items.filter?(opts[opts.d.width]=opts.items.visible*opts.items[opts.d.width],opts.align=!1):opts[opts.d.width]="variable"),is_undefined(opts.align)&&(opts.align=is_number(opts[opts.d.width])?"center":!1),opts.items.visibleConf.variable&&(opts.items.visible=gn_getVisibleItemsNext(d,opts,0))),"*"==opts.items.filter||opts.items.visibleConf.variable||(opts.items.visibleConf.org=opts.items.visible,opts.items.visible=gn_getVisibleItemsNextFilter(d,opts,0)),opts.items.visible=cf_getItemsAdjust(opts.items.visible,opts,opts.items.visibleConf.adjust,$tt0),opts.items.visibleConf.old=opts.items.visible,opts.responsive)opts.items.visibleConf.min||(opts.items.visibleConf.min=opts.items.visible),opts.items.visibleConf.max||(opts.items.visibleConf.max=opts.items.visible),opts=in_getResponsiveValues(opts,d,e);else switch(opts.padding=cf_getPadding(opts.padding),"top"==opts.align?opts.align="left":"bottom"==opts.align&&(opts.align="right"),opts.align){case"center":case"left":case"right":"variable"!=opts[opts.d.width]&&(opts=in_getAlignPadding(opts,d),opts.usePadding=!0);break;default:opts.align=!1,opts.usePadding=0==opts.padding[0]&&0==opts.padding[1]&&0==opts.padding[2]&&0==opts.padding[3]?!1:!0}is_number(opts.scroll.duration)||(opts.scroll.duration=500),is_undefined(opts.scroll.items)&&(opts.scroll.items=opts.responsive||opts.items.visibleConf.variable||"*"!=opts.items.filter?"visible":opts.items.visible),opts.auto=$.extend(!0,{},opts.scroll,opts.auto),opts.prev=$.extend(!0,{},opts.scroll,opts.prev),opts.next=$.extend(!0,{},opts.scroll,opts.next),opts.pagination=$.extend(!0,{},opts.scroll,opts.pagination),opts.auto=go_complementAutoObject($tt0,opts.auto),opts.prev=go_complementPrevNextObject($tt0,opts.prev),opts.next=go_complementPrevNextObject($tt0,opts.next),opts.pagination=go_complementPaginationObject($tt0,opts.pagination),opts.swipe=go_complementSwipeObject($tt0,opts.swipe),opts.mousewheel=go_complementMousewheelObject($tt0,opts.mousewheel),opts.synchronise&&(opts.synchronise=cf_getSynchArr(opts.synchronise)),opts.auto.onPauseStart&&(opts.auto.onTimeoutStart=opts.auto.onPauseStart,deprecated("auto.onPauseStart","auto.onTimeoutStart")),opts.auto.onPausePause&&(opts.auto.onTimeoutPause=opts.auto.onPausePause,deprecated("auto.onPausePause","auto.onTimeoutPause")),opts.auto.onPauseEnd&&(opts.auto.onTimeoutEnd=opts.auto.onPauseEnd,deprecated("auto.onPauseEnd","auto.onTimeoutEnd")),opts.auto.pauseDuration&&(opts.auto.timeoutDuration=opts.auto.pauseDuration,deprecated("auto.pauseDuration","auto.timeoutDuration"))},FN._build=function(){$cfs.data("_cfs_isCarousel",!0);var a=$cfs.children(),b=in_mapCss($cfs,["textAlign","float","position","top","right","bottom","left","zIndex","width","height","marginTop","marginRight","marginBottom","marginLeft"]),c="relative";switch(b.position){case"absolute":case"fixed":c=b.position}"parent"==conf.wrapper?sz_storeOrigCss($wrp):$wrp.css(b),$wrp.css({overflow:"hidden",position:c}),sz_storeOrigCss($cfs),$cfs.data("_cfs_origCssZindex",b.zIndex),$cfs.css({textAlign:"left","float":"none",position:"absolute",top:0,right:"auto",bottom:"auto",left:0,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0}),sz_storeMargin(a,opts),sz_storeOrigCss(a),opts.responsive&&sz_setResponsiveSizes(opts,a)},FN._bind_events=function(){FN._unbind_events(),$cfs.bind(cf_e("stop",conf),function(a,b){return a.stopPropagation(),crsl.isStopped||opts.auto.button&&opts.auto.button.addClass(cf_c("stopped",conf)),crsl.isStopped=!0,opts.auto.play&&(opts.auto.play=!1,$cfs.trigger(cf_e("pause",conf),b)),!0}),$cfs.bind(cf_e("finish",conf),function(a){return a.stopPropagation(),crsl.isScrolling&&sc_stopScroll(scrl),!0}),$cfs.bind(cf_e("pause",conf),function(a,b,c){if(a.stopPropagation(),tmrs=sc_clearTimers(tmrs),b&&crsl.isScrolling){scrl.isStopped=!0;var d=getTime()-scrl.startTime;scrl.duration-=d,scrl.pre&&(scrl.pre.duration-=d),scrl.post&&(scrl.post.duration-=d),sc_stopScroll(scrl,!1)}if(crsl.isPaused||crsl.isScrolling||c&&(tmrs.timePassed+=getTime()-tmrs.startTime),crsl.isPaused||opts.auto.button&&opts.auto.button.addClass(cf_c("paused",conf)),crsl.isPaused=!0,opts.auto.onTimeoutPause){var e=opts.auto.timeoutDuration-tmrs.timePassed,f=100-Math.ceil(100*e/opts.auto.timeoutDuration);opts.auto.onTimeoutPause.call($tt0,f,e)}return!0}),$cfs.bind(cf_e("play",conf),function(a,b,c,d){a.stopPropagation(),tmrs=sc_clearTimers(tmrs);var e=[b,c,d],f=["string","number","boolean"],g=cf_sortParams(e,f);if(b=g[0],c=g[1],d=g[2],"prev"!=b&&"next"!=b&&(b=crsl.direction),is_number(c)||(c=0),is_boolean(d)||(d=!1),d&&(crsl.isStopped=!1,opts.auto.play=!0),!opts.auto.play)return a.stopImmediatePropagation(),debug(conf,"Carousel stopped: Not scrolling.");crsl.isPaused&&opts.auto.button&&(opts.auto.button.removeClass(cf_c("stopped",conf)),opts.auto.button.removeClass(cf_c("paused",conf))),crsl.isPaused=!1,tmrs.startTime=getTime();var h=opts.auto.timeoutDuration+c;return dur2=h-tmrs.timePassed,perc=100-Math.ceil(100*dur2/h),opts.auto.progress&&(tmrs.progress=setInterval(function(){var a=getTime()-tmrs.startTime+tmrs.timePassed,b=Math.ceil(100*a/h);opts.auto.progress.updater.call(opts.auto.progress.bar[0],b)},opts.auto.progress.interval)),tmrs.auto=setTimeout(function(){opts.auto.progress&&opts.auto.progress.updater.call(opts.auto.progress.bar[0],100),opts.auto.onTimeoutEnd&&opts.auto.onTimeoutEnd.call($tt0,perc,dur2),crsl.isScrolling?$cfs.trigger(cf_e("play",conf),b):$cfs.trigger(cf_e(b,conf),opts.auto)},dur2),opts.auto.onTimeoutStart&&opts.auto.onTimeoutStart.call($tt0,perc,dur2),!0}),$cfs.bind(cf_e("resume",conf),function(a){return a.stopPropagation(),scrl.isStopped?(scrl.isStopped=!1,crsl.isPaused=!1,crsl.isScrolling=!0,scrl.startTime=getTime(),sc_startScroll(scrl,conf)):$cfs.trigger(cf_e("play",conf)),!0}),$cfs.bind(cf_e("prev",conf)+" "+cf_e("next",conf),function(a,b,c,d,e){if(a.stopPropagation(),crsl.isStopped||$cfs.is(":hidden"))return a.stopImmediatePropagation(),debug(conf,"Carousel stopped or hidden: Not scrolling.");var f=is_number(opts.items.minimum)?opts.items.minimum:opts.items.visible+1;if(f>itms.total)return a.stopImmediatePropagation(),debug(conf,"Not enough items ("+itms.total+" total, "+f+" needed): Not scrolling.");var g=[b,c,d,e],h=["object","number/string","function","boolean"],i=cf_sortParams(g,h);b=i[0],c=i[1],d=i[2],e=i[3];var j=a.type.slice(conf.events.prefix.length);if(is_object(b)||(b={}),is_function(d)&&(b.onAfter=d),is_boolean(e)&&(b.queue=e),b=$.extend(!0,{},opts[j],b),b.conditions&&!b.conditions.call($tt0,j))return a.stopImmediatePropagation(),debug(conf,'Callback "conditions" returned false.');if(!is_number(c)){if("*"!=opts.items.filter)c="visible";else for(var k=[c,b.items,opts[j].items],i=0,l=k.length;l>i;i++)if(is_number(k[i])||"page"==k[i]||"visible"==k[i]){c=k[i];break}switch(c){case"page":return a.stopImmediatePropagation(),$cfs.triggerHandler(cf_e(j+"Page",conf),[b,d]);case"visible":opts.items.visibleConf.variable||"*"!=opts.items.filter||(c=opts.items.visible)}}if(scrl.isStopped)return $cfs.trigger(cf_e("resume",conf)),$cfs.trigger(cf_e("queue",conf),[j,[b,c,d]]),a.stopImmediatePropagation(),debug(conf,"Carousel resumed scrolling.");if(b.duration>0&&crsl.isScrolling)return b.queue&&("last"==b.queue&&(queu=[]),("first"!=b.queue||0==queu.length)&&$cfs.trigger(cf_e("queue",conf),[j,[b,c,d]])),a.stopImmediatePropagation(),debug(conf,"Carousel currently scrolling.");if(tmrs.timePassed=0,$cfs.trigger(cf_e("slide_"+j,conf),[b,c]),opts.synchronise)for(var m=opts.synchronise,n=[b,c],o=0,l=m.length;l>o;o++){var p=j;m[o][2]||(p="prev"==p?"next":"prev"),m[o][1]||(n[0]=m[o][0].triggerHandler("_cfs_triggerEvent",["configuration",p])),n[1]=c+m[o][3],m[o][0].trigger("_cfs_triggerEvent",["slide_"+p,n])}return!0}),$cfs.bind(cf_e("slide_prev",conf),function(a,b,c){a.stopPropagation();var d=$cfs.children();if(!opts.circular&&0==itms.first)return opts.infinite&&$cfs.trigger(cf_e("next",conf),itms.total-1),a.stopImmediatePropagation();if(sz_resetMargin(d,opts),!is_number(c)){if(opts.items.visibleConf.variable)c=gn_getVisibleItemsPrev(d,opts,itms.total-1);else if("*"!=opts.items.filter){var e=is_number(b.items)?b.items:gn_getVisibleOrg($cfs,opts);c=gn_getScrollItemsPrevFilter(d,opts,itms.total-1,e)}else c=opts.items.visible;c=cf_getAdjust(c,opts,b.items,$tt0)}if(opts.circular||itms.total-c<itms.first&&(c=itms.total-itms.first),opts.items.visibleConf.old=opts.items.visible,opts.items.visibleConf.variable){var f=cf_getItemsAdjust(gn_getVisibleItemsNext(d,opts,itms.total-c),opts,opts.items.visibleConf.adjust,$tt0);f>=opts.items.visible+c&&itms.total>c&&(c++,f=cf_getItemsAdjust(gn_getVisibleItemsNext(d,opts,itms.total-c),opts,opts.items.visibleConf.adjust,$tt0)),opts.items.visible=f}else if("*"!=opts.items.filter){var f=gn_getVisibleItemsNextFilter(d,opts,itms.total-c);opts.items.visible=cf_getItemsAdjust(f,opts,opts.items.visibleConf.adjust,$tt0)}if(sz_resetMargin(d,opts,!0),0==c)return a.stopImmediatePropagation(),debug(conf,"0 items to scroll: Not scrolling.");for(debug(conf,"Scrolling "+c+" items backward."),itms.first+=c;itms.first>=itms.total;)itms.first-=itms.total;opts.circular||(0==itms.first&&b.onEnd&&b.onEnd.call($tt0,"prev"),opts.infinite||nv_enableNavi(opts,itms.first,conf)),$cfs.children().slice(itms.total-c,itms.total).prependTo($cfs),itms.total<opts.items.visible+c&&$cfs.children().slice(0,opts.items.visible+c-itms.total).clone(!0).appendTo($cfs);var d=$cfs.children(),g=gi_getOldItemsPrev(d,opts,c),h=gi_getNewItemsPrev(d,opts),i=d.eq(c-1),j=g.last(),k=h.last();sz_resetMargin(d,opts);var l=0,m=0;if(opts.align){var n=cf_getAlignPadding(h,opts);l=n[0],m=n[1]}var o=0>l?opts.padding[opts.d[3]]:0,p=!1,q=$();if(c>opts.items.visible&&(q=d.slice(opts.items.visibleConf.old,c),"directscroll"==b.fx)){var r=opts.items[opts.d.width];p=q,i=k,sc_hideHiddenItems(p),opts.items[opts.d.width]="variable"}var s=!1,t=ms_getTotalSize(d.slice(0,c),opts,"width"),u=cf_mapWrapperSizes(ms_getSizes(h,opts,!0),opts,!opts.usePadding),v=0,w={},x={},y={},z={},A={},B={},C={},D=sc_getDuration(b,opts,c,t);switch(b.fx){case"cover":case"cover-fade":v=ms_getTotalSize(d.slice(0,opts.items.visible),opts,"width")}p&&(opts.items[opts.d.width]=r),sz_resetMargin(d,opts,!0),m>=0&&sz_resetMargin(j,opts,opts.padding[opts.d[1]]),l>=0&&sz_resetMargin(i,opts,opts.padding[opts.d[3]]),opts.align&&(opts.padding[opts.d[1]]=m,opts.padding[opts.d[3]]=l),B[opts.d.left]=-(t-o),C[opts.d.left]=-(v-o),x[opts.d.left]=u[opts.d.width];var E=function(){},F=function(){},G=function(){},H=function(){},I=function(){},J=function(){},K=function(){},L=function(){},M=function(){},N=function(){},O=function(){};switch(b.fx){case"crossfade":case"cover":case"cover-fade":case"uncover":case"uncover-fade":s=$cfs.clone(!0).appendTo($wrp)}switch(b.fx){case"crossfade":case"uncover":case"uncover-fade":s.children().slice(0,c).remove(),s.children().slice(opts.items.visibleConf.old).remove();break;case"cover":case"cover-fade":s.children().slice(opts.items.visible).remove(),s.css(C)}if($cfs.css(B),scrl=sc_setScroll(D,b.easing,conf),w[opts.d.left]=opts.usePadding?opts.padding[opts.d[3]]:0,("variable"==opts[opts.d.width]||"variable"==opts[opts.d.height])&&(E=function(){$wrp.css(u)},F=function(){scrl.anims.push([$wrp,u])}),opts.usePadding){switch(k.not(i).length&&(y[opts.d.marginRight]=i.data("_cfs_origCssMargin"),0>l?i.css(y):(K=function(){i.css(y)},L=function(){scrl.anims.push([i,y])})),b.fx){case"cover":case"cover-fade":s.children().eq(c-1).css(y)}k.not(j).length&&(z[opts.d.marginRight]=j.data("_cfs_origCssMargin"),G=function(){j.css(z)},H=function(){scrl.anims.push([j,z])}),m>=0&&(A[opts.d.marginRight]=k.data("_cfs_origCssMargin")+opts.padding[opts.d[1]],I=function(){k.css(A)},J=function(){scrl.anims.push([k,A])})}O=function(){$cfs.css(w)};var P=opts.items.visible+c-itms.total;N=function(){if(P>0&&($cfs.children().slice(itms.total).remove(),g=$($cfs.children().slice(itms.total-(opts.items.visible-P)).get().concat($cfs.children().slice(0,P).get()))),sc_showHiddenItems(p),opts.usePadding){var a=$cfs.children().eq(opts.items.visible+c-1);a.css(opts.d.marginRight,a.data("_cfs_origCssMargin"))}};var Q=sc_mapCallbackArguments(g,q,h,c,"prev",D,u);switch(M=function(){sc_afterScroll($cfs,s,b),crsl.isScrolling=!1,clbk.onAfter=sc_fireCallbacks($tt0,b,"onAfter",Q,clbk),queu=sc_fireQueue($cfs,queu,conf),crsl.isPaused||$cfs.trigger(cf_e("play",conf))},crsl.isScrolling=!0,tmrs=sc_clearTimers(tmrs),clbk.onBefore=sc_fireCallbacks($tt0,b,"onBefore",Q,clbk),b.fx){case"none":$cfs.css(w),E(),G(),I(),K(),O(),N(),M();break;case"fade":scrl.anims.push([$cfs,{opacity:0},function(){E(),G(),I(),K(),O(),N(),scrl=sc_setScroll(D,b.easing,conf),scrl.anims.push([$cfs,{opacity:1},M]),sc_startScroll(scrl,conf)}]);break;case"crossfade":$cfs.css({opacity:0}),scrl.anims.push([s,{opacity:0}]),scrl.anims.push([$cfs,{opacity:1},M]),F(),G(),I(),K(),O(),N();break;case"cover":scrl.anims.push([s,w,function(){G(),I(),K(),O(),N(),M()}]),F();break;case"cover-fade":scrl.anims.push([$cfs,{opacity:0}]),scrl.anims.push([s,w,function(){G(),I(),K(),O(),N(),M()}]),F();break;case"uncover":scrl.anims.push([s,x,M]),F(),G(),I(),K(),O(),N();break;case"uncover-fade":$cfs.css({opacity:0}),scrl.anims.push([$cfs,{opacity:1}]),scrl.anims.push([s,x,M]),F(),G(),I(),K(),O(),N();break;default:scrl.anims.push([$cfs,w,function(){N(),M()}]),F(),H(),J(),L()}return sc_startScroll(scrl,conf),cf_setCookie(opts.cookie,$cfs,conf),$cfs.trigger(cf_e("updatePageStatus",conf),[!1,u]),!0}),$cfs.bind(cf_e("slide_next",conf),function(a,b,c){a.stopPropagation();var d=$cfs.children();if(!opts.circular&&itms.first==opts.items.visible)return opts.infinite&&$cfs.trigger(cf_e("prev",conf),itms.total-1),a.stopImmediatePropagation();if(sz_resetMargin(d,opts),!is_number(c)){if("*"!=opts.items.filter){var e=is_number(b.items)?b.items:gn_getVisibleOrg($cfs,opts);c=gn_getScrollItemsNextFilter(d,opts,0,e)}else c=opts.items.visible;c=cf_getAdjust(c,opts,b.items,$tt0)}var f=0==itms.first?itms.total:itms.first;if(!opts.circular){if(opts.items.visibleConf.variable)var g=gn_getVisibleItemsNext(d,opts,c),e=gn_getVisibleItemsPrev(d,opts,f-1);else var g=opts.items.visible,e=opts.items.visible;c+g>f&&(c=f-e)}if(opts.items.visibleConf.old=opts.items.visible,opts.items.visibleConf.variable){for(var g=cf_getItemsAdjust(gn_getVisibleItemsNextTestCircular(d,opts,c,f),opts,opts.items.visibleConf.adjust,$tt0);opts.items.visible-c>=g&&itms.total>c;)c++,g=cf_getItemsAdjust(gn_getVisibleItemsNextTestCircular(d,opts,c,f),opts,opts.items.visibleConf.adjust,$tt0);opts.items.visible=g}else if("*"!=opts.items.filter){var g=gn_getVisibleItemsNextFilter(d,opts,c);opts.items.visible=cf_getItemsAdjust(g,opts,opts.items.visibleConf.adjust,$tt0)}if(sz_resetMargin(d,opts,!0),0==c)return a.stopImmediatePropagation(),debug(conf,"0 items to scroll: Not scrolling.");for(debug(conf,"Scrolling "+c+" items forward."),itms.first-=c;0>itms.first;)itms.first+=itms.total;opts.circular||(itms.first==opts.items.visible&&b.onEnd&&b.onEnd.call($tt0,"next"),opts.infinite||nv_enableNavi(opts,itms.first,conf)),itms.total<opts.items.visible+c&&$cfs.children().slice(0,opts.items.visible+c-itms.total).clone(!0).appendTo($cfs);var d=$cfs.children(),h=gi_getOldItemsNext(d,opts),i=gi_getNewItemsNext(d,opts,c),j=d.eq(c-1),k=h.last(),l=i.last();sz_resetMargin(d,opts);var m=0,n=0;if(opts.align){var o=cf_getAlignPadding(i,opts);m=o[0],n=o[1]}var p=!1,q=$();if(c>opts.items.visibleConf.old&&(q=d.slice(opts.items.visibleConf.old,c),"directscroll"==b.fx)){var r=opts.items[opts.d.width];p=q,j=k,sc_hideHiddenItems(p),opts.items[opts.d.width]="variable"}var s=!1,t=ms_getTotalSize(d.slice(0,c),opts,"width"),u=cf_mapWrapperSizes(ms_getSizes(i,opts,!0),opts,!opts.usePadding),v=0,w={},x={},y={},z={},A={},B=sc_getDuration(b,opts,c,t);switch(b.fx){case"uncover":case"uncover-fade":v=ms_getTotalSize(d.slice(0,opts.items.visibleConf.old),opts,"width")}p&&(opts.items[opts.d.width]=r),opts.align&&0>opts.padding[opts.d[1]]&&(opts.padding[opts.d[1]]=0),sz_resetMargin(d,opts,!0),sz_resetMargin(k,opts,opts.padding[opts.d[1]]),opts.align&&(opts.padding[opts.d[1]]=n,opts.padding[opts.d[3]]=m),A[opts.d.left]=opts.usePadding?opts.padding[opts.d[3]]:0;var C=function(){},D=function(){},E=function(){},F=function(){},G=function(){},H=function(){},I=function(){},J=function(){},K=function(){};switch(b.fx){case"crossfade":case"cover":case"cover-fade":case"uncover":case"uncover-fade":s=$cfs.clone(!0).appendTo($wrp),s.children().slice(opts.items.visibleConf.old).remove()}switch(b.fx){case"crossfade":case"cover":case"cover-fade":$cfs.css("zIndex",1),s.css("zIndex",0)}if(scrl=sc_setScroll(B,b.easing,conf),w[opts.d.left]=-t,x[opts.d.left]=-v,0>m&&(w[opts.d.left]+=m),("variable"==opts[opts.d.width]||"variable"==opts[opts.d.height])&&(C=function(){$wrp.css(u)},D=function(){scrl.anims.push([$wrp,u])}),opts.usePadding){var L=l.data("_cfs_origCssMargin");n>=0&&(L+=opts.padding[opts.d[1]]),l.css(opts.d.marginRight,L),j.not(k).length&&(z[opts.d.marginRight]=k.data("_cfs_origCssMargin")),E=function(){k.css(z)},F=function(){scrl.anims.push([k,z])};var M=j.data("_cfs_origCssMargin");m>0&&(M+=opts.padding[opts.d[3]]),y[opts.d.marginRight]=M,G=function(){j.css(y)},H=function(){scrl.anims.push([j,y])}}K=function(){$cfs.css(A)};var N=opts.items.visible+c-itms.total;J=function(){N>0&&$cfs.children().slice(itms.total).remove();var a=$cfs.children().slice(0,c).appendTo($cfs).last();if(N>0&&(i=gi_getCurrentItems(d,opts)),sc_showHiddenItems(p),opts.usePadding){if(itms.total<opts.items.visible+c){var b=$cfs.children().eq(opts.items.visible-1);b.css(opts.d.marginRight,b.data("_cfs_origCssMargin")+opts.padding[opts.d[1]])}a.css(opts.d.marginRight,a.data("_cfs_origCssMargin"))}};var O=sc_mapCallbackArguments(h,q,i,c,"next",B,u);switch(I=function(){$cfs.css("zIndex",$cfs.data("_cfs_origCssZindex")),sc_afterScroll($cfs,s,b),crsl.isScrolling=!1,clbk.onAfter=sc_fireCallbacks($tt0,b,"onAfter",O,clbk),queu=sc_fireQueue($cfs,queu,conf),crsl.isPaused||$cfs.trigger(cf_e("play",conf))},crsl.isScrolling=!0,tmrs=sc_clearTimers(tmrs),clbk.onBefore=sc_fireCallbacks($tt0,b,"onBefore",O,clbk),b.fx){case"none":$cfs.css(w),C(),E(),G(),K(),J(),I();break;case"fade":scrl.anims.push([$cfs,{opacity:0},function(){C(),E(),G(),K(),J(),scrl=sc_setScroll(B,b.easing,conf),scrl.anims.push([$cfs,{opacity:1},I]),sc_startScroll(scrl,conf)}]);break;case"crossfade":$cfs.css({opacity:0}),scrl.anims.push([s,{opacity:0}]),scrl.anims.push([$cfs,{opacity:1},I]),D(),E(),G(),K(),J();break;case"cover":$cfs.css(opts.d.left,$wrp[opts.d.width]()),scrl.anims.push([$cfs,A,I]),D(),E(),G(),J();break;case"cover-fade":$cfs.css(opts.d.left,$wrp[opts.d.width]()),scrl.anims.push([s,{opacity:0}]),scrl.anims.push([$cfs,A,I]),D(),E(),G(),J();break;case"uncover":scrl.anims.push([s,x,I]),D(),E(),G(),K(),J();break;case"uncover-fade":$cfs.css({opacity:0}),scrl.anims.push([$cfs,{opacity:1}]),scrl.anims.push([s,x,I]),D(),E(),G(),K(),J();break;default:scrl.anims.push([$cfs,w,function(){K(),J(),I()}]),D(),F(),H()}return sc_startScroll(scrl,conf),cf_setCookie(opts.cookie,$cfs,conf),$cfs.trigger(cf_e("updatePageStatus",conf),[!1,u]),!0}),$cfs.bind(cf_e("slideTo",conf),function(a,b,c,d,e,f,g){a.stopPropagation();var h=[b,c,d,e,f,g],i=["string/number/object","number","boolean","object","string","function"],j=cf_sortParams(h,i);return e=j[3],f=j[4],g=j[5],b=gn_getItemIndex(j[0],j[1],j[2],itms,$cfs),0==b?!1:(is_object(e)||(e=!1),"prev"!=f&&"next"!=f&&(f=opts.circular?itms.total/2>=b?"next":"prev":0==itms.first||itms.first>b?"next":"prev"),"prev"==f&&(b=itms.total-b),$cfs.trigger(cf_e(f,conf),[e,b,g]),!0)}),$cfs.bind(cf_e("prevPage",conf),function(a,b,c){a.stopPropagation();var d=$cfs.triggerHandler(cf_e("currentPage",conf));return $cfs.triggerHandler(cf_e("slideToPage",conf),[d-1,b,"prev",c])}),$cfs.bind(cf_e("nextPage",conf),function(a,b,c){a.stopPropagation();var d=$cfs.triggerHandler(cf_e("currentPage",conf));return $cfs.triggerHandler(cf_e("slideToPage",conf),[d+1,b,"next",c])}),$cfs.bind(cf_e("slideToPage",conf),function(a,b,c,d,e){a.stopPropagation(),is_number(b)||(b=$cfs.triggerHandler(cf_e("currentPage",conf)));var f=opts.pagination.items||opts.items.visible,g=Math.ceil(itms.total/f)-1;return 0>b&&(b=g),b>g&&(b=0),$cfs.triggerHandler(cf_e("slideTo",conf),[b*f,0,!0,c,d,e])}),$cfs.bind(cf_e("jumpToStart",conf),function(a,b){if(a.stopPropagation(),b=b?gn_getItemIndex(b,0,!0,itms,$cfs):0,b+=itms.first,0!=b){if(itms.total>0)for(;b>itms.total;)b-=itms.total;$cfs.prepend($cfs.children().slice(b,itms.total))}return!0}),$cfs.bind(cf_e("synchronise",conf),function(a,b){if(a.stopPropagation(),b)b=cf_getSynchArr(b);else{if(!opts.synchronise)return debug(conf,"No carousel to synchronise.");b=opts.synchronise}for(var c=$cfs.triggerHandler(cf_e("currentPosition",conf)),d=!0,e=0,f=b.length;f>e;e++)b[e][0].triggerHandler(cf_e("slideTo",conf),[c,b[e][3],!0])||(d=!1);return d}),$cfs.bind(cf_e("queue",conf),function(a,b,c){return a.stopPropagation(),is_function(b)?b.call($tt0,queu):is_array(b)?queu=b:is_undefined(b)||queu.push([b,c]),queu}),$cfs.bind(cf_e("insertItem",conf),function(a,b,c,d,e){a.stopPropagation();var f=[b,c,d,e],g=["string/object","string/number/object","boolean","number"],h=cf_sortParams(f,g);if(b=h[0],c=h[1],d=h[2],e=h[3],is_object(b)&&!is_jquery(b)?b=$(b):is_string(b)&&(b=$(b)),!is_jquery(b)||0==b.length)return debug(conf,"Not a valid object.");is_undefined(c)&&(c="end"),sz_storeMargin(b,opts),sz_storeOrigCss(b);var i=c,j="before";"end"==c?d?(0==itms.first?(c=itms.total-1,j="after"):(c=itms.first,itms.first+=b.length),0>c&&(c=0)):(c=itms.total-1,j="after"):c=gn_getItemIndex(c,e,d,itms,$cfs);var k=$cfs.children().eq(c);return k.length?k[j](b):(debug(conf,"Correct insert-position not found! Appending item to the end."),$cfs.append(b)),"end"==i||d||itms.first>c&&(itms.first+=b.length),itms.total=$cfs.children().length,itms.first>=itms.total&&(itms.first-=itms.total),$cfs.trigger(cf_e("updateSizes",conf)),$cfs.trigger(cf_e("linkAnchors",conf)),!0}),$cfs.bind(cf_e("removeItem",conf),function(a,b,c,d){a.stopPropagation();var e=[b,c,d],f=["string/number/object","boolean","number"],g=cf_sortParams(e,f);if(b=g[0],c=g[1],d=g[2],b instanceof $&&b.length>1)return i=$(),b.each(function(){var e=$cfs.trigger(cf_e("removeItem",conf),[$(this),c,d]);e&&(i=i.add(e))}),i;if(is_undefined(b)||"end"==b)i=$cfs.children().last();else{b=gn_getItemIndex(b,d,c,itms,$cfs);var i=$cfs.children().eq(b);i.length&&itms.first>b&&(itms.first-=i.length)}return i&&i.length&&(i.detach(),itms.total=$cfs.children().length,$cfs.trigger(cf_e("updateSizes",conf))),i}),$cfs.bind(cf_e("onBefore",conf)+" "+cf_e("onAfter",conf),function(a,b){a.stopPropagation();var c=a.type.slice(conf.events.prefix.length);return is_array(b)&&(clbk[c]=b),is_function(b)&&clbk[c].push(b),clbk[c]}),$cfs.bind(cf_e("currentPosition",conf),function(a,b){if(a.stopPropagation(),0==itms.first)var c=0;else var c=itms.total-itms.first;return is_function(b)&&b.call($tt0,c),c}),$cfs.bind(cf_e("currentPage",conf),function(a,b){a.stopPropagation();var e,c=opts.pagination.items||opts.items.visible,d=Math.ceil(itms.total/c-1);return e=0==itms.first?0:itms.first<itms.total%c?0:itms.first!=c||opts.circular?Math.round((itms.total-itms.first)/c):d,0>e&&(e=0),e>d&&(e=d),is_function(b)&&b.call($tt0,e),e}),$cfs.bind(cf_e("currentVisible",conf),function(a,b){a.stopPropagation();var c=gi_getCurrentItems($cfs.children(),opts);return is_function(b)&&b.call($tt0,c),c}),$cfs.bind(cf_e("slice",conf),function(a,b,c,d){if(a.stopPropagation(),0==itms.total)return!1;var e=[b,c,d],f=["number","number","function"],g=cf_sortParams(e,f);if(b=is_number(g[0])?g[0]:0,c=is_number(g[1])?g[1]:itms.total,d=g[2],b+=itms.first,c+=itms.first,items.total>0){for(;b>itms.total;)b-=itms.total;for(;c>itms.total;)c-=itms.total;for(;0>b;)b+=itms.total;for(;0>c;)c+=itms.total}var i,h=$cfs.children();return i=c>b?h.slice(b,c):$(h.slice(b,itms.total).get().concat(h.slice(0,c).get())),is_function(d)&&d.call($tt0,i),i}),$cfs.bind(cf_e("isPaused",conf)+" "+cf_e("isStopped",conf)+" "+cf_e("isScrolling",conf),function(a,b){a.stopPropagation();var c=a.type.slice(conf.events.prefix.length),d=crsl[c];return is_function(b)&&b.call($tt0,d),d}),$cfs.bind(cf_e("configuration",conf),function(e,a,b,c){e.stopPropagation();var reInit=!1;if(is_function(a))a.call($tt0,opts);else if(is_object(a))opts_orig=$.extend(!0,{},opts_orig,a),b!==!1?reInit=!0:opts=$.extend(!0,{},opts,a);else if(!is_undefined(a))if(is_function(b)){var val=eval("opts."+a);is_undefined(val)&&(val=""),b.call($tt0,val)}else{if(is_undefined(b))return eval("opts."+a);"boolean"!=typeof c&&(c=!0),eval("opts_orig."+a+" = b"),c!==!1?reInit=!0:eval("opts."+a+" = b")}if(reInit){sz_resetMargin($cfs.children(),opts),FN._init(opts_orig),FN._bind_buttons();var sz=sz_setSizes($cfs,opts);$cfs.trigger(cf_e("updatePageStatus",conf),[!0,sz])}return opts}),$cfs.bind(cf_e("linkAnchors",conf),function(a,b,c){return a.stopPropagation(),is_undefined(b)?b=$("body"):is_string(b)&&(b=$(b)),is_jquery(b)&&0!=b.length?(is_string(c)||(c="a.caroufredsel"),b.find(c).each(function(){var a=this.hash||"";a.length>0&&-1!=$cfs.children().index($(a))&&$(this).unbind("click").click(function(b){b.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),a)})}),!0):debug(conf,"Not a valid object.")}),$cfs.bind(cf_e("updatePageStatus",conf),function(a,b){if(a.stopPropagation(),opts.pagination.container){var d=opts.pagination.items||opts.items.visible,e=Math.ceil(itms.total/d);b&&(opts.pagination.anchorBuilder&&(opts.pagination.container.children().remove(),opts.pagination.container.each(function(){for(var a=0;e>a;a++){var b=$cfs.children().eq(gn_getItemIndex(a*d,0,!0,itms,$cfs));$(this).append(opts.pagination.anchorBuilder.call(b[0],a+1))}})),opts.pagination.container.each(function(){$(this).children().unbind(opts.pagination.event).each(function(a){$(this).bind(opts.pagination.event,function(b){b.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),[a*d,-opts.pagination.deviation,!0,opts.pagination])})})}));var f=$cfs.triggerHandler(cf_e("currentPage",conf))+opts.pagination.deviation;return f>=e&&(f=0),0>f&&(f=e-1),opts.pagination.container.each(function(){$(this).children().removeClass(cf_c("selected",conf)).eq(f).addClass(cf_c("selected",conf))}),!0}}),$cfs.bind(cf_e("updateSizes",conf),function(){var b=opts.items.visible,c=$cfs.children(),d=ms_getParentSize($wrp,opts,"width");if(itms.total=c.length,crsl.primarySizePercentage?(opts.maxDimension=d,opts[opts.d.width]=ms_getPercentage(d,crsl.primarySizePercentage)):opts.maxDimension=ms_getMaxDimension(opts,d),opts.responsive?(opts.items.width=opts.items.sizesConf.width,opts.items.height=opts.items.sizesConf.height,opts=in_getResponsiveValues(opts,c,d),b=opts.items.visible,sz_setResponsiveSizes(opts,c)):opts.items.visibleConf.variable?b=gn_getVisibleItemsNext(c,opts,0):"*"!=opts.items.filter&&(b=gn_getVisibleItemsNextFilter(c,opts,0)),!opts.circular&&0!=itms.first&&b>itms.first){if(opts.items.visibleConf.variable)var e=gn_getVisibleItemsPrev(c,opts,itms.first)-itms.first;else if("*"!=opts.items.filter)var e=gn_getVisibleItemsPrevFilter(c,opts,itms.first)-itms.first;else var e=opts.items.visible-itms.first;debug(conf,"Preventing non-circular: sliding "+e+" items backward."),$cfs.trigger(cf_e("prev",conf),e)}opts.items.visible=cf_getItemsAdjust(b,opts,opts.items.visibleConf.adjust,$tt0),opts.items.visibleConf.old=opts.items.visible,opts=in_getAlignPadding(opts,c);var f=sz_setSizes($cfs,opts);return $cfs.trigger(cf_e("updatePageStatus",conf),[!0,f]),nv_showNavi(opts,itms.total,conf),nv_enableNavi(opts,itms.first,conf),f}),$cfs.bind(cf_e("destroy",conf),function(a,b){return a.stopPropagation(),tmrs=sc_clearTimers(tmrs),$cfs.data("_cfs_isCarousel",!1),$cfs.trigger(cf_e("finish",conf)),b&&$cfs.trigger(cf_e("jumpToStart",conf)),sz_restoreOrigCss($cfs.children()),sz_restoreOrigCss($cfs),FN._unbind_events(),FN._unbind_buttons(),"parent"==conf.wrapper?sz_restoreOrigCss($wrp):$wrp.replaceWith($cfs),!0}),$cfs.bind(cf_e("debug",conf),function(){return debug(conf,"Carousel width: "+opts.width),debug(conf,"Carousel height: "+opts.height),debug(conf,"Item widths: "+opts.items.width),debug(conf,"Item heights: "+opts.items.height),debug(conf,"Number of items visible: "+opts.items.visible),opts.auto.play&&debug(conf,"Number of items scrolled automatically: "+opts.auto.items),opts.prev.button&&debug(conf,"Number of items scrolled backward: "+opts.prev.items),opts.next.button&&debug(conf,"Number of items scrolled forward: "+opts.next.items),conf.debug}),$cfs.bind("_cfs_triggerEvent",function(a,b,c){return a.stopPropagation(),$cfs.triggerHandler(cf_e(b,conf),c)})},FN._unbind_events=function(){$cfs.unbind(cf_e("",conf)),$cfs.unbind(cf_e("",conf,!1)),$cfs.unbind("_cfs_triggerEvent")},FN._bind_buttons=function(){if(FN._unbind_buttons(),nv_showNavi(opts,itms.total,conf),nv_enableNavi(opts,itms.first,conf),opts.auto.pauseOnHover){var a=bt_pauseOnHoverConfig(opts.auto.pauseOnHover);$wrp.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),a)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}if(opts.auto.button&&opts.auto.button.bind(cf_e(opts.auto.event,conf,!1),function(a){a.preventDefault();var b=!1,c=null;crsl.isPaused?b="play":opts.auto.pauseOnEvent&&(b="pause",c=bt_pauseOnHoverConfig(opts.auto.pauseOnEvent)),b&&$cfs.trigger(cf_e(b,conf),c)}),opts.prev.button&&(opts.prev.button.bind(cf_e(opts.prev.event,conf,!1),function(a){a.preventDefault(),$cfs.trigger(cf_e("prev",conf))}),opts.prev.pauseOnHover)){var a=bt_pauseOnHoverConfig(opts.prev.pauseOnHover);opts.prev.button.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),a)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}if(opts.next.button&&(opts.next.button.bind(cf_e(opts.next.event,conf,!1),function(a){a.preventDefault(),$cfs.trigger(cf_e("next",conf))}),opts.next.pauseOnHover)){var a=bt_pauseOnHoverConfig(opts.next.pauseOnHover);opts.next.button.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),a)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}if(opts.pagination.container&&opts.pagination.pauseOnHover){var a=bt_pauseOnHoverConfig(opts.pagination.pauseOnHover);opts.pagination.container.bind(cf_e("mouseenter",conf,!1),function(){$cfs.trigger(cf_e("pause",conf),a)}).bind(cf_e("mouseleave",conf,!1),function(){$cfs.trigger(cf_e("resume",conf))})}if((opts.prev.key||opts.next.key)&&$(document).bind(cf_e("keyup",conf,!1,!0,!0),function(a){var b=a.keyCode;b==opts.next.key&&(a.preventDefault(),$cfs.trigger(cf_e("next",conf))),b==opts.prev.key&&(a.preventDefault(),$cfs.trigger(cf_e("prev",conf)))}),opts.pagination.keys&&$(document).bind(cf_e("keyup",conf,!1,!0,!0),function(a){var b=a.keyCode;b>=49&&58>b&&(b=(b-49)*opts.items.visible,itms.total>=b&&(a.preventDefault(),$cfs.trigger(cf_e("slideTo",conf),[b,0,!0,opts.pagination])))}),$.fn.swipe){var b="ontouchstart"in window;if(b&&opts.swipe.onTouch||!b&&opts.swipe.onMouse){var c=$.extend(!0,{},opts.prev,opts.swipe),d=$.extend(!0,{},opts.next,opts.swipe),e=function(){$cfs.trigger(cf_e("prev",conf),[c])},f=function(){$cfs.trigger(cf_e("next",conf),[d])};switch(opts.direction){case"up":case"down":opts.swipe.options.swipeUp=f,opts.swipe.options.swipeDown=e;break;default:opts.swipe.options.swipeLeft=f,opts.swipe.options.swipeRight=e}crsl.swipe&&$cfs.swipe("destroy"),$wrp.swipe(opts.swipe.options),$wrp.css("cursor","move"),crsl.swipe=!0}}if($.fn.mousewheel&&opts.mousewheel){var g=$.extend(!0,{},opts.prev,opts.mousewheel),h=$.extend(!0,{},opts.next,opts.mousewheel);crsl.mousewheel&&$wrp.unbind(cf_e("mousewheel",conf,!1)),$wrp.bind(cf_e("mousewheel",conf,!1),function(a,b){a.preventDefault(),b>0?$cfs.trigger(cf_e("prev",conf),[g]):$cfs.trigger(cf_e("next",conf),[h])}),crsl.mousewheel=!0}if(opts.auto.play&&$cfs.trigger(cf_e("play",conf),opts.auto.delay),crsl.upDateOnWindowResize){var i=function(){$cfs.trigger(cf_e("finish",conf)),opts.auto.pauseOnResize&&!crsl.isPaused&&$cfs.trigger(cf_e("play",conf)),sz_resetMargin($cfs.children(),opts),$cfs.trigger(cf_e("updateSizes",conf))},j=$(window),k=null;if($.debounce&&"debounce"==conf.onWindowResize)k=$.debounce(200,i);else if($.throttle&&"throttle"==conf.onWindowResize)k=$.throttle(300,i);else{var l=0,m=0;k=function(){var a=j.width(),b=j.height();(a!=l||b!=m)&&(i(),l=a,m=b)}}j.bind(cf_e("resize",conf,!1,!0,!0),k)}},FN._unbind_buttons=function(){var b=(cf_e("",conf),cf_e("",conf,!1));ns3=cf_e("",conf,!1,!0,!0),$(document).unbind(ns3),$(window).unbind(ns3),$wrp.unbind(b),opts.auto.button&&opts.auto.button.unbind(b),opts.prev.button&&opts.prev.button.unbind(b),opts.next.button&&opts.next.button.unbind(b),opts.pagination.container&&(opts.pagination.container.unbind(b),opts.pagination.anchorBuilder&&opts.pagination.container.children().remove()),crsl.swipe&&($cfs.swipe("destroy"),$wrp.css("cursor","default"),crsl.swipe=!1),crsl.mousewheel&&(crsl.mousewheel=!1),nv_showNavi(opts,"hide",conf),nv_enableNavi(opts,"removeClass",conf)},is_boolean(configs)&&(configs={debug:configs});var crsl={direction:"next",isPaused:!0,isScrolling:!1,isStopped:!1,mousewheel:!1,swipe:!1},itms={total:$cfs.children().length,first:0},tmrs={auto:null,progress:null,startTime:getTime(),timePassed:0},scrl={isStopped:!1,duration:0,startTime:0,easing:"",anims:[]},clbk={onBefore:[],onAfter:[]},queu=[],conf=$.extend(!0,{},$.fn.carouFredSel.configs,configs),opts={},opts_orig=$.extend(!0,{},options),$wrp="parent"==conf.wrapper?$cfs.parent():$cfs.wrap("<"+conf.wrapper.element+' class="'+conf.wrapper.classname+'" />').parent();if(conf.selector=$cfs.selector,conf.serialNumber=$.fn.carouFredSel.serialNumber++,conf.transition=conf.transition&&$.fn.transition?"transition":"animate",FN._init(opts_orig,!0,starting_position),FN._build(),FN._bind_events(),FN._bind_buttons(),is_array(opts.items.start))var start_arr=opts.items.start;else{var start_arr=[];0!=opts.items.start&&start_arr.push(opts.items.start)}if(opts.cookie&&start_arr.unshift(parseInt(cf_getCookie(opts.cookie),10)),start_arr.length>0)for(var a=0,l=start_arr.length;l>a;a++){var s=start_arr[a];if(0!=s){if(s===!0){if(s=window.location.hash,1>s.length)continue}else"random"===s&&(s=Math.floor(Math.random()*itms.total));if($cfs.triggerHandler(cf_e("slideTo",conf),[s,0,!0,{fx:"none"}]))break}}var siz=sz_setSizes($cfs,opts),itm=gi_getCurrentItems($cfs.children(),opts);return opts.onCreate&&opts.onCreate.call($tt0,{width:siz.width,height:siz.height,items:itm}),$cfs.trigger(cf_e("updatePageStatus",conf),[!0,siz]),$cfs.trigger(cf_e("linkAnchors",conf)),conf.debug&&$cfs.trigger(cf_e("debug",conf)),$cfs},$.fn.carouFredSel.serialNumber=1,$.fn.carouFredSel.defaults={synchronise:!1,infinite:!0,circular:!0,responsive:!1,direction:"left",items:{start:0},scroll:{easing:"swing",duration:500,pauseOnHover:!1,event:"click",queue:!1}},$.fn.carouFredSel.configs={debug:!1,transition:!1,onWindowResize:"throttle",events:{prefix:"",namespace:"cfs"},wrapper:{element:"div",classname:"caroufredsel_wrapper"},classnames:{}},$.fn.carouFredSel.pageAnchorBuilder=function(a){return'<a href="#"><span>'+a+"</span></a>"},$.fn.carouFredSel.progressbarUpdater=function(a){$(this).css("width",a+"%")},$.fn.carouFredSel.cookie={get:function(a){a+="=";for(var b=document.cookie.split(";"),c=0,d=b.length;d>c;c++){for(var e=b[c];" "==e.charAt(0);)e=e.slice(1);if(0==e.indexOf(a))return e.slice(a.length)}return 0},set:function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+1e3*60*60*24*c),d="; expires="+e.toGMTString()}document.cookie=a+"="+b+d+"; path=/"},remove:function(a){$.fn.carouFredSel.cookie.set(a,"",-1)}},$.extend($.easing,{quadratic:function(a){var b=a*a;return a*(-b*a+4*b-6*a+4)},cubic:function(a){return a*(4*a*a-9*a+6)},elastic:function(a){var b=a*a;return a*(33*b*b-106*b*a+126*b-67*a+15)}}))})(jQuery);
(function($){function log(e){window.console&&window.console.log&&window.console.log(e)}function setHighlight(e,t){var n=0;if(e.nodeType==3){var r=0,i=e.data.replace(t,function(e){r=1;return"<span class='highlight'>"+e+"</span>"});if(r){$(e).replaceWith(i);n=1}}else if(e.nodeType==1&&e.childNodes&&!/(script|style)/i.test(e.tagName))if(!/(span)/i.test(e.tagName)||!$(e).hasClass(settings.highlightClass))for(var s=0;s<e.childNodes.length;++s)s+=setHighlight(e.childNodes[s],t);return n}function createAccentRegexp(e){var t=deaccent(e),n=t.replace(/([|()[{.+*?^$\\])/g,"\\$1"),r=function(e){return charToAccentedCharClassMap[e]||e},i=n.replace(/\S/g,r);return i}function deaccent(e){var t=e;for(var n in charToAccentedCharClassMap)t=t.replace(new RegExp(charToAccentedCharClassMap[n],"g"),n);return t}var charToAccentedCharClassMap={A:"[Aa--------]",B:"[Bb--]",C:"[Cc--]",D:"[Dd-----]",E:"[Ee------]",F:"[Ff--]",G:"[Gg--]",H:"[Hh---]",I:"[Ii---------]",J:"[Jj--]",K:"[Kk--]",L:"[Ll----]",M:"[Mm----]",N:"[Nn---]",O:"[Oo-----]",P:"[Pp---]",Q:"[Qq]",R:"[Rr-----]",S:"[Ss---]",T:"[Tt--]",U:"[Uu------]",V:"[Vv----]",W:"[Ww--]",X:"[Xx---]",Y:"[Yy--]",Z:"[Zz----]"},settings={highlightClass:"highlight",partial:!1,lenient:!0},methods={init:function(e){e&&$.extend(settings,e)},highlight:function(e){var t=e,n=settings.lenient;settings.lenient&&(t=createAccentRegexp(e));if(settings.partial)var r=new RegExp(t.split(" ").join("|"),"ig");else var r=new RegExp("\\b"+t.split(" ").join("|\\b"),"ig");return this.each(function(){setHighlight(this,r)})},removeHighlight:function(){return this.find("span."+settings.highlightClass).each(function(){this.parentNode.firstChild.nodeName;with(this.parentNode){replaceChild(this.firstChild,this);normalize()}}).end()}};$.fn.easymark=function(e){if(methods[e])return methods[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return methods.init.apply(this,arguments);$.error("Method "+e+" does not exist on jQuery.easyMark")}})(jQuery);(function(B){B.color={};B.color.make=function(F,E,C,D){var G={};G.r=F||0;G.g=E||0;G.b=C||0;G.a=D!=null?D:1;G.add=function(J,I){for(var H=0;H<J.length;++H){G[J.charAt(H)]+=I}return G.normalize()};G.scale=function(J,I){for(var H=0;H<J.length;++H){G[J.charAt(H)]*=I}return G.normalize()};G.toString=function(){if(G.a>=1){return"rgb("+[G.r,G.g,G.b].join(",")+")"}else{return"rgba("+[G.r,G.g,G.b,G.a].join(",")+")"}};G.normalize=function(){function H(J,K,I){return K<J?J:K>I?I:K}G.r=H(0,parseInt(G.r),255);G.g=H(0,parseInt(G.g),255);G.b=H(0,parseInt(G.b),255);G.a=H(0,G.a,1);return G};G.clone=function(){return B.color.make(G.r,G.b,G.g,G.a)};return G.normalize()};B.color.extract=function(D,C){var E;do{E=D.css(C).toLowerCase();if(E!=""&&E!="transparent"){break}D=D.parent()}while(!B.nodeName(D.get(0),"body"));if(E=="rgba(0, 0, 0, 0)"){E="transparent"}return B.color.parse(E)};B.color.parse=function(F){var E,C=B.color.make;if(E=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(F)){return C(parseInt(E[1],10),parseInt(E[2],10),parseInt(E[3],10))}if(E=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(F)){return C(parseInt(E[1],10),parseInt(E[2],10),parseInt(E[3],10),parseFloat(E[4]))}if(E=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(F)){return C(parseFloat(E[1])*2.55,parseFloat(E[2])*2.55,parseFloat(E[3])*2.55)}if(E=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(F)){return C(parseFloat(E[1])*2.55,parseFloat(E[2])*2.55,parseFloat(E[3])*2.55,parseFloat(E[4]))}if(E=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(F)){return C(parseInt(E[1],16),parseInt(E[2],16),parseInt(E[3],16))}if(E=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(F)){return C(parseInt(E[1]+E[1],16),parseInt(E[2]+E[2],16),parseInt(E[3]+E[3],16))}var D=B.trim(F).toLowerCase();if(D=="transparent"){return C(255,255,255,0)}else{E=A[D]||[0,0,0];return C(E[0],E[1],E[2])}};var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function($){function Plot(placeholder,data_,options_,plugins){var series=[],options={colors:["#1989ff","#ff345c","#ff6c8a","#f4d872","#7fa9aa"],legend:{show:true,noColumns:5,labelFormatter:null,labelBoxBorderColor:"#cbcbcb",container:"#legend",position:"ne",margin:15,backgroundColor:"#fff",borderWidth:1,borderColor:"#000",backgroundOpacity:1,labelFormatter:function(label,series){return'<a href="#'+label+'">'+label+"</a>"}},xaxis:{show:true,position:"bottom",mode:null,color:"#777",tickColor:"#777",transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:"full",alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:4,lineWidth:3,fill:true,fillColor:"#fafafa",symbol:"circle"},lines:{lineWidth:1.5,fill:false,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:0},grid:{show:true,aboveData:false,color:"#999",backgroundColor:"#fafafa",borderColor:"#ccc",tickColor:"#e0e0e0",labelMargin:15,axisMargin:8,borderWidth:1,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:1,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:20},hooks:{}},canvas=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],plotOffset={left:0,right:0,top:0,bottom:0},canvasWidth=0,canvasHeight=0,plotWidth=0,plotHeight=0,hooks={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},plot=this;plot.setData=setData;plot.setupGrid=setupGrid;plot.draw=draw;plot.getPlaceholder=function(){return placeholder};plot.getCanvas=function(){return canvas};plot.getPlotOffset=function(){return plotOffset};plot.width=function(){return plotWidth};plot.height=function(){return plotHeight};plot.offset=function(){var o=eventHolder.offset();o.left+=plotOffset.left;o.top+=plotOffset.top;return o};plot.getData=function(){return series};plot.getAxes=function(){var res={},i;$.each(xaxes.concat(yaxes),function(_,axis){if(axis)res[axis.direction+(axis.n!=1?axis.n:"")+"axis"]=axis});return res};plot.getXAxes=function(){return xaxes};plot.getYAxes=function(){return yaxes};plot.c2p=canvasToAxisCoords;plot.p2c=axisToCanvasCoords;plot.getOptions=function(){return options};plot.highlight=highlight;plot.unhighlight=unhighlight;plot.triggerRedrawOverlay=triggerRedrawOverlay;plot.pointOffset=function(point){return{left:parseInt(xaxes[axisNumber(point,"x")-1].p2c(+point.x)+plotOffset.left),top:parseInt(yaxes[axisNumber(point,"y")-1].p2c(+point.y)+plotOffset.top)}};plot.shutdown=shutdown;plot.resize=function(){getCanvasDimensions();resizeCanvas(canvas);resizeCanvas(overlay)};plot.hooks=hooks;initPlugins(plot);parseOptions(options_);setupCanvases();setData(data_);setupGrid();draw();bindEvents();function executeHooks(hook,args){args=[plot].concat(args);for(var i=0;i<hook.length;++i)hook[i].apply(this,args)}function initPlugins(){for(var i=0;i<plugins.length;++i){var p=plugins[i];p.init(plot);if(p.options)$.extend(true,options,p.options)}}function parseOptions(opts){var i;$.extend(true,options,opts);if(options.xaxis.color==null)options.xaxis.color=options.grid.color;if(options.yaxis.color==null)options.yaxis.color=options.grid.color;if(options.xaxis.tickColor==null)options.xaxis.tickColor=options.grid.tickColor;if(options.yaxis.tickColor==null)options.yaxis.tickColor=options.grid.tickColor;if(options.grid.borderColor==null)options.grid.borderColor=options.grid.color;if(options.grid.tickColor==null)options.grid.tickColor=$.color.parse(options.grid.color).scale("a",.22).toString();for(i=0;i<Math.max(1,options.xaxes.length);++i)options.xaxes[i]=$.extend(true,{},options.xaxis,options.xaxes[i]);for(i=0;i<Math.max(1,options.yaxes.length);++i)options.yaxes[i]=$.extend(true,{},options.yaxis,options.yaxes[i]);if(options.xaxis.noTicks&&options.xaxis.ticks==null)options.xaxis.ticks=options.xaxis.noTicks;if(options.yaxis.noTicks&&options.yaxis.ticks==null)options.yaxis.ticks=options.yaxis.noTicks;if(options.x2axis){options.xaxes[1]=$.extend(true,{},options.xaxis,options.x2axis);options.xaxes[1].position="top"}if(options.y2axis){options.yaxes[1]=$.extend(true,{},options.yaxis,options.y2axis);options.yaxes[1].position="right"}if(options.grid.coloredAreas)options.grid.markings=options.grid.coloredAreas;if(options.grid.coloredAreasColor)options.grid.markingsColor=options.grid.coloredAreasColor;if(options.lines)$.extend(true,options.series.lines,options.lines);if(options.points)$.extend(true,options.series.points,options.points);if(options.bars)$.extend(true,options.series.bars,options.bars);if(options.shadowSize!=null)options.series.shadowSize=options.shadowSize;for(i=0;i<options.xaxes.length;++i)getOrCreateAxis(xaxes,i+1).options=options.xaxes[i];for(i=0;i<options.yaxes.length;++i)getOrCreateAxis(yaxes,i+1).options=options.yaxes[i];for(var n in hooks)if(options.hooks[n]&&options.hooks[n].length)hooks[n]=hooks[n].concat(options.hooks[n]);executeHooks(hooks.processOptions,[options])}function setData(d){series=parseData(d);fillInSeriesOptions();processData()}function parseData(d){var res=[];for(var i=0;i<d.length;++i){var s=$.extend(true,{},options.series);if(d[i].data!=null){s.data=d[i].data;delete d[i].data;$.extend(true,s,d[i]);d[i].data=s.data}else s.data=d[i];res.push(s)}return res}function axisNumber(obj,coord){var a=obj[coord+"axis"];if(typeof a=="object")a=a.n;if(typeof a!="number")a=1;return a}function allAxes(){return $.grep(xaxes.concat(yaxes),function(a){return a})}function canvasToAxisCoords(pos){var res={},i,axis;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used)res["x"+axis.n]=axis.c2p(pos.left)}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used)res["y"+axis.n]=axis.c2p(pos.top)}if(res.x1!==undefined)res.x=res.x1;if(res.y1!==undefined)res.y=res.y1;return res}function axisToCanvasCoords(pos){var res={},i,axis,key;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used){key="x"+axis.n;if(pos[key]==null&&axis.n==1)key="x";if(pos[key]!=null){res.left=axis.p2c(pos[key]);break}}}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used){key="y"+axis.n;if(pos[key]==null&&axis.n==1)key="y";if(pos[key]!=null){res.top=axis.p2c(pos[key]);break}}}return res}function getOrCreateAxis(axes,number){if(!axes[number-1])axes[number-1]={n:number,direction:axes==xaxes?"x":"y",options:$.extend(true,{},axes==xaxes?options.xaxis:options.yaxis)};return axes[number-1]}function fillInSeriesOptions(){var i;var neededColors=series.length,usedColors=[],assignedColors=[];for(i=0;i<series.length;++i){var sc=series[i].color;if(sc!=null){--neededColors;if(typeof sc=="number")assignedColors.push(sc);else usedColors.push($.color.parse(series[i].color))}}for(i=0;i<assignedColors.length;++i){neededColors=Math.max(neededColors,assignedColors[i]+1)}var colors=[],variation=0;i=0;while(colors.length<neededColors){var c;if(options.colors.length==i)c=$.color.make(100,100,100);else c=$.color.parse(options.colors[i]);var sign=variation%2==1?-1:1;c.scale("rgb",1+sign*Math.ceil(variation/2)*.2);colors.push(c);++i;if(i>=options.colors.length){i=0;++variation}}var colori=0,s;for(i=0;i<series.length;++i){s=series[i];if(s.color==null){s.color=colors[colori].toString();++colori}else if(typeof s.color=="number")s.color=colors[s.color].toString();if(s.lines.show==null){var v,show=true;for(v in s)if(s[v]&&s[v].show){show=false;break}if(show)s.lines.show=true}s.xaxis=getOrCreateAxis(xaxes,axisNumber(s,"x"));s.yaxis=getOrCreateAxis(yaxes,axisNumber(s,"y"))}}function processData(){var topSentry=Number.POSITIVE_INFINITY,bottomSentry=Number.NEGATIVE_INFINITY,fakeInfinity=Number.MAX_VALUE,i,j,k,m,length,s,points,ps,x,y,axis,val,f,p;function updateAxis(axis,min,max){if(min<axis.datamin&&min!=-fakeInfinity)axis.datamin=min;if(max>axis.datamax&&max!=fakeInfinity)axis.datamax=max}$.each(allAxes(),function(_,axis){axis.datamin=topSentry;axis.datamax=bottomSentry;axis.used=false});for(i=0;i<series.length;++i){s=series[i];s.datapoints={points:[]};executeHooks(hooks.processRawData,[s,s.data,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];var data=s.data,format=s.datapoints.format;if(!format){format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||s.lines.show&&s.lines.fill){format.push({y:true,number:true,required:false,defaultValue:0});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}s.datapoints.format=format}if(s.datapoints.pointsize!=null)continue;s.datapoints.pointsize=format.length;ps=s.datapoints.pointsize;points=s.datapoints.points;insertSteps=s.lines.show&&s.lines.steps;s.xaxis.used=s.yaxis.used=true;for(j=k=0;j<data.length;++j,k+=ps){p=data[j];var nullify=p==null;if(!nullify){for(m=0;m<ps;++m){val=p[m];f=format[m];if(f){if(f.number&&val!=null){val=+val;if(isNaN(val))val=null;else if(val==Infinity)val=fakeInfinity;else if(val==-Infinity)val=-fakeInfinity}if(val==null){if(f.required)nullify=true;if(f.defaultValue!=null)val=f.defaultValue}}points[k+m]=val}}if(nullify){for(m=0;m<ps;++m){val=points[k+m];if(val!=null){f=format[m];if(f.x)updateAxis(s.xaxis,val,val);if(f.y)updateAxis(s.yaxis,val,val)}points[k+m]=null}}else{if(insertSteps&&k>0&&points[k-ps]!=null&&points[k-ps]!=points[k]&&points[k-ps+1]!=points[k+1]){for(m=0;m<ps;++m)points[k+ps+m]=points[k+m];points[k+1]=points[k-ps+1];k+=ps}}}}for(i=0;i<series.length;++i){s=series[i];executeHooks(hooks.processDatapoints,[s,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];points=s.datapoints.points,ps=s.datapoints.pointsize;var xmin=topSentry,ymin=topSentry,xmax=bottomSentry,ymax=bottomSentry;for(j=0;j<points.length;j+=ps){if(points[j]==null)continue;for(m=0;m<ps;++m){val=points[j+m];f=format[m];if(!f||val==fakeInfinity||val==-fakeInfinity)continue;if(f.x){if(val<xmin)xmin=val;if(val>xmax)xmax=val}if(f.y){if(val<ymin)ymin=val;if(val>ymax)ymax=val}}}if(s.bars.show){var delta=s.bars.align=="left"?0:-s.bars.barWidth/2;if(s.bars.horizontal){ymin+=delta;ymax+=delta+s.bars.barWidth}else{xmin+=delta;xmax+=delta+s.bars.barWidth}}updateAxis(s.xaxis,xmin,xmax);updateAxis(s.yaxis,ymin,ymax)}$.each(allAxes(),function(_,axis){if(axis.datamin==topSentry)axis.datamin=null;if(axis.datamax==bottomSentry)axis.datamax=null})}function makeCanvas(skipPositioning,cls){var c=document.createElement("canvas");c.className=cls;c.width=canvasWidth;c.height=canvasHeight;if(!skipPositioning)$(c).css({position:"absolute",left:0,top:0});$(c).appendTo(placeholder);if(!c.getContext)c=window.G_vmlCanvasManager.initElement(c);c.getContext("2d").save();return c}function getCanvasDimensions(){canvasWidth=placeholder.width();canvasHeight=placeholder.height();if(canvasWidth<=0||canvasHeight<=0)throw"Invalid dimensions for plot, width = "+canvasWidth+", height = "+canvasHeight}function resizeCanvas(c){if(c.width!=canvasWidth)c.width=canvasWidth;if(c.height!=canvasHeight)c.height=canvasHeight;var cctx=c.getContext("2d");cctx.restore();cctx.save()}function setupCanvases(){var reused,existingCanvas=placeholder.children("canvas.base"),existingOverlay=placeholder.children("canvas.overlay");if(existingCanvas.length==0||existingOverlay==0){placeholder.html("");placeholder.css({padding:0});if(placeholder.css("position")=="static")placeholder.css("position","relative");getCanvasDimensions();canvas=makeCanvas(true,"base");overlay=makeCanvas(false,"overlay");reused=false}else{canvas=existingCanvas.get(0);overlay=existingOverlay.get(0);reused=true}ctx=canvas.getContext("2d");octx=overlay.getContext("2d");eventHolder=$([overlay,canvas]);if(reused){placeholder.data("plot").shutdown();plot.resize();octx.clearRect(0,0,canvasWidth,canvasHeight);eventHolder.unbind();placeholder.children().not([canvas,overlay]).remove()}placeholder.data("plot",plot)}function bindEvents(){if(options.grid.hoverable){eventHolder.mousemove(onMouseMove);eventHolder.mouseleave(onMouseLeave)}if(options.grid.clickable)eventHolder.click(onClick);executeHooks(hooks.bindEvents,[eventHolder])}function shutdown(){if(redrawTimeout)clearTimeout(redrawTimeout);eventHolder.unbind("mousemove",onMouseMove);eventHolder.unbind("mouseleave",onMouseLeave);eventHolder.unbind("click",onClick);executeHooks(hooks.shutdown,[eventHolder])}function setTransformationHelpers(axis){function identity(x){return x}var s,m,t=axis.options.transform||identity,it=axis.options.inverseTransform;if(axis.direction=="x"){s=axis.scale=plotWidth/Math.abs(t(axis.max)-t(axis.min));m=Math.min(t(axis.max),t(axis.min))}else{s=axis.scale=plotHeight/Math.abs(t(axis.max)-t(axis.min));s=-s;m=Math.max(t(axis.max),t(axis.min))}if(t==identity)axis.p2c=function(p){return(p-m)*s};else axis.p2c=function(p){return(t(p)-m)*s};if(!it)axis.c2p=function(c){return m+c/s};else axis.c2p=function(c){return it(m+c/s)}}function measureTickLabels(axis){var opts=axis.options,i,ticks=axis.ticks||[],labels=[],l,w=opts.labelWidth,h=opts.labelHeight,dummyDiv;function makeDummyDiv(labels,width){return $('<div style="position:absolute;top:-10000px;'+width+'font-size:smaller">'+'<div class="'+axis.direction+"Axis "+axis.direction+axis.n+'Axis">'+labels.join("")+"</div></div>").appendTo(placeholder)}if(axis.direction=="x"){if(w==null)w=Math.floor(canvasWidth/(ticks.length>0?ticks.length:1));if(h==null){labels=[];for(i=0;i<ticks.length;++i){l=ticks[i].label;if(l)labels.push('<div class="tickLabel" style="float:left;width:'+w+'px">'+l+"</div>")}if(labels.length>0){labels.push('<div style="clear:left"></div>');dummyDiv=makeDummyDiv(labels,"width:10000px;");h=dummyDiv.height();dummyDiv.remove()}}}else if(w==null||h==null){for(i=0;i<ticks.length;++i){l=ticks[i].label;if(l)labels.push('<div class="tickLabel">'+l+"</div>")}if(labels.length>0){dummyDiv=makeDummyDiv(labels,"");if(w==null)w=dummyDiv.children().width();if(h==null)h=dummyDiv.find("div.tickLabel").height();dummyDiv.remove()}}if(w==null)w=0;if(h==null)h=0;axis.labelWidth=w;axis.labelHeight=h}function allocateAxisBoxFirstPhase(axis){var lw=axis.labelWidth,lh=axis.labelHeight,pos=axis.options.position,tickLength=axis.options.tickLength,axismargin=options.grid.axisMargin,padding=options.grid.labelMargin,all=axis.direction=="x"?xaxes:yaxes,index;var samePosition=$.grep(all,function(a){return a&&a.options.position==pos&&a.reserveSpace});if($.inArray(axis,samePosition)==samePosition.length-1)axismargin=0;if(tickLength==null)tickLength="full";var sameDirection=$.grep(all,function(a){return a&&a.reserveSpace});var innermost=$.inArray(axis,sameDirection)==0;if(!innermost&&tickLength=="full")tickLength=5;if(!isNaN(+tickLength))padding+=+tickLength;if(axis.direction=="x"){lh+=padding;if(pos=="bottom"){plotOffset.bottom+=lh+axismargin;axis.box={top:canvasHeight-plotOffset.bottom,height:lh}}else{axis.box={top:plotOffset.top+axismargin,height:lh};plotOffset.top+=lh+axismargin}}else{lw+=padding;if(pos=="left"){axis.box={left:plotOffset.left+axismargin,width:lw};plotOffset.left+=lw+axismargin}else{plotOffset.right+=lw+axismargin;axis.box={left:canvasWidth-plotOffset.right,width:lw}}}axis.position=pos;axis.tickLength=tickLength;axis.box.padding=padding;axis.innermost=innermost}function allocateAxisBoxSecondPhase(axis){if(axis.direction=="x"){axis.box.left=plotOffset.left;axis.box.width=plotWidth}else{axis.box.top=plotOffset.top;axis.box.height=plotHeight}}function setupGrid(){var i,axes=allAxes();$.each(axes,function(_,axis){axis.show=axis.options.show;if(axis.show==null)axis.show=axis.used;axis.reserveSpace=axis.show||axis.options.reserveSpace;setRange(axis)});allocatedAxes=$.grep(axes,function(axis){return axis.reserveSpace});plotOffset.left=plotOffset.right=plotOffset.top=plotOffset.bottom=0;if(options.grid.show){$.each(allocatedAxes,function(_,axis){setupTickGeneration(axis);setTicks(axis);snapRangeToTicks(axis,axis.ticks);measureTickLabels(axis)});for(i=allocatedAxes.length-1;i>=0;--i)allocateAxisBoxFirstPhase(allocatedAxes[i]);var minMargin=options.grid.minBorderMargin;if(minMargin==null){minMargin=0;for(i=0;i<series.length;++i)minMargin=Math.max(minMargin,series[i].points.radius+series[i].points.lineWidth/2)}for(var a in plotOffset){plotOffset[a]+=options.grid.borderWidth;plotOffset[a]=Math.max(minMargin,plotOffset[a])}}plotWidth=canvasWidth-plotOffset.left-plotOffset.right;plotHeight=canvasHeight-plotOffset.bottom-plotOffset.top;$.each(axes,function(_,axis){setTransformationHelpers(axis)});if(options.grid.show){$.each(allocatedAxes,function(_,axis){allocateAxisBoxSecondPhase(axis)});insertAxisLabels()}insertLegend()}function setRange(axis){var opts=axis.options,min=+(opts.min!=null?opts.min:axis.datamin),max=+(opts.max!=null?opts.max:axis.datamax),delta=max-min;if(delta==0){var widen=max==0?1:.01;if(opts.min==null)min-=widen;if(opts.max==null||opts.min!=null)max+=widen}else{var margin=opts.autoscaleMargin;if(margin!=null){if(opts.min==null){min-=delta*margin;if(min<0&&axis.datamin!=null&&axis.datamin>=0)min=0}if(opts.max==null){max+=delta*margin;if(max>0&&axis.datamax!=null&&axis.datamax<=0)max=0}}}axis.min=min;axis.max=max}function setupTickGeneration(axis){var opts=axis.options;var noTicks;if(typeof opts.ticks=="number"&&opts.ticks>0)noTicks=opts.ticks;else noTicks=.3*Math.sqrt(axis.direction=="x"?canvasWidth:canvasHeight);var delta=(axis.max-axis.min)/noTicks,size,generator,unit,formatter,i,magn,norm;if(opts.mode=="time"){var timeUnitSize={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,year:365.2425*24*60*60*1e3};var spec=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var minSize=0;if(opts.minTickSize!=null){if(typeof opts.tickSize=="number")minSize=opts.tickSize;else minSize=opts.minTickSize[0]*timeUnitSize[opts.minTickSize[1]]}for(var i=0;i<spec.length-1;++i)if(delta<(spec[i][0]*timeUnitSize[spec[i][1]]+spec[i+1][0]*timeUnitSize[spec[i+1][1]])/2&&spec[i][0]*timeUnitSize[spec[i][1]]>=minSize)break;size=spec[i][0];unit=spec[i][1];if(unit=="year"){magn=Math.pow(10,Math.floor(Math.log(delta/timeUnitSize.year)/Math.LN10));norm=delta/timeUnitSize.year/magn;if(norm<1.5)size=1;else if(norm<3)size=2;else if(norm<7.5)size=5;else size=10;size*=magn}axis.tickSize=opts.tickSize||[size,unit];generator=function(axis){var ticks=[],tickSize=axis.tickSize[0],unit=axis.tickSize[1],d=new Date(axis.min);var step=tickSize*timeUnitSize[unit];if(unit=="second")d.setUTCSeconds(floorInBase(d.getUTCSeconds(),tickSize));if(unit=="minute")d.setUTCMinutes(floorInBase(d.getUTCMinutes(),tickSize));if(unit=="hour")d.setUTCHours(floorInBase(d.getUTCHours(),tickSize));if(unit=="month")d.setUTCMonth(floorInBase(d.getUTCMonth(),tickSize));if(unit=="year")d.setUTCFullYear(floorInBase(d.getUTCFullYear(),tickSize));d.setUTCMilliseconds(0);if(step>=timeUnitSize.minute)d.setUTCSeconds(0);if(step>=timeUnitSize.hour)d.setUTCMinutes(0);if(step>=timeUnitSize.day)d.setUTCHours(0);if(step>=timeUnitSize.day*4)d.setUTCDate(1);if(step>=timeUnitSize.year)d.setUTCMonth(0);var carry=0,v=Number.NaN,prev;do{prev=v;v=d.getTime();ticks.push(v);if(unit=="month"){if(tickSize<1){d.setUTCDate(1);var start=d.getTime();d.setUTCMonth(d.getUTCMonth()+1);var end=d.getTime();d.setTime(v+carry*timeUnitSize.hour+(end-start)*tickSize);carry=d.getUTCHours();d.setUTCHours(0)}else d.setUTCMonth(d.getUTCMonth()+tickSize)}else if(unit=="year"){d.setUTCFullYear(d.getUTCFullYear()+tickSize)}else d.setTime(v+step)}while(v<axis.max&&v!=prev);return ticks};formatter=function(v,axis){var d=new Date(v);if(opts.timeformat!=null)return $.plot.formatDate(d,opts.timeformat,opts.monthNames);var t=axis.tickSize[0]*timeUnitSize[axis.tickSize[1]];var span=axis.max-axis.min;var suffix=opts.twelveHourClock?" %p":"";if(t<timeUnitSize.minute)fmt="%h:%M:%S"+suffix;else if(t<timeUnitSize.day){if(span<2*timeUnitSize.day)fmt="%h:%M"+suffix;else fmt="%b %d %h:%M"+suffix}else if(t<timeUnitSize.month)fmt="%b %d";else if(t<timeUnitSize.year){if(span<timeUnitSize.year)fmt="%b";else fmt="%b %y"}else fmt="%y";return $.plot.formatDate(d,fmt,opts.monthNames)}}else{var maxDec=opts.tickDecimals;var dec=-Math.floor(Math.log(delta)/Math.LN10);if(maxDec!=null&&dec>maxDec)dec=maxDec;magn=Math.pow(10,-dec);norm=delta/magn;if(norm<1.5)size=1;else if(norm<3){size=2;if(norm>2.25&&(maxDec==null||dec+1<=maxDec)){size=2.5;++dec}}else if(norm<7.5)size=5;else size=10;size*=magn;if(opts.minTickSize!=null&&size<opts.minTickSize)size=opts.minTickSize;axis.tickDecimals=Math.max(0,maxDec!=null?maxDec:dec);axis.tickSize=opts.tickSize||size;generator=function(axis){var ticks=[];var start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN,prev;do{prev=v;v=start+i*axis.tickSize;ticks.push(v);++i}while(v<axis.max&&v!=prev);return ticks};formatter=function(v,axis){return v.toFixed(axis.tickDecimals)}}if(opts.alignTicksWithAxis!=null){var otherAxis=(axis.direction=="x"?xaxes:yaxes)[opts.alignTicksWithAxis-1];if(otherAxis&&otherAxis.used&&otherAxis!=axis){var niceTicks=generator(axis);if(niceTicks.length>0){if(opts.min==null)axis.min=Math.min(axis.min,niceTicks[0]);if(opts.max==null&&niceTicks.length>1)axis.max=Math.max(axis.max,niceTicks[niceTicks.length-1])}generator=function(axis){var ticks=[],v,i;for(i=0;i<otherAxis.ticks.length;++i){v=(otherAxis.ticks[i].v-otherAxis.min)/(otherAxis.max-otherAxis.min);v=axis.min+v*(axis.max-axis.min);ticks.push(v)}return ticks};if(axis.mode!="time"&&opts.tickDecimals==null){var extraDec=Math.max(0,-Math.floor(Math.log(delta)/Math.LN10)+1),ts=generator(axis);if(!(ts.length>1&&/\..*0$/.test((ts[1]-ts[0]).toFixed(extraDec))))axis.tickDecimals=extraDec}}}axis.tickGenerator=generator;if($.isFunction(opts.tickFormatter))axis.tickFormatter=function(v,axis){return""+opts.tickFormatter(v,axis)};else axis.tickFormatter=formatter}function setTicks(axis){var oticks=axis.options.ticks,ticks=[];if(oticks==null||typeof oticks=="number"&&oticks>0)ticks=axis.tickGenerator(axis);else if(oticks){if($.isFunction(oticks))ticks=oticks({min:axis.min,max:axis.max});else ticks=oticks}var i,v;axis.ticks=[];for(i=0;i<ticks.length;++i){var label=null;var t=ticks[i];if(typeof t=="object"){v=+t[0];if(t.length>1)label=t[1]}else v=+t;if(label==null)label=axis.tickFormatter(v,axis);if(!isNaN(v))axis.ticks.push({v:v,label:label})}}function snapRangeToTicks(axis,ticks){if(axis.options.autoscaleMargin&&ticks.length>0){if(axis.options.min==null)axis.min=Math.min(axis.min,ticks[0].v);if(axis.options.max==null&&ticks.length>1)axis.max=Math.max(axis.max,ticks[ticks.length-1].v)}}function draw(){ctx.clearRect(0,0,canvasWidth,canvasHeight);var grid=options.grid;if(grid.show&&grid.backgroundColor)drawBackground();if(grid.show&&!grid.aboveData)drawGrid();for(var i=0;i<series.length;++i){executeHooks(hooks.drawSeries,[ctx,series[i]]);drawSeries(series[i])}executeHooks(hooks.draw,[ctx]);if(grid.show&&grid.aboveData)drawGrid()}function extractRange(ranges,coord){var axis,from,to,key,axes=allAxes();for(i=0;i<axes.length;++i){axis=axes[i];if(axis.direction==coord){key=coord+axis.n+"axis";if(!ranges[key]&&axis.n==1)key=coord+"axis";if(ranges[key]){from=ranges[key].from;to=ranges[key].to;break}}}if(!ranges[key]){axis=coord=="x"?xaxes[0]:yaxes[0];from=ranges[coord+"1"];to=ranges[coord+"2"]}if(from!=null&&to!=null&&from>to){var tmp=from;from=to;to=tmp}return{from:from,to:to,axis:axis}}function drawBackground(){ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.fillStyle=getColorOrGradient(options.grid.backgroundColor,plotHeight,0,"rgba(255, 255, 255, 0)");ctx.fillRect(0,0,plotWidth,plotHeight);ctx.restore()}function drawGrid(){var i;ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var markings=options.grid.markings;if(markings){if($.isFunction(markings)){var axes=plot.getAxes();axes.xmin=axes.xaxis.min;axes.xmax=axes.xaxis.max;axes.ymin=axes.yaxis.min;axes.ymax=axes.yaxis.max;markings=markings(axes)}for(i=0;i<markings.length;++i){var m=markings[i],xrange=extractRange(m,"x"),yrange=extractRange(m,"y");if(xrange.from==null)xrange.from=xrange.axis.min;if(xrange.to==null)xrange.to=xrange.axis.max;if(yrange.from==null)yrange.from=yrange.axis.min;if(yrange.to==null)yrange.to=yrange.axis.max;if(xrange.to<xrange.axis.min||xrange.from>xrange.axis.max||yrange.to<yrange.axis.min||yrange.from>yrange.axis.max)continue;xrange.from=Math.max(xrange.from,xrange.axis.min);xrange.to=Math.min(xrange.to,xrange.axis.max);yrange.from=Math.max(yrange.from,yrange.axis.min);yrange.to=Math.min(yrange.to,yrange.axis.max);if(xrange.from==xrange.to&&yrange.from==yrange.to)continue;xrange.from=xrange.axis.p2c(xrange.from);xrange.to=xrange.axis.p2c(xrange.to);yrange.from=yrange.axis.p2c(yrange.from);yrange.to=yrange.axis.p2c(yrange.to);if(xrange.from==xrange.to||yrange.from==yrange.to){ctx.beginPath();ctx.strokeStyle=m.color||options.grid.markingsColor;ctx.lineWidth=m.lineWidth||options.grid.markingsLineWidth;ctx.moveTo(xrange.from,yrange.from);ctx.lineTo(xrange.to,yrange.to);ctx.stroke()}else{ctx.fillStyle=m.color||options.grid.markingsColor;ctx.fillRect(xrange.from,yrange.to,xrange.to-xrange.from,yrange.from-yrange.to)}}}var axes=allAxes(),bw=options.grid.borderWidth;for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box,t=axis.tickLength,x,y,xoff,yoff;if(!axis.show||axis.ticks.length==0)continue;ctx.strokeStyle=axis.options.tickColor||$.color.parse(axis.options.color).scale("a",.22).toString();ctx.lineWidth=1;if(axis.direction=="x"){x=0;if(t=="full")y=axis.position=="top"?0:plotHeight;else y=box.top-plotOffset.top+(axis.position=="top"?box.height:0)}else{y=0;if(t=="full")x=axis.position=="left"?0:plotWidth;else x=box.left-plotOffset.left+(axis.position=="left"?box.width:0)}if(!axis.innermost){ctx.beginPath();xoff=yoff=0;if(axis.direction=="x")xoff=plotWidth;else yoff=plotHeight;if(ctx.lineWidth==1){x=Math.floor(x)+.5;y=Math.floor(y)+.5}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff);ctx.stroke()}ctx.beginPath();for(i=0;i<axis.ticks.length;++i){var v=axis.ticks[i].v;xoff=yoff=0;if(v<axis.min||v>axis.max||t=="full"&&bw>0&&(v==axis.min||v==axis.max))continue;if(axis.direction=="x"){x=axis.p2c(v);yoff=t=="full"?-plotHeight:t;if(axis.position=="top")yoff=-yoff}else{y=axis.p2c(v);xoff=t=="full"?-plotWidth:t;if(axis.position=="left")xoff=-xoff}if(ctx.lineWidth==1){if(axis.direction=="x")x=Math.floor(x)+.5;else y=Math.floor(y)+.5}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff)}ctx.stroke()}if(bw){ctx.lineWidth=bw;ctx.strokeStyle=options.grid.borderColor;ctx.strokeRect(-bw/2,-bw/2,plotWidth+bw,plotHeight+bw)}ctx.restore()}function insertAxisLabels(){placeholder.find(".tickLabels").remove();var html=['<div class="tickLabels" style="font-size:smaller">'];var axes=allAxes();for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box;if(!axis.show)continue;html.push('<div class="'+axis.direction+"Axis "+axis.direction+axis.n+'Axis" style="color:'+axis.options.color+'">');for(var i=0;i<axis.ticks.length;++i){var tick=axis.ticks[i];if(!tick.label||tick.v<axis.min||tick.v>axis.max)continue;var pos={},align;if(axis.direction=="x"){align="center";pos.left=Math.round(plotOffset.left+axis.p2c(tick.v)-axis.labelWidth/2);if(axis.position=="bottom")pos.top=box.top+box.padding;else pos.bottom=canvasHeight-(box.top+box.height-box.padding)}else{pos.top=Math.round(plotOffset.top+axis.p2c(tick.v)-axis.labelHeight/2);if(axis.position=="left"){pos.right=canvasWidth-(box.left+box.width-box.padding);align="right"}else{pos.left=box.left+box.padding;align="left"}}pos.width=axis.labelWidth;var style=["position:absolute","text-align:"+align];for(var a in pos)style.push(a+":"+pos[a]+"px");html.push('<div class="tickLabel" style="'+style.join(";")+'">'+tick.label+"</div>")}html.push("</div>")}html.push("</div>");placeholder.append(html.join(""))}function drawSeries(series){if(series.lines.show)drawSeriesLines(series);if(series.bars.show)drawSeriesBars(series);if(series.points.show)drawSeriesPoints(series)}function drawSeriesLines(series){function plotLine(datapoints,xoffset,yoffset,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,prevx=null,prevy=null;ctx.beginPath();for(var i=ps;i<points.length;i+=ps){var x1=points[i-ps],y1=points[i-ps+1],x2=points[i],y2=points[i+1];if(x1==null||x2==null)continue;if(y1<=y2&&y1<axisy.min){if(y2<axisy.min)continue;x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min){if(y1<axisy.min)continue;x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max){if(y2>axisy.max)continue;x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max){if(y1>axisy.max)continue;x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;
x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(x1!=prevx||y1!=prevy)ctx.moveTo(axisx.p2c(x1)+xoffset,axisy.p2c(y1)+yoffset);prevx=x2;prevy=y2;ctx.lineTo(axisx.p2c(x2)+xoffset,axisy.p2c(y2)+yoffset)}ctx.stroke()}function plotLineArea(datapoints,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,bottom=Math.min(Math.max(0,axisy.min),axisy.max),i=0,top,areaOpen=false,ypos=1,segmentStart=0,segmentEnd=0;while(true){if(ps>0&&i>points.length+ps)break;i+=ps;var x1=points[i-ps],y1=points[i-ps+ypos],x2=points[i],y2=points[i+ypos];if(areaOpen){if(ps>0&&x1!=null&&x2==null){segmentEnd=i;ps=-ps;ypos=2;continue}if(ps<0&&i==segmentStart+ps){ctx.fill();areaOpen=false;ps=-ps;ypos=1;i=segmentStart=segmentEnd+ps;continue}}if(x1==null||x2==null)continue;if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(!areaOpen){ctx.beginPath();ctx.moveTo(axisx.p2c(x1),axisy.p2c(bottom));areaOpen=true}if(y1>=axisy.max&&y2>=axisy.max){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.max));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.max));continue}else if(y1<=axisy.min&&y2<=axisy.min){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.min));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.min));continue}var x1old=x1,x2old=x2;if(y1<=y2&&y1<axisy.min&&y2>=axisy.min){x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min&&y1>=axisy.min){x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max&&y2<=axisy.max){x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max&&y1<=axisy.max){x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1!=x1old){ctx.lineTo(axisx.p2c(x1old),axisy.p2c(y1))}ctx.lineTo(axisx.p2c(x1),axisy.p2c(y1));ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));if(x2!=x2old){ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));ctx.lineTo(axisx.p2c(x2old),axisy.p2c(y2))}}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineJoin="round";var lw=series.lines.lineWidth,sw=series.shadowSize;if(lw>0&&sw>0){ctx.lineWidth=sw;ctx.strokeStyle="rgba(0,0,0,0.1)";var angle=Math.PI/18;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/2),Math.cos(angle)*(lw/2+sw/2),series.xaxis,series.yaxis);ctx.lineWidth=sw/2;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/4),Math.cos(angle)*(lw/2+sw/4),series.xaxis,series.yaxis)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;var fillStyle=getFillStyle(series.lines,series.color,0,plotHeight);if(fillStyle){ctx.fillStyle=fillStyle;plotLineArea(series.datapoints,series.xaxis,series.yaxis)}if(lw>0)plotLine(series.datapoints,0,0,series.xaxis,series.yaxis);ctx.restore()}function drawSeriesPoints(series){function plotPoints(datapoints,radius,fillStyle,offset,shadow,axisx,axisy,symbol){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){var x=points[i],y=points[i+1];if(x==null||x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)continue;ctx.beginPath();x=axisx.p2c(x);y=axisy.p2c(y)+offset;if(symbol=="circle")ctx.arc(x,y,radius,0,shadow?Math.PI:Math.PI*2,false);else symbol(ctx,x,y,radius,shadow);ctx.closePath();if(fillStyle){ctx.fillStyle=fillStyle;ctx.fill()}ctx.stroke()}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var lw=series.points.lineWidth,sw=series.shadowSize,radius=series.points.radius,symbol=series.points.symbol;if(lw>0&&sw>0){var w=sw/2;ctx.lineWidth=w;ctx.strokeStyle="rgba(0,0,0,0.1)";plotPoints(series.datapoints,radius,null,w+w/2,true,series.xaxis,series.yaxis,symbol);ctx.strokeStyle="rgba(0,0,0,0.2)";plotPoints(series.datapoints,radius,null,w/2,true,series.xaxis,series.yaxis,symbol)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;plotPoints(series.datapoints,radius,getFillStyle(series.points,series.color),0,false,series.xaxis,series.yaxis,symbol);ctx.restore()}function drawBar(x,y,b,barLeft,barRight,offset,fillStyleCallback,axisx,axisy,c,horizontal,lineWidth){var left,right,bottom,top,drawLeft,drawRight,drawTop,drawBottom,tmp;if(horizontal){drawBottom=drawRight=drawTop=true;drawLeft=false;left=b;right=x;top=y+barLeft;bottom=y+barRight;if(right<left){tmp=right;right=left;left=tmp;drawLeft=true;drawRight=false}}else{drawLeft=drawRight=drawTop=true;drawBottom=false;left=x+barLeft;right=x+barRight;bottom=b;top=y;if(top<bottom){tmp=top;top=bottom;bottom=tmp;drawBottom=true;drawTop=false}}if(right<axisx.min||left>axisx.max||top<axisy.min||bottom>axisy.max)return;if(left<axisx.min){left=axisx.min;drawLeft=false}if(right>axisx.max){right=axisx.max;drawRight=false}if(bottom<axisy.min){bottom=axisy.min;drawBottom=false}if(top>axisy.max){top=axisy.max;drawTop=false}left=axisx.p2c(left);bottom=axisy.p2c(bottom);right=axisx.p2c(right);top=axisy.p2c(top);if(fillStyleCallback){c.beginPath();c.moveTo(left,bottom);c.lineTo(left,top);c.lineTo(right,top);c.lineTo(right,bottom);c.fillStyle=fillStyleCallback(bottom,top);c.fill()}if(lineWidth>0&&(drawLeft||drawRight||drawTop||drawBottom)){c.beginPath();c.moveTo(left,bottom+offset);if(drawLeft)c.lineTo(left,top+offset);else c.moveTo(left,top+offset);if(drawTop)c.lineTo(right,top+offset);else c.moveTo(right,top+offset);if(drawRight)c.lineTo(right,bottom+offset);else c.moveTo(right,bottom+offset);if(drawBottom)c.lineTo(left,bottom+offset);else c.moveTo(left,bottom+offset);c.stroke()}}function drawSeriesBars(series){function plotBars(datapoints,barLeft,barRight,offset,fillStyleCallback,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){if(points[i]==null)continue;drawBar(points[i],points[i+1],points[i+2],barLeft,barRight,offset,fillStyleCallback,axisx,axisy,ctx,series.bars.horizontal,series.bars.lineWidth)}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineWidth=series.bars.lineWidth;ctx.strokeStyle=series.color;var barLeft=series.bars.align=="left"?0:-series.bars.barWidth/2;var fillStyleCallback=series.bars.fill?function(bottom,top){return getFillStyle(series.bars,series.color,bottom,top)}:null;plotBars(series.datapoints,barLeft,barLeft+series.bars.barWidth,0,fillStyleCallback,series.xaxis,series.yaxis);ctx.restore()}function getFillStyle(filloptions,seriesColor,bottom,top){var fill=filloptions.fill;if(!fill)return null;if(filloptions.fillColor)return getColorOrGradient(filloptions.fillColor,bottom,top,seriesColor);var c=$.color.parse(seriesColor);c.a=typeof fill=="number"?fill:.4;c.normalize();return c.toString()}function insertLegend(){placeholder.find(".legend").remove();if(!options.legend.show)return;var fragments=[],rowStarted=false,lf=options.legend.labelFormatter,s,label;for(var i=0;i<series.length;++i){s=series[i];label=s.label;if(!label)continue;if(i%options.legend.noColumns==0){if(rowStarted)fragments.push("</tr>");fragments.push("<tr>");rowStarted=true}if(lf)label=lf(label,s);fragments.push('<td class="legendColorBox"><div style="border:1px solid '+options.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+s.color+';overflow:hidden"></div></div></td>'+'<td class="legendLabel">'+label+"</td>")}if(rowStarted)fragments.push("</tr>");if(fragments.length==0)return;var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";if(options.legend.container!=null)$(options.legend.container).html(table);else{var pos="",p=options.legend.position,m=options.legend.margin;if(m[0]==null)m=[m,m];if(p.charAt(0)=="n")pos+="top:"+(m[1]+plotOffset.top)+"px;";else if(p.charAt(0)=="s")pos+="bottom:"+(m[1]+plotOffset.bottom)+"px;";if(p.charAt(1)=="e")pos+="right:"+(m[0]+plotOffset.right)+"px;";else if(p.charAt(1)=="w")pos+="left:"+(m[0]+plotOffset.left)+"px;";var legend=$('<div class="legend">'+table.replace('style="','style="position:absolute;'+pos+";")+"</div>").appendTo(placeholder);if(options.legend.backgroundOpacity!=0){var c=options.legend.backgroundColor;if(c==null){c=options.grid.backgroundColor;if(c&&typeof c=="string")c=$.color.parse(c);else c=$.color.extract(legend,"background-color");c.a=1;c=c.toString()}var div=legend.children();$('<div style="position:absolute;width:'+div.width()+"px;height:"+div.height()+"px;"+pos+"background-color:"+c+';"> </div>').prependTo(legend).css("opacity",options.legend.backgroundOpacity)}}}var highlights=[],redrawTimeout=null;function findNearbyItem(mouseX,mouseY,seriesFilter){var maxDistance=options.grid.mouseActiveRadius,smallestDistance=maxDistance*maxDistance+1,item=null,foundPoint=false,i,j;for(i=series.length-1;i>=0;--i){if(!seriesFilter(series[i]))continue;var s=series[i],axisx=s.xaxis,axisy=s.yaxis,points=s.datapoints.points,ps=s.datapoints.pointsize,mx=axisx.c2p(mouseX),my=axisy.c2p(mouseY),maxx=maxDistance/axisx.scale,maxy=maxDistance/axisy.scale;if(axisx.options.inverseTransform)maxx=Number.MAX_VALUE;if(axisy.options.inverseTransform)maxy=Number.MAX_VALUE;if(s.lines.show||s.points.show){for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1];if(x==null)continue;if(x-mx>maxx||x-mx<-maxx||y-my>maxy||y-my<-maxy)continue;var dx=Math.abs(axisx.p2c(x)-mouseX),dy=Math.abs(axisy.p2c(y)-mouseY),dist=dx*dx+dy*dy;if(dist<smallestDistance){smallestDistance=dist;item=[i,j/ps]}}}if(s.bars.show&&!item){var barLeft=s.bars.align=="left"?0:-s.bars.barWidth/2,barRight=barLeft+s.bars.barWidth;for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1],b=points[j+2];if(x==null)continue;if(series[i].bars.horizontal?mx<=Math.max(b,x)&&mx>=Math.min(b,x)&&my>=y+barLeft&&my<=y+barRight:mx>=x+barLeft&&mx<=x+barRight&&my>=Math.min(b,y)&&my<=Math.max(b,y))item=[i,j/ps]}}}if(item){i=item[0];j=item[1];ps=series[i].datapoints.pointsize;return{datapoint:series[i].datapoints.points.slice(j*ps,(j+1)*ps),dataIndex:j,series:series[i],seriesIndex:i}}return null}function onMouseMove(e){if(options.grid.hoverable)triggerClickHoverEvent("plothover",e,function(s){return s["hoverable"]!=false})}function onMouseLeave(e){if(options.grid.hoverable)triggerClickHoverEvent("plothover",e,function(s){return false})}function onClick(e){triggerClickHoverEvent("plotclick",e,function(s){return s["clickable"]!=false})}function triggerClickHoverEvent(eventname,event,seriesFilter){var offset=eventHolder.offset(),canvasX=event.pageX-offset.left-plotOffset.left,canvasY=event.pageY-offset.top-plotOffset.top,pos=canvasToAxisCoords({left:canvasX,top:canvasY});pos.pageX=event.pageX;pos.pageY=event.pageY;var item=findNearbyItem(canvasX,canvasY,seriesFilter);if(item){item.pageX=parseInt(item.series.xaxis.p2c(item.datapoint[0])+offset.left+plotOffset.left);item.pageY=parseInt(item.series.yaxis.p2c(item.datapoint[1])+offset.top+plotOffset.top)}if(options.grid.autoHighlight){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.auto==eventname&&!(item&&h.series==item.series&&h.point[0]==item.datapoint[0]&&h.point[1]==item.datapoint[1]))unhighlight(h.series,h.point)}if(item)highlight(item.series,item.datapoint,eventname)}placeholder.trigger(eventname,[pos,item])}function triggerRedrawOverlay(){if(!redrawTimeout)redrawTimeout=setTimeout(drawOverlay,30)}function drawOverlay(){redrawTimeout=null;octx.save();octx.clearRect(0,0,canvasWidth,canvasHeight);octx.translate(plotOffset.left,plotOffset.top);var i,hi;for(i=0;i<highlights.length;++i){hi=highlights[i];if(hi.series.bars.show)drawBarHighlight(hi.series,hi.point);else drawPointHighlight(hi.series,hi.point)}octx.restore();executeHooks(hooks.drawOverlay,[octx])}function highlight(s,point,auto){if(typeof s=="number")s=series[s];if(typeof point=="number"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i==-1){highlights.push({series:s,point:point,auto:auto});triggerRedrawOverlay()}else if(!auto)highlights[i].auto=false}function unhighlight(s,point){if(s==null&&point==null){highlights=[];triggerRedrawOverlay()}if(typeof s=="number")s=series[s];if(typeof point=="number")point=s.data[point];var i=indexOfHighlight(s,point);if(i!=-1){highlights.splice(i,1);triggerRedrawOverlay()}}function indexOfHighlight(s,p){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s&&h.point[0]==p[0]&&h.point[1]==p[1])return i}return-1}function drawPointHighlight(series,point){var x=point[0],y=point[1],axisx=series.xaxis,axisy=series.yaxis;if(x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)return;var pointRadius=series.points.radius+series.points.lineWidth/2;octx.lineWidth=pointRadius;octx.strokeStyle=$.color.parse(series.color).scale("a",.5).toString();var radius=1.5*pointRadius,x=axisx.p2c(x),y=axisy.p2c(y);octx.beginPath();if(series.points.symbol=="circle")octx.arc(x,y,radius,0,2*Math.PI,false);else series.points.symbol(octx,x,y,radius,false);octx.closePath();octx.stroke()}function drawBarHighlight(series,point){octx.lineWidth=series.bars.lineWidth;octx.strokeStyle=$.color.parse(series.color).scale("a",.5).toString();var fillStyle=$.color.parse(series.color).scale("a",.5).toString();var barLeft=series.bars.align=="left"?0:-series.bars.barWidth/2;drawBar(point[0],point[1],point[2]||0,barLeft,barLeft+series.bars.barWidth,0,function(){return fillStyle},series.xaxis,series.yaxis,octx,series.bars.horizontal,series.bars.lineWidth)}function getColorOrGradient(spec,bottom,top,defaultColor){if(typeof spec=="string")return spec;else{var gradient=ctx.createLinearGradient(0,top,0,bottom);for(var i=0,l=spec.colors.length;i<l;++i){var c=spec.colors[i];if(typeof c!="string"){var co=$.color.parse(defaultColor);if(c.brightness!=null)co=co.scale("rgb",c.brightness);if(c.opacity!=null)co.a*=c.opacity;c=co.toString()}gradient.addColorStop(i/(l-1),c)}return gradient}}}$.plot=function(placeholder,data,options){var plot=new Plot($(placeholder),data,options,$.plot.plugins);return plot};$.plot.version="0.7";$.plot.plugins=[];$.plot.formatDate=function(d,fmt,monthNames){var leftPad=function(n){n=""+n;return n.length==1?"0"+n:n};var r=[];var escape=false,padNext=false;var hours=d.getUTCHours();var isAM=hours<12;if(monthNames==null)monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(fmt.search(/%p|%P/)!=-1){if(hours>12){hours=hours-12}else if(hours==0){hours=12}}for(var i=0;i<fmt.length;++i){var c=fmt.charAt(i);if(escape){switch(c){case"h":c=""+hours;break;case"H":c=leftPad(hours);break;case"M":c=leftPad(d.getUTCMinutes());break;case"S":c=leftPad(d.getUTCSeconds());break;case"d":c=""+d.getUTCDate();break;case"m":c=""+(d.getUTCMonth()+1);break;case"y":c=""+d.getUTCFullYear();break;case"b":c=""+monthNames[d.getUTCMonth()];break;case"p":c=isAM?""+"am":""+"pm";break;case"P":c=isAM?""+"AM":""+"PM";break;case"0":c="";padNext=true;break}if(c&&padNext){c=leftPad(c);padNext=false}r.push(c);if(!padNext)escape=false}else{if(c=="%")escape=true;else r.push(c)}}return r.join("")};function floorInBase(n,base){return base*Math.floor(n/base)}})(jQuery);
(function($){$.fn.editable=function(target,options){if('disable'==target){$(this).data('disabled.editable',true);return;}
if('enable'==target){$(this).data('disabled.editable',false);return;}
if('destroy'==target){$(this).unbind($(this).data('event.editable')).removeData('disabled.editable').removeData('event.editable');return;}
var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types['defaults'].buttons;var content=$.editable.types[settings.type].content||$.editable.types['defaults'].content;var element=$.editable.types[settings.type].element||$.editable.types['defaults'].element;var reset=$.editable.types[settings.type].reset||$.editable.types['defaults'].reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr('title',settings.tooltip);}
settings.autowidth='auto'==settings.width;settings.autoheight='auto'==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data('event.editable',settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder);}
$(this).bind(settings.event,function(e){if(true===$(this).data('disabled.editable')){return;}
if(self.editing){return;}
if(false===onedit.apply(this,[settings,self])){return;}
e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr('title');}
if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight;}else{if(settings.width!='none'){settings.width=settings.autowidth?$(self).width():settings.width;}
if(settings.height!='none'){settings.height=settings.autoheight?$(self).height():settings.height;}}
if($(this).html().toLowerCase().replace(/(;|")/g,'')==settings.placeholder.toLowerCase().replace(/(;|")/g,'')){$(this).html('');}
self.editing=true;self.revert=$(self).html();$(self).html('');var form=$('<form />');if(settings.cssclass){if('inherit'==settings.cssclass){form.attr('class',$(self).attr('class'));}else{form.attr('class',settings.cssclass);}}
if(settings.style){if('inherit'==settings.style){form.attr('style',$(self).attr('style'));form.css('display',$(self).css('display'));}else{form.attr('style',settings.style);}}
var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self]);},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]));}else{$.extend(loaddata,settings.loaddata);}
$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false;}});}else if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings]);}}else{input_content=self.revert;}
content.apply(form,[input_content,settings,self]);input.attr('name',settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(':input:visible:enabled:first',form).focus();if(settings.select){input.select();}
input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self]);}});var t;if('cancel'==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self]);},500);});}else if('submit'==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit();},200);});}else if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings]);});}else{input.blur(function(e){});}
form.submit(function(e){if(t){clearTimeout(t);}
e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]));}else{$.extend(submitdata,settings.submitdata);}
if('PUT'==settings.method){submitdata['_method']='put';}
$(self).html(settings.indicator);var ajaxoptions={type:'POST',data:submitdata,dataType:'html',url:settings.target,success:function(result,status){if(ajaxoptions.dataType=='html'){$(self).html(result);}
self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr]);}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions);}}}
$(self).attr('title',settings.tooltip);return false;});});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder);}
if(settings.tooltip){$(self).attr('title',settings.tooltip);}}}};});};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input);},content:function(string,settings,original){$(':input:first',this).val(string);},reset:function(settings,original){original.reset(this);},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit();}});}else{var submit=$('<button type="submit" />');submit.html(settings.submit);}
$(this).append(submit);}
if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel);}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel);}
$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset;}else{var reset=$.editable.types['defaults'].reset;}
reset.apply(form,[settings,original]);return false;});}}},text:{element:function(settings,original){var input=$('<input />');if(settings.width!='none'){input.width(settings.width);}
if(settings.height!='none'){input.height(settings.height);}
input.attr('autocomplete','off');$(this).append(input);return(input);}},textarea:{element:function(settings,original){var textarea=$('<textarea />');if(settings.rows){textarea.attr('rows',settings.rows);}else if(settings.height!="none"){textarea.height(settings.height);}
if(settings.cols){textarea.attr('cols',settings.cols);}else if(settings.width!="none"){textarea.width(settings.width);}
$(this).append(textarea);return(textarea);}},select:{element:function(settings,original){var select=$('<select />');$(this).append(select);return(select);},content:function(data,settings,original){if(String==data.constructor){eval('var json = '+data);}else{var json=data;}
for(var key in json){if(!json.hasOwnProperty(key)){continue;}
if('selected'==key){continue;}
var option=$('<option />').val(key).append(json[key]);$('select',this).append(option);}
$('select',this).children().each(function(){if($(this).val()==json['selected']||$(this).text()==$.trim(original.revert)){$(this).attr('selected','selected');}});}}},addInputType:function(name,input){$.editable.types[name]=input;}};$.fn.editable.defaults={name:'value',id:'id',type:'text',width:'auto',height:'auto',event:'click.editable',onblur:'cancel',loadtype:'GET',loadtext:'Loading...',placeholder:'Click to edit',loaddata:{},submitdata:{},ajaxoptions:{}};})(jQuery);(function(e){var o="left",n="right",d="up",v="down",c="in",w="out",l="none",r="auto",k="swipe",s="pinch",x="tap",i="doubletap",b="longtap",A="horizontal",t="vertical",h="all",q=10,f="start",j="move",g="end",p="cancel",a="ontouchstart"in window,y="TouchSwipe";var m={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:true,triggerOnTouchLeave:false,allowPageScroll:"auto",fallbackToMouseEvents:true,excludedElements:"button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(D){var C=e(this),B=C.data(y);if(B&&typeof D==="string"){if(B[D]){return B[D].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+D+" does not exist on jQuery.swipe")}}else{if(!B&&(typeof D==="object"||!D)){return u.apply(this,arguments)}}return C};e.fn.swipe.defaults=m;e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:j,PHASE_END:g,PHASE_CANCEL:p};e.fn.swipe.directions={LEFT:o,RIGHT:n,UP:d,DOWN:v,IN:c,OUT:w};e.fn.swipe.pageScroll={NONE:l,HORIZONTAL:A,VERTICAL:t,AUTO:r};e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:h};function u(B){if(B&&(B.allowPageScroll===undefined&&(B.swipe!==undefined||B.swipeStatus!==undefined))){B.allowPageScroll=l}if(B.click!==undefined&&B.tap===undefined){B.tap=B.click}if(!B){B={}}B=e.extend({},e.fn.swipe.defaults,B);return this.each(function(){var D=e(this);var C=D.data(y);if(!C){C=new z(this,B);D.data(y,C)}})}function z(a0,aq){var av=(a||!aq.fallbackToMouseEvents),G=av?"touchstart":"mousedown",au=av?"touchmove":"mousemove",R=av?"touchend":"mouseup",P=av?null:"mouseleave",az="touchcancel";var ac=0,aL=null,Y=0,aX=0,aV=0,D=1,am=0,aF=0,J=null;var aN=e(a0);var W="start";var T=0;var aM=null;var Q=0,aY=0,a1=0,aa=0,K=0;var aS=null;try{aN.bind(G,aJ);aN.bind(az,a5)}catch(ag){e.error("events not supported "+G+","+az+" on jQuery.swipe")}this.enable=function(){aN.bind(G,aJ);aN.bind(az,a5);return aN};this.disable=function(){aG();return aN};this.destroy=function(){aG();aN.data(y,null);return aN};this.option=function(a8,a7){if(aq[a8]!==undefined){if(a7===undefined){return aq[a8]}else{aq[a8]=a7}}else{e.error("Option "+a8+" does not exist on jQuery.swipe.options")}};function aJ(a9){if(ax()){return}if(e(a9.target).closest(aq.excludedElements,aN).length>0){return}var ba=a9.originalEvent?a9.originalEvent:a9;var a8,a7=a?ba.touches[0]:ba;W=f;if(a){T=ba.touches.length}else{a9.preventDefault()}ac=0;aL=null;aF=null;Y=0;aX=0;aV=0;D=1;am=0;aM=af();J=X();O();if(!a||(T===aq.fingers||aq.fingers===h)||aT()){ae(0,a7);Q=ao();if(T==2){ae(1,ba.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}if(aq.swipeStatus||aq.pinchStatus){a8=L(ba,W)}}else{a8=false}if(a8===false){W=p;L(ba,W);return a8}else{ak(true)}}function aZ(ba){var bd=ba.originalEvent?ba.originalEvent:ba;if(W===g||W===p||ai()){return}var a9,a8=a?bd.touches[0]:bd;var bb=aD(a8);aY=ao();if(a){T=bd.touches.length}W=j;if(T==2){if(aX==0){ae(1,bd.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}else{aD(bd.touches[1]);aV=ap(aM[0].end,aM[1].end);aF=an(aM[0].end,aM[1].end)}D=a3(aX,aV);am=Math.abs(aX-aV)}if((T===aq.fingers||aq.fingers===h)||!a||aT()){aL=aH(bb.start,bb.end);ah(ba,aL);ac=aO(bb.start,bb.end);Y=aI();aE(aL,ac);if(aq.swipeStatus||aq.pinchStatus){a9=L(bd,W)}if(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave){var a7=true;if(aq.triggerOnTouchLeave){var bc=aU(this);a7=B(bb.end,bc)}if(!aq.triggerOnTouchEnd&&a7){W=ay(j)}else{if(aq.triggerOnTouchLeave&&!a7){W=ay(g)}}if(W==p||W==g){L(bd,W)}}}else{W=p;L(bd,W)}if(a9===false){W=p;L(bd,W)}}function I(a7){var a8=a7.originalEvent;if(a){if(a8.touches.length>0){C();return true}}if(ai()){T=aa}a7.preventDefault();aY=ao();Y=aI();if(a6()){W=p;L(a8,W)}else{if(aq.triggerOnTouchEnd||(aq.triggerOnTouchEnd==false&&W===j)){W=g;L(a8,W)}else{if(!aq.triggerOnTouchEnd&&a2()){W=g;aB(a8,W,x)}else{if(W===j){W=p;L(a8,W)}}}}ak(false)}function a5(){T=0;aY=0;Q=0;aX=0;aV=0;D=1;O();ak(false)}function H(a7){var a8=a7.originalEvent;if(aq.triggerOnTouchLeave){W=ay(g);L(a8,W)}}function aG(){aN.unbind(G,aJ);aN.unbind(az,a5);aN.unbind(au,aZ);aN.unbind(R,I);if(P){aN.unbind(P,H)}ak(false)}function ay(bb){var ba=bb;var a9=aw();var a8=aj();var a7=a6();if(!a9||a7){ba=p}else{if(a8&&bb==j&&(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave)){ba=g}else{if(!a8&&bb==g&&aq.triggerOnTouchLeave){ba=p}}}return ba}function L(a9,a7){var a8=undefined;if(F()||S()){a8=aB(a9,a7,k)}else{if((M()||aT())&&a8!==false){a8=aB(a9,a7,s)}}if(aC()&&a8!==false){a8=aB(a9,a7,i)}else{if(al()&&a8!==false){a8=aB(a9,a7,b)}else{if(ad()&&a8!==false){a8=aB(a9,a7,x)}}}if(a7===p){a5(a9)}if(a7===g){if(a){if(a9.touches.length==0){a5(a9)}}else{a5(a9)}}return a8}function aB(ba,a7,a9){var a8=undefined;if(a9==k){aN.trigger("swipeStatus",[a7,aL||null,ac||0,Y||0,T]);if(aq.swipeStatus){a8=aq.swipeStatus.call(aN,ba,a7,aL||null,ac||0,Y||0,T);if(a8===false){return false}}if(a7==g&&aR()){aN.trigger("swipe",[aL,ac,Y,T]);if(aq.swipe){a8=aq.swipe.call(aN,ba,aL,ac,Y,T);if(a8===false){return false}}switch(aL){case o:aN.trigger("swipeLeft",[aL,ac,Y,T]);if(aq.swipeLeft){a8=aq.swipeLeft.call(aN,ba,aL,ac,Y,T)}break;case n:aN.trigger("swipeRight",[aL,ac,Y,T]);if(aq.swipeRight){a8=aq.swipeRight.call(aN,ba,aL,ac,Y,T)}break;case d:aN.trigger("swipeUp",[aL,ac,Y,T]);if(aq.swipeUp){a8=aq.swipeUp.call(aN,ba,aL,ac,Y,T)}break;case v:aN.trigger("swipeDown",[aL,ac,Y,T]);if(aq.swipeDown){a8=aq.swipeDown.call(aN,ba,aL,ac,Y,T)}break}}}if(a9==s){aN.trigger("pinchStatus",[a7,aF||null,am||0,Y||0,T,D]);if(aq.pinchStatus){a8=aq.pinchStatus.call(aN,ba,a7,aF||null,am||0,Y||0,T,D);if(a8===false){return false}}if(a7==g&&a4()){switch(aF){case c:aN.trigger("pinchIn",[aF||null,am||0,Y||0,T,D]);if(aq.pinchIn){a8=aq.pinchIn.call(aN,ba,aF||null,am||0,Y||0,T,D)}break;case w:aN.trigger("pinchOut",[aF||null,am||0,Y||0,T,D]);if(aq.pinchOut){a8=aq.pinchOut.call(aN,ba,aF||null,am||0,Y||0,T,D)}break}}}if(a9==x){if(a7===p||a7===g){clearTimeout(aS);if(V()&&!E()){K=ao();aS=setTimeout(e.proxy(function(){K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}},this),aq.doubleTapThreshold)}else{K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}}}}else{if(a9==i){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("doubletap",[ba.target]);if(aq.doubleTap){a8=aq.doubleTap.call(aN,ba,ba.target)}}}else{if(a9==b){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("longtap",[ba.target]);if(aq.longTap){a8=aq.longTap.call(aN,ba,ba.target)}}}}}return a8}function aj(){var a7=true;if(aq.threshold!==null){a7=ac>=aq.threshold}return a7}function a6(){var a7=false;if(aq.cancelThreshold!==null&&aL!==null){a7=(aP(aL)-ac)>=aq.cancelThreshold}return a7}function ab(){if(aq.pinchThreshold!==null){return am>=aq.pinchThreshold}return true}function aw(){var a7;if(aq.maxTimeThreshold){if(Y>=aq.maxTimeThreshold){a7=false}else{a7=true}}else{a7=true}return a7}function ah(a7,a8){if(aq.allowPageScroll===l||aT()){a7.preventDefault()}else{var a9=aq.allowPageScroll===r;switch(a8){case o:if((aq.swipeLeft&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case n:if((aq.swipeRight&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case d:if((aq.swipeUp&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break;case v:if((aq.swipeDown&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break}}}function a4(){var a8=aK();var a7=U();var a9=ab();return a8&&a7&&a9}function aT(){return!!(aq.pinchStatus||aq.pinchIn||aq.pinchOut)}function M(){return!!(a4()&&aT())}function aR(){var ba=aw();var bc=aj();var a9=aK();var a7=U();var a8=a6();var bb=!a8&&a7&&a9&&bc&&ba;return bb}function S(){return!!(aq.swipe||aq.swipeStatus||aq.swipeLeft||aq.swipeRight||aq.swipeUp||aq.swipeDown)}function F(){return!!(aR()&&S())}function aK(){return((T===aq.fingers||aq.fingers===h)||!a)}function U(){return aM[0].end.x!==0}function a2(){return!!(aq.tap)}function V(){return!!(aq.doubleTap)}function aQ(){return!!(aq.longTap)}function N(){if(K==null){return false}var a7=ao();return(V()&&((a7-K)<=aq.doubleTapThreshold))}function E(){return N()}function at(){return((T===1||!a)&&(isNaN(ac)||ac===0))}function aW(){return((Y>aq.longTapThreshold)&&(ac<q))}function ad(){return!!(at()&&a2())}function aC(){return!!(N()&&V())}function al(){return!!(aW()&&aQ())}function C(){a1=ao();aa=event.touches.length+1}function O(){a1=0;aa=0}function ai(){var a7=false;if(a1){var a8=ao()-a1;if(a8<=aq.fingerReleaseThreshold){a7=true}}return a7}function ax(){return!!(aN.data(y+"_intouch")===true)}function ak(a7){if(a7===true){aN.bind(au,aZ);aN.bind(R,I);if(P){aN.bind(P,H)}}else{aN.unbind(au,aZ,false);aN.unbind(R,I,false);if(P){aN.unbind(P,H,false)}}aN.data(y+"_intouch",a7===true)}function ae(a8,a7){var a9=a7.identifier!==undefined?a7.identifier:0;aM[a8].identifier=a9;aM[a8].start.x=aM[a8].end.x=a7.pageX||a7.clientX;aM[a8].start.y=aM[a8].end.y=a7.pageY||a7.clientY;return aM[a8]}function aD(a7){var a9=a7.identifier!==undefined?a7.identifier:0;var a8=Z(a9);a8.end.x=a7.pageX||a7.clientX;a8.end.y=a7.pageY||a7.clientY;return a8}function Z(a8){for(var a7=0;a7<aM.length;a7++){if(aM[a7].identifier==a8){return aM[a7]}}}function af(){var a7=[];for(var a8=0;a8<=5;a8++){a7.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0})}return a7}function aE(a7,a8){a8=Math.max(a8,aP(a7));J[a7].distance=a8}function aP(a7){return J[a7].distance}function X(){var a7={};a7[o]=ar(o);a7[n]=ar(n);a7[d]=ar(d);a7[v]=ar(v);return a7}function ar(a7){return{direction:a7,distance:0}}function aI(){return aY-Q}function ap(ba,a9){var a8=Math.abs(ba.x-a9.x);var a7=Math.abs(ba.y-a9.y);return Math.round(Math.sqrt(a8*a8+a7*a7))}function a3(a7,a8){var a9=(a8/a7)*1;return a9.toFixed(2)}function an(){if(D<1){return w}else{return c}}function aO(a8,a7){return Math.round(Math.sqrt(Math.pow(a7.x-a8.x,2)+Math.pow(a7.y-a8.y,2)))}function aA(ba,a8){var a7=ba.x-a8.x;var bc=a8.y-ba.y;var a9=Math.atan2(bc,a7);var bb=Math.round(a9*180/Math.PI);if(bb<0){bb=360-Math.abs(bb)}return bb}function aH(a8,a7){var a9=aA(a8,a7);if((a9<=45)&&(a9>=0)){return o}else{if((a9<=360)&&(a9>=315)){return o}else{if((a9>=135)&&(a9<=225)){return n}else{if((a9>45)&&(a9<135)){return v}else{return d}}}}}function ao(){var a7=new Date();return a7.getTime()}function aU(a7){a7=e(a7);var a9=a7.offset();var a8={left:a9.left,right:a9.left+a7.outerWidth(),top:a9.top,bottom:a9.top+a7.outerHeight()};return a8}function B(a7,a8){return(a7.x>a8.left&&a7.x<a8.right&&a7.y>a8.top&&a7.y<a8.bottom)}}})(jQuery);(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.17"}});var PROP_NAME="datepicker";var dpuuid=(new Date).getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug)console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=nodeName=="div"||nodeName=="span";if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else if(inline){this._inlineDatepicker(target,inst)}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName))return;this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append)inst.append.remove();if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger)inst.trigger.remove();var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both")input.focus(this._showDatepicker);if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0])$.datepicker._hideDatepicker();else $.datepicker._showDatepicker(input[0]);return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort")));date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName))return;divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=date&&date.constructor==Date?this._formatDate(inst,date):date;this._dialogInput.val(date);this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null;if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI)$.blockUI(this.dpDiv);$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if(nodeName=="div"||nodeName=="span")$target.removeClass(this.markerClassName).empty()},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(value){return value==target?null:value})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(value){return value==target?null:value});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target)return true}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return name=="defaults"?$.extend({},$.datepicker._defaults):inst?name=="all"?$.extend({},inst.settings):this._get(inst,name):null}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings["dateFormat"]!==undefined&&settings["minDate"]===undefined)inst.settings.minDate=this._formatDate(inst,minDate);if(maxDate!==null&&settings["dateFormat"]!==undefined&&settings["maxDate"]===undefined)inst.settings.maxDate=this._formatDate(inst,maxDate);this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline)this._setDateFromField(inst,noDefault);return inst?this._getDate(inst):null},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0])$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]);var onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){var dateStr=$.datepicker._formatDate(inst);onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])}else $.datepicker._hideDatepicker();return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:if(event.ctrlKey||event.metaKey)$.datepicker._clearDate(event.target);handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey)$.datepicker._gotoToday(event.target);handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey)$.datepicker._adjustDate(event.target,isRTL?+1:-1,"D");handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey)$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:if(event.ctrlKey||event.metaKey)$.datepicker._adjustDate(event.target,-7,"D");handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey)$.datepicker._adjustDate(event.target,isRTL?-1:+1,"D");handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey)$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:if(event.ctrlKey||event.metaKey)$.datepicker._adjustDate(event.target,+7,"D");handled=event.ctrlKey||event.metaKey;break;default:handled=false}else if(event.keyCode==36&&event.ctrlKey)$.datepicker._showDatepicker(this);else{handled=false}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(event){$.datepicker.log(event)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input")input=$("input",input.parentNode)[0];if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input)return;var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}var beforeShow=$.datepicker._get(inst,"beforeShow");var beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return}extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog)input.value="";if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return!isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[showAnim])inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);else inst.dpDiv[showAnim||"show"](showAnim?duration:null,postProcess);if(!showAnim||!duration)postProcess();if(inst.input.is(":visible")&&!inst.input.is(":disabled"))inst.input.focus();$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1)inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",width*cols+"em");inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement)inst.input.focus();if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+$(document).scrollLeft();var viewHeight=document.documentElement.clientHeight+$(document).scrollTop();offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0;offset.left-=isFixed&&offset.left==inst.input.offset().left?$(document).scrollLeft():0;offset.top-=isFixed&&offset.top==inst.input.offset().top+inputHeight?$(document).scrollTop():0;offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||input&&inst!=$.data(input,PROP_NAME))return;if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var self=this;var postProcess=function(){$.datepicker._tidyDialog(inst);self._curInst=null};if($.effects&&$.effects[showAnim])inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);else inst.dpDiv[showAnim=="slideDown"?"slideUp":showAnim=="fadeIn"?"fadeOut":"hide"](showAnim?duration:null,postProcess);if(!showAnim)postProcess();this._datepickerShowing=false;var onClose=this._get(inst,"onClose");if(onClose)onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]);this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst)return;var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)||$target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=inst)$.datepicker._hideDatepicker()},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date;inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=dateStr!=null?dateStr:this._formatDate(inst);if(inst.input)inst.input.val(dateStr);this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect)onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]);else if(inst.input)inst.input.trigger("change");if(inst.inline)this._updateDatepicker(inst);else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof inst.input[0]!="object")inst.input.focus();this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null)throw"Invalid arguments";value=typeof value=="object"?value.toString():value+"";if(value=="")return null;var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=typeof shortYearCutoff!="string"?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10);var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)==match;if(matches)iFormat++;return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=match=="@"?14:match=="!"?20:match=="y"&&isDoubled?4:match=="o"?3:2;var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1)return index+1;else throw"Unknown name at position "+iValue};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal)if(format.charAt(iFormat)=="'"&&!lookAhead("'"))literal=false;else checkLiteral();else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/1e4);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'"))checkLiteral();else literal=true;break;default:checkLiteral()}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1)year=(new Date).getFullYear();else if(year<100)year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100);if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim)break;month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)==match;if(matches)iFormat++;return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))while(num.length<len)num="0"+num;return num};var formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]};var output="";var literal=false;if(date)for(var iFormat=0;iFormat<format.length;iFormat++){if(literal)if(format.charAt(iFormat)=="'"&&!lookAhead("'"))literal=false;else output+=format.charAt(iFormat);else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*1e4+this._ticksTo1970;break;case"'":if(lookAhead("'"))output+="'";else literal=true;break;default:output+=format.charAt(iFormat)}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)==match;if(matches)iFormat++;return matches};for(var iFormat=0;iFormat<format.length;iFormat++)if(literal)if(format.charAt(iFormat)=="'"&&!lookAhead("'"))literal=false;else chars+=format.charAt(iFormat);else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'"))chars+="'";else literal=true;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=noDefault?"":dates}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=dates?date.getDate():0;inst.currentMonth=dates?date.getMonth():0;inst.currentYear=dates?date.getFullYear():0;this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date;date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date;var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=date==null||date===""?defaultDate:typeof date=="string"?offsetString(date):typeof date=="number"?isNaN(date)?defaultDate:offsetNumeric(date):new Date(date.getTime());newDate=newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate;if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date)return null;date.setHours(date.getHours()>12?date.getHours()+2:0);return date;
},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange)this._notifyChange(inst);this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=!inst.currentYear||inst.input&&inst.input.val()==""?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return startDate},_generateHTML:function(inst){var today=new Date;today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=numMonths[0]!=1||numMonths[1]!=1;var currentDate=this._daylightSavingAdjust(!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate()));maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst));var prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', -"+stepMonths+", 'M');\""+' title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>";var nextText=this._get(inst,"nextText");nextText=!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst));var next=this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', +"+stepMonths+", 'M');\""+' title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>";var currentText=this._get(inst,"currentText");var gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today;currentText=!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst));var controls=!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(inst,"closeText")+"</button>":"";var buttonPanel=showButtonPanel?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+inst.id+"');\""+">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=isNaN(firstDay)?0:firstDay;var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&row==0?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var thead=showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"";for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth)inst.selectedDay=Math.min(inst.selectedDay,daysInMonth);var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows;this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>";for(var dow=0;dow<7;dow++){var daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[true,""];var otherMonth=printDate.getMonth()!=drawMonth;var unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate;tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+inst.id+"',"+printDate.getMonth()+","+printDate.getFullYear()+', this);return false;"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>")+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col==numMonths[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth)monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>";else{var inMinYear=minDate&&minDate.getFullYear()==drawYear;var inMaxYear=maxDate&&maxDate.getFullYear()==drawYear;monthHtml+='<select class="ui-datepicker-month" '+'onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'M');\" "+">";for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth()))monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}monthHtml+="</select>"}if(!showMonthAfterYear)html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"");if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear)html+='<span class="ui-datepicker-year">'+drawYear+"</span>";else{var years=this._get(inst,"yearRange").split(":");var thisYear=(new Date).getFullYear();var determineYear=function(value){var year=value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=minDate?Math.max(year,minDate.getFullYear()):year;endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear;inst.yearshtml+='<select class="ui-datepicker-year" '+'onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'Y');\" "+">";for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear)html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml;html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y")this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=minDate&&date<minDate?minDate:date;newDate=maxDate&&newDate>maxDate?maxDate:newDate;return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange)onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return numMonths==null?[1,1]:typeof numMonths=="number"?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0)date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=typeof shortYearCutoff!="string"?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10);return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=day?typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.bind("mouseout",function(event){var elem=$(event.target).closest(selector);if(!elem.length){return}elem.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(event){var elem=$(event.target).closest(selector);if($.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||!elem.length){return}elem.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");elem.addClass("ui-state-hover");if(elem.hasClass("ui-datepicker-prev"))elem.addClass("ui-datepicker-prev-hover");if(elem.hasClass("ui-datepicker-next"))elem.addClass("ui-datepicker-next-hover")})}function extendRemove(target,props){$.extend(target,props);for(var name in props)if(props[name]==null||props[name]==undefined)target[name]=props[name];return target}function isArray(a){return a&&($.browser.safari&&typeof a=="object"&&a.length||a.constructor&&a.constructor.toString().match(/\Array\(\)/))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget"))return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string")return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker;$.datepicker.initialized=false;$.datepicker.uuid=(new Date).getTime();$.datepicker.version="1.8.17";window["DP_jQuery_"+dpuuid]=$})(jQuery);
(function(){var p=this,C=p._,m={},i=Array.prototype,n=Object.prototype,f=i.slice,D=i.unshift,E=n.toString,l=n.hasOwnProperty,s=i.forEach,t=i.map,u=i.reduce,v=i.reduceRight,w=i.filter,x=i.every,y=i.some,o=i.indexOf,z=i.lastIndexOf;n=Array.isArray;var F=Object.keys,q=Function.prototype.bind,b=function(a){return new j(a)};typeof module!=="undefined"&&module.exports?(module.exports=b,b._=b):p._=b;b.VERSION="1.1.7";var h=b.each=b.forEach=function(a,c,b){if(a!=null)if(s&&a.forEach===s)a.forEach(c,b);else if(a.length===+a.length)for(var e=0,k=a.length;e<k;e++){if(e in a&&c.call(b,a[e],e,a)===m)break}else for(e in a)if(l.call(a,e)&&c.call(b,a[e],e,a)===m)break};b.map=function(a,c,b){var e=[];if(a==null)return e;if(t&&a.map===t)return a.map(c,b);h(a,function(a,g,G){e[e.length]=c.call(b,a,g,G)});return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var k=d!==void 0;a==null&&(a=[]);if(u&&a.reduce===u)return e&&(c=b.bind(c,e)),k?a.reduce(c,d):a.reduce(c);h(a,function(a,b,f){k?d=c.call(e,d,a,b,f):(d=a,k=!0)});if(!k)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,c,d,e){a==null&&(a=[]);if(v&&a.reduceRight===v)return e&&(c=b.bind(c,e)),d!==void 0?a.reduceRight(c,d):a.reduceRight(c);a=(b.isArray(a)?a.slice():b.toArray(a)).reverse();return b.reduce(a,c,d,e)};b.find=b.detect=function(a,c,b){var e;A(a,function(a,g,f){if(c.call(b,a,g,f))return e=a,!0});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(w&&a.filter===w)return a.filter(c,b);h(a,function(a,g,f){c.call(b,a,g,f)&&(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;h(a,function(a,g,f){c.call(b,a,g,f)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=!0;if(a==null)return e;if(x&&a.every===x)return a.every(c,b);h(a,function(a,g,f){if(!(e=e&&c.call(b,a,g,f)))return m});return e};var A=b.some=b.any=function(a,c,d){c=c||b.identity;var e=!1;if(a==null)return e;if(y&&a.some===y)return a.some(c,d);h(a,function(a,b,f){if(e|=c.call(d,a,b,f))return m});return!!e};b.include=b.contains=function(a,c){var b=!1;if(a==null)return b;if(o&&a.indexOf===o)return a.indexOf(c)!=-1;A(a,function(a){if(b=a===c)return!0});return b};b.invoke=function(a,c){var d=f.call(arguments,2);return b.map(a,function(a){return(c.call?c||a:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);var e={computed:-Infinity};h(a,function(a,b,f){b=c?c.call(d,a,b,f):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);var e={computed:Infinity};h(a,function(a,b,f){b=c?c.call(d,a,b,f):a;b<e.computed&&(e={value:a,computed:b})});return e.value};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,f){return{value:a,criteria:c.call(d,a,b,f)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,b){var d={};h(a,function(a,f){var g=b(a,f);(d[g]||(d[g]=[])).push(a)});return d};b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=function(a){if(!a)return[];if(a.toArray)return a.toArray();if(b.isArray(a))return f.call(a);if(b.isArguments(a))return f.call(a);return b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?f.call(a,0,b):a[0]};b.rest=b.tail=function(a,b,d){return f.call(a,b==null||d?1:b)};b.last=function(a){return a[a.length-1]};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a){return b.reduce(a,function(a,d){if(b.isArray(d))return a.concat(b.flatten(d));a[a.length]=d;return a},[])};b.without=function(a){return b.difference(a,f.call(arguments,1))};b.uniq=b.unique=function(a,c){return b.reduce(a,function(a,e,f){if(0==f||(c===!0?b.last(a)!=e:!b.include(a,e)))a[a.length]=e;return a},[])};b.union=function(){return b.uniq(b.flatten(arguments))};b.intersection=b.intersect=function(a){var c=f.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a,c){return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=f.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(o&&a.indexOf===o)return a.indexOf(c);d=0;for(e=a.length;d<e;d++)if(a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(z&&a.lastIndexOf===z)return a.lastIndexOf(b);for(var d=a.length;d--;)if(a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);d=arguments[2]||1;for(var e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};b.bind=function(a,b){if(a.bind===q&&q)return q.apply(a,f.call(arguments,1));var d=f.call(arguments,2);return function(){return a.apply(b,d.concat(f.call(arguments)))}};b.bindAll=function(a){var c=f.call(arguments,1);
c.length==0&&(c=b.functions(a));h(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var b=c.apply(this,arguments);return l.call(d,b)?d[b]:d[b]=a.apply(this,arguments)}};b.delay=function(a,b){var d=f.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(f.call(arguments,1)))};var B=function(a,b,d){var e;return function(){var f=this,g=arguments,h=function(){e=null;a.apply(f,g)};d&&clearTimeout(e);if(d||!e)e=setTimeout(h,b)}};b.throttle=function(a,b){return B(a,b,!1)};b.debounce=function(a,b){return B(a,b,!0)};b.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(f.call(arguments));return b.apply(this,d)}};b.compose=function(){var a=f.call(arguments);return function(){for(var b=f.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}};b.keys=F||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)l.call(a,d)&&(b[b.length]=d);return b};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){h(f.call(arguments,1),function(b){for(var d in b)b[d]!==void 0&&(a[d]=b[d])});return a};b.defaults=function(a){h(f.call(arguments,1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,c){if(a===c)return!0;var d=typeof a;if(d!=typeof c)return!1;if(a==c)return!0;if(!a&&c||a&&!c)return!1;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual)return a.isEqual(c);if(c.isEqual)return c.isEqual(a);if(b.isDate(a)&&b.isDate(c))return a.getTime()===c.getTime();if(b.isNaN(a)&&b.isNaN(c))return!1;if(b.isRegExp(a)&&b.isRegExp(c))return a.source===c.source&&a.global===c.global&&a.ignoreCase===c.ignoreCase&&a.multiline===c.multiline;if(d!=="object")return!1;if(a.length&&a.length!==c.length)return!1;d=b.keys(a);var e=b.keys(c);if(d.length!=e.length)return!1;for(var f in a)if(!(f in c)||!b.isEqual(a[f],c[f]))return!1;return!0};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(l.call(a,c))return!1;return!0};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=n||function(a){return E.call(a)==="[object Array]"};b.isObject=function(a){return a===Object(a)};b.isArguments=function(a){return!(!a||!l.call(a,"callee"))};b.isFunction=function(a){return!(!a||!a.constructor||!a.call||!a.apply)};b.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)};b.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===!0||a===!1};b.isDate=function(a){return!(!a||!a.getTimezoneOffset||!a.setUTCFullYear)};b.isRegExp=function(a){return!(!a||!a.test||!a.exec||!(a.ignoreCase||a.ignoreCase===!1))};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.noConflict=function(){p._=C;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};b.mixin=function(a){h(b.functions(a),function(c){H(c,b[c]=a[c])})};var I=0;b.uniqueId=function(a){var b=I++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};b.template=function(a,c){var d=b.templateSettings;d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";d=new Function("obj",d);return c?d(c):d};var j=function(a){this._wrapped=a};b.prototype=j.prototype;var r=function(a,c){return c?b(a).chain():a},H=function(a,c){j.prototype[a]=function(){var a=f.call(arguments);D.call(a,this._wrapped);return r(c.apply(b,a),this._chain)}};b.mixin(b);h(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=i[a];j.prototype[a]=function(){b.apply(this._wrapped,arguments);return r(this._wrapped,this._chain)}});h(["concat","join","slice"],function(a){var b=i[a];j.prototype[a]=function(){return r(b.apply(this._wrapped,arguments),this._chain)}});j.prototype.chain=function(){this._chain=!0;return this};j.prototype.value=function(){return this._wrapped}})();var AddressForm=function(t,e,s,a){"use strict";var n=jQuery;(void 0===a||null===a||""===a||"boolean"!=typeof a)&&(a=!1);var i=function(e,s){var n,i=this,o=0;this.country_sel=document.getElementById(e),this.state_sel=document.getElementById(s);var l=this.country_sel.getAttribute("data-selected");for(n in t)t.hasOwnProperty(n)&&(this.country_sel.options[o]=a||2==l.length?new Option(n,t[n].value):new Option(n,n),a||2==l.length?t[n].value==l&&(this.country_sel.options[o].selected=!0):n==l&&(this.country_sel.options[o].selected=!0),o++);this.country_sel.addEventListener("change",function(t){i.updateStates(this.options[this.selectedIndex].value)})};i.prototype.updateStates=function(e){for(var i,o,l,r=0,d=this.state_sel.getAttribute("data-selected");this.state_sel.options.length>0;)this.state_sel.remove(0);if(a)for(i in t)t[i].value==e&&(l=t[i].regions);else if(e.length>2)l=t[e].regions;else for(i in t)t[i].value==e&&(l=t[i].regions);var c;if(!l)return c=n("#state").attr("data-selected"),n("#state").after('<input type="text" id="state" name="'+s+'" maxlength="57" data-selected="'+c+'" />'),void n("#state").remove();c=n("#state").attr("data-selected"),n("#state").after('<select type="text" id="state" name="'+s+'" data-selected="'+c+'"></selected>'),n("#state").remove(),this.state_sel=n("#state")[0],o=[];for(var h in l)l.hasOwnProperty(h)&&o.push(l[h]);for(o.sort(),r=0;r<o.length;r++)this.state_sel.options[r]=new Option(o[r],o[r]),o[r]==d&&(this.state_sel.options[r].selected=!0)},e=e||"00Nj0000005FAeV",s=s||"00Nj0000005FAiE",n("select[name='"+e+"']").each(function(t){var e=new i(this.id,n(this).closest("form").find("select[name='"+s+"']").attr("id")),a=n(this);a.val(a.data("selected")?a.data("selected"):"United States"),e.updateStates(a.data("selected"))})};Thingiverse.Admin=function(){},Thingiverse.Admin.View=function(){$("#user_features_grid .toggle-features").on("click",function(){var e=$(this),i="on"===e.data("set")?!0:!1,t=$('input[name^="user_features"][name$="['+e.data("mask")+']"]');t.prop("checked",i)}),$("#user_features_grid").on("click",".toggle-features-user",function(){var e=$(this),i="on"===e.data("set")?!0:!1,t=$('input[name^="user_features['+e.data("user")+']"]');t.prop("checked",i)}),$("#add_user").on("click",function(){var e=$("#features_add_user").get(0),i=e.value,t=Thingiverse.View.render_js_template("features_new_user_row",{username:i});$("#user_features_grid tbody").append(t),e.value=""}),Thingiverse.Search.initUserAutocomplete($("#features_add_user"))},Thingiverse.Admin.Customizer=function(){},Thingiverse.Admin.Customizer.View=function(e){var i=this;$(".collection > fieldset:first-child input").on("blur",function(){i.previewCollection($(this).closest(".collection"))}),$(".collection .show-preview").on("click",function(e){return e.preventDefault(),i.previewCollection($(this).closest(".collection")),!1}),$(".show-preview.featured").on("click",function(e){e.preventDefault();var t=$('input[name="featured[make_ids][]"]').serializeArray();return i.previewFeatured($(".customizer-featured"),{thing_id:$('input[name="featured[thing_id]"]').val(),image_url:$('input[name="featured[image_url]"]').val(),make_ids:[t[0].value,t[1].value],content:$('textarea[name="featured[content]"]').val()}),!1})},Thingiverse.Admin.Customizer.previewCollection=function(e){$.ajax({url:"/ajax/thingcollection/thingcollection",data:{id:e.find("fieldset:first-child input").val()},type:"post"}).done(function(i){e.find(".preview").html(i)})},Thingiverse.Admin.Customizer.previewFeatured=function(e,i){return i.thing_id?i.image_url?void $.ajax({url:"/ajax/customizer/featured",data:i,type:"post"}).done(function(i){e.html(i)}):void alert("Please enter an Image URL"):void alert("Please enter a Thing ID")},Thingiverse.Admin.Users=function(){},Thingiverse.Admin.Users.View=function(){$(".sortable-users").sortable({forcePlaceholderSize:!0}),Thingiverse.Search.initUserAutocomplete($('input[name="username_or_id"]')[0]),$(".unfeature").click(function(e){e.preventDefault();var i=$(this);$.post("/ajax/admin/unfeature_user?user_id="+i.siblings("input").val()).done(function(){i.parent().remove()})}),$("#featured-user-admin").submit(function(){0!==$(".ui-autocomplete-input").val().length&&$.post("/ajax/admin/feature_user?username="+$(".ui-autocomplete-input").val())})};Thingiverse.Analytics=function(){},Thingiverse.Analytics.View=function(e){function a(e){var a=$("#thing-stat-sort-order").val();if($("#thing-stat-sort-field").val()==e){$("#thing-stat-sort-order").val("asc"==a?"desc":"asc");var s=$("#header-"+e);"asc"==a?(s.removeClass("asc"),s.addClass("desc")):(s.removeClass("desc"),s.addClass("asc"))}else{var i=$("#header-"+$("#thing-stat-sort-field").val());i.removeClass("asc"),i.removeClass("desc"),i.addClass("inactive");var r=$("#header-"+e);r.removeClass("inactive"),r.addClass("desc"),$("#thing-stat-sort-field").val(e),$("#thing-stat-sort-order").val("desc")}Thingiverse.View.track_event(["analytics","newSortOrder","sortOrder",e+"-"+a]),t()}function t(){if(!i){i=!0;var a=$("#start-date").val(),t=$("#end-date").val();$("#thing-stats").html("");var s="/user:"+e.user_id+"/stats/"+a+"/"+t+"/",r=$("#thing-stat-sort-field").val(),n=e.username+"/analytics/";Thingiverse.scroll.reinitialize({page:0,base_url:n,extra_path:"?sort="+r,source_data:{user_id:e.user_id,start_date:a,end_date:t,sort:r,order:$("#thing-stat-sort-order").val(),base_url:n,extra_path:"?sort="+r}}),$.ajax({url:s}).done(function(e){for(var a=0,t=0,s=[],r=[],n=[],o=[],d=[],l=0;l<e.length;l++){var c=parseInt(e[l].likes),h=parseInt(e[l].makes),u=parseInt(e[l].downloads),v=parseInt(e[l].views),p=parseInt(e[l].watches);isNaN(c)&&(c=0),isNaN(h)&&(h=0),isNaN(u)&&(u=0),isNaN(v)&&(v=0),isNaN(p)&&(p=0),t=Math.max(c,h,u,v,p),t>a&&(a=t),s.push([new Date(e[l].day).getTime(),c]),r.push([new Date(e[l].day).getTime(),h]),n.push([new Date(e[l].day).getTime(),u]),o.push([new Date(e[l].day).getTime(),v]),d.push([new Date(e[l].day).getTime(),p])}$.plot($("#placeholder"),[{data:n,label:"Downloads"},{data:o,label:"Views"}],{series:{lines:{show:!0},points:{show:!0,radius:1}},grid:{hoverable:!0,autoHighlight:!0},yaxis:{autoscaleMargin:.005},xaxis:{mode:"time",timezone:"browser",timeformat:"%y-%m-%d"}});i=!1})}}function s(e,a,t){$('<div id="tooltip">'+t+"</div>").css({position:"absolute",display:"none",color:"#666",top:a-45,left:e+10,"border-radius":4,border:"1px solid #999","box-shadow":"0px 0px 4px rgba(85,85,85,0.5)",padding:"10px","background-color":"#fafafa",opacity:1}).appendTo("body").fadeIn(300)}var i=!1,r=null,n=$("#start-date").val(),o=$("#end-date").val(),d=("/user:"+e.user_id+"/stats/"+n+"/"+o+"/",$("#thing-stat-sort-field").val()),l=e.username+"/analytics/";Thingiverse.scroll.init({container:$("#thing-stats"),source:"/ajax/dashboard/dateRangeThingTotals",page:0,base_url:l,extra_path:"?sort="+d,source_data:{user_id:e.user_id,start_date:n,end_date:o,sort:d,order:$("#thing-stat-sort-order").val(),base_url:l,extra_path:"?sort="+d}}),$("#placeholder").bind("plothover",function(e,a,t){if($("#x").text(a.x.toFixed(2)),$("#y").text(a.y.toFixed(2)),t){if(r!=t.dataIndex){r=t.dataIndex,$("#tooltip").remove();var i=t.datapoint[0].toFixed(2),n=t.datapoint[1].toFixed(2),o=new Date(parseInt(i));o.setDate(o.getDate()+1),s(t.pageX,t.pageY,parseInt(n)+" "+t.series.label+" on "+o.toLocaleDateString())}}else $("#tooltip").remove(),r=null}),$("#start-date").change(function(){t()}),$("#end-date").change(function(){t()}),$("#header-views").click(function(){a("views")}),$("#header-downloads").click(function(){a("downloads")}),$("#header-likes").click(function(){a("likes")}),$("#header-collects").click(function(){a("collects")}),$("#header-watches").click(function(){a("watches")}),$("#header-comments").click(function(){a("comments")}),$("#header-makes").click(function(){a("makes")}),$("#header-derivatives").click(function(){a("derivatives")}),$("#start-date").datepicker({dateFormat:"yy-mm-dd",defaultDate:e.month_ago,changeMonth:!1,numberOfMonths:1,minDate:"2012-09-10",maxDate:0,onClose:function(e){$("#end-date").datepicker("option","minDate",e),Thingiverse.View.track_event(["analytics","newStartDate","date",e]),t()}}),$("#end-date").datepicker({dateFormat:"yy-mm-dd",defaultDate:e.today,changeMonth:!1,numberOfMonths:1,minDate:"2012-09-10",maxDate:0,onClose:function(e){$("#start-date").datepicker("option","maxDate",e),Thingiverse.View.track_event(["analytics","newEndDate","date",e]),t()}}),t()};Thingiverse.Apps=function(){},Thingiverse.Apps.View=function(i){var a=$("#app-edit-form"),e=a.find('[name="avatar_upload"]');e.on("change",function(n){e.prop("disabled",!0);new Thingiverse.FileUpload({file:this.files[0],url:window.location.href+"/upload?id="+i.id,$progressContainer:$(".app-avatar"),$form:a,isIframe:!0,finalizeUrl:window.location.href+"/finalize?id="+i.id,renderPreview:function(i){$(".avatar.img-preview").css("background-image","url("+i+")").addClass("active")},uploadComplete:function(){e.prop("disabled",!1)},onCancel:function(){e.prop("disabled",!1)}})}),a.find(".app-avatar-wrapper").on("click",function(){e.trigger("click")})};function feature_collection(e){$("#feature-btn").load("/ajax/thingcollection/feature",{id:e})}function unfeature_collection(e){$("#feature-btn").load("/ajax/thingcollection/unfeature",{id:e})}function create_new_collection(e){var i=$.ajax({url:"/ajax/thingcollection/new_collection",data:e});return i}function save_to_collection(e){var i=$.ajax({url:"/ajax/thingcollection/collect_thing",data:e});return i}function submit_collection_form(e){var i=$(e),n=i.find("select"),t=i.find('select[name="collection"]').val(),o=i.find('input[name="new-collection-name"]').val(),a=i.find('input[name="thing_id"]').val(),l=i.find('input[name="thingcollection_link_id"]').val()?i.find('input[name="thingcollection_link_id"]').val():!1,c=i.find("select").val();return!o.length&&0>=t?void alert("Please enter a collection name"):(i.find(":input").attr("disabled",!0),$.when(getCollection(o,c)).done(function(e){if(saveToCollection(a,e.id,l).done(function(){n.val(e.id),i.removeClass("active"),update_thing_collect(i.closest("div.thing-interaction-parent").find(".thing-collect"))}).fail(function(e){e&&alert(e)}).always(function(){i.find(":input").attr("disabled",!1)}),e.name){n.append('<option value="'+e.id+'">'+e.name+"</option>"),n.find('option[value="-1"]').appendTo(n),collectionOpts=n.html();{$("form.collect-form.active").not(i).find("select").html(collectionOpts)}i.find("div.new-collection-name").removeClass("active").find("input").val("")}}).fail(function(e){e&&alert(e),i.find(":input").attr("disabled",!1)}),!1)}function getCollection(e,i){var n=$.Deferred();if(e)create_new_collection({name:e}).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e.responseText)});else if(i){var t={id:i};n.resolve(t)}else n.reject("Invalid collection");return n.promise()}function saveToCollection(e,i,n){var t=$.Deferred();return n=n?n:"",save_to_collection({thing_id:e,thingcollection_link_id:n,collection_id:i}).done(function(e){t.resolve(e.id)}).fail(function(e){t.reject(e.responseText)}),t.promise()}Thingiverse.collections=function(){var e={};return e.showRemoveThingDialog=function(e){Thingiverse.dialog.create({message:'Are you sure you want to remove <a href="/thing:'+e.thing_id+'">'+$("<span>"+e.thing_name+"</span>").text()+"</a> from your collection?",action:"/ajax/thingcollection/remove_thing",data:{thingcollection_link_id:e.thingcollection_link_id},success:function(){Thingiverse.View.track_event(["collection","thing-remove"]),Thingiverse.Makerware.isMakerware&&Thingiverse.Makerware.mw.appAttributeExists("refreshLibraryTab")&&mwThingiverse.refreshLibraryTab(),$el=$("#thingcollection-link-"+e.thingcollection_link_id),$el.fadeOut(1e3,function(){$(this).remove()}),e.success&&e.success()}})},e.showDeleteCollectionDialog=function(e){Thingiverse.dialog.create({message:"Deleting a collection will permanently remove all <strong>updates and captions</strong> associated with it!<br/><br/>Remove "+e.collection_name+"?",action:"/ajax/thingcollection/delete",data:{collection_id:e.collection_id},success:function(){Thingiverse.View.track_event(["collection","delete"]),Thingiverse.Makerware.isMakerware&&Thingiverse.Makerware.mw.appAttributeExists("refreshLibraryTab")&&mwThingiverse.refreshLibraryTab(),window.location.reload()}})},e.featureThing=function(e,i){$jqXHR=$.post("/ajax/thingcollection/feature_thing",{id:e}),$jqXHR.success(function(e){$(".thing-collectioncover").removeClass("active"),$(i).addClass("active")})},e.enableEditMode=function(e){var i=$("#name").text();$("#thingcollection-page").addClass("edit"),$("#name").editable("enable"),$("#name").editable(function(n,t){var o=this;return $.ajax({type:"POST",url:"/ajax/thingcollection/edit",data:{id:e.collection_id,name:n},error:function(e,n,t){var a=$.parseJSON(e.responseText);a.slug&&alert(a.slug),$(o).text(i)}}),n},{cancel:"Cancel",submit:"Save"}),$("#description").editable("enable"),$("#description").editable(function(i,n){var t=this;return $.ajax({type:"POST",url:"/ajax/thingcollection/edit",data:{id:e.collection_id,description:i},success:function(e){$(t).html(e)}}),i?$(this).parent().removeClass("hidden"):$(this).parent().addClass("hidden"),i},{loadurl:"/ajax/thingcollection/markdown_description",loaddata:{thingcollection:e.collection_id},rows:6,type:"textarea",cancel:"Cancel",submit:"Save"})},e.disableEditMode=function(){$("#thingcollection-page").removeClass("edit"),$("#name").editable("disable"),$("#description").editable("disable")},e}();var collectionOpts=!1;Thingiverse.Comment=function(){},Thingiverse.Comment["delete"]=function(e,t){t.preventDefault(),confirm("Are you sure you want to delete this comment?")&&$.ajax({type:"POST",url:"/ajax/comments/delete",data:{comment_id:e},success:function(){$("#comment-"+e).show(),$("#comment-form-edit").remove(),$("#comment-"+e).html('<div class="comment-deleted">Comment has been deleted</div>')},error:function(){console.log("error!")}})},Thingiverse.Comment.create=function(e,t){return t.preventDefault(),$.ajax({type:"POST",url:"/ajax/comments/create",data:$(e).serializeObject(),success:function(t){$("#comments").prepend(t),e.reset()},error:function(e){console.log(e),alert("Error: "+e.responseText)}})},Thingiverse.Comment.reply=function(e,t){t.preventDefault(),form_data=$(e).serializeObject(),$.ajax({type:"POST",url:"/ajax/comments/create",data:form_data,success:function(e){$("#comment-"+form_data.parent_id+"-children").prepend(e),$("#comment-form-reply").remove()},error:function(e){console.log(e),alert("Error: "+e.responseText)}})},Thingiverse.Comment.edit=function(e,t){t.preventDefault(),form_data=$(e).serializeObject(),$.ajax({type:"POST",url:"/ajax/comments/edit",data:form_data,success:function(e){$("#comment-form-edit").remove(),$("#comment-"+form_data.comment_id+"-wrapper").html(e),$("#comment-"+form_data.comment_id+"-wrapper").show(),$.Topic("commentEdited"+form_data.comment_id).publish(form_data.comment_id)},error:function(e){console.log(e),alert("Error: "+e.responseText)}})},Thingiverse.Comment.edit_form=function(e,t){t.preventDefault(),$("#comment-form-edit").remove(),$.ajax({type:"GET",url:"/ajax/comments/_form",data:{form_type:"edit",comment_id:e},cache:!1,success:function(t){$("#comment-"+e+"-wrapper").hide(),$("#comment-"+e).before(t),$("#comment-form-edit textarea").focus(),$.Topic("commentEditFormLoaded"+e).publish(e)},error:function(e){console.log(e),alert("Error: "+e.responseText)}})},Thingiverse.Comment.flag_as_spam=function(e,t){return t.preventDefault(),confirm("Are you sure this is spam?")?void $.ajax({type:"GET",url:"/ajax/comments/flagSpam",data:{comment_id:e},success:function(e){$(t.target).closest(".comment-container").replaceWith(e)},error:function(e){console.log(e),alert("Error: "+e.responseText)}}):!1},Thingiverse.Comment.cancelEdit=function(e,t){$("#comment-"+e+"-wrapper").show(),$("#comment-form-"+t).remove(),$.Topic("commentEditFormCancelled"+e).publish(e)},Thingiverse.Comment.reply_form=function(e,t,o){t&&t.preventDefault(),void 0===o&&(o=!0),$("#comment-form-reply").remove(),$.ajax({type:"GET",url:"/ajax/comments/_form",data:{form_type:"reply",parent_id:e},success:function(t){$("#comment-"+e+"-children").prepend(t),o&&$("#comment-form-reply textarea").focus()},error:function(e){console.log(e),alert("Error: "+e.responseText)}})};Thingiverse.Customizer=function(){},Thingiverse.Customizer.View=function(){$(".header-right-side *").click(function(){$("html, body").animate({scrollTop:$(".customizer-contribute").offset().top},500)}),$(".info").click(function(){$("html, body").animate({scrollTop:$(".customizer-what-is").offset().top},500)}),$(".top").click(function(){$("html, body").animate({scrollTop:0},500)})};function getEvents(t,e){var a=t[0]?t[0]:"",i="/ajax/dashboard/list_events/",n=$.Deferred(),r={"all-activity":{},"my-activity":{},"friends-activity":{},watchlist:{}},s=r[t[0]]?r[t[0]]:r["all-activity"],o=s.url?s.url:i,c={type:s.type?s.type:a,per_page:e.per_page?e.per_page:"30",cat:t[1]?t[1]:"",subcat:t[2]?t[2]:"",base_url:e.base_url?e.base_url:""},g=e.start_page?e.start_page:1;return $.ajax({url:"/ajax/dashboard/list_events/",type:"POST",data:{type:c.type,cat:c.cat,subcat:c.subcat,per_page:c.per_page,page:g}}).done(function(t){n.resolve(t),Thingiverse.View.track_page(c.base_url+"page:"+g),Thingiverse.scroll.container&&Thingiverse.scroll.init({container:".things",source:o,source_data:c,page:g})}).fail(function(t){n.reject(t)}),n.promise()}function updateEventResults(t,e){var a=$("body");a.addClass("loading"),$.when(getEvents(t,e)).done(function(t){var e=$(t).find("div.things-page-content");e.length?$("div.things-page-content").replaceWith(e):$("div.things-page-content").html($('<div class="things notifications">').html(t))}).fail(function(t){}).always(function(t){setTimeout(function(){a.removeClass("loading")},250)})}Thingiverse.Dashboard=function(){},Thingiverse.Dashboard.View=function(t){function e(){var t=$(this),e=t.data("raw");t.html(a.makeHtml(e)).removeAttr("data-raw")}var a=new Markdown.getSanitizingConverter;Thingiverse.scroll.init(t.pagination_data),$(".thing_description[data-raw]").each(e),$(".things").on("makerbot.inserted",function(){$(".thing_description[data-raw]").each(e)})};Thingiverse.dialog=function(){var e={templates:{}};return e.create=function(t){var a=_.defaults(t,{button_text:"Yes, remove it.",button_class:"btn btn-danger",data:{},failure:function(e,t){alert(e.responseText)},"class":"confirm-dialog",message:"Are you sure you want to remove this item?",message_processing:"",message_success:"Removed!",template:"confirm-dialog",modal_id:"confirm-dialog"}),s=e.get_modal_elem(a.modal_id,a["class"]),n=function(t,a){t.find("button.dialog-submit").click(e.submitCallback(a,t)),"function"==typeof a.rendered&&a.rendered(t),t.modal()};if("string"==typeof a.template)e.render_template(s,a.template,a,function(){n(s,a)});else if("object"==typeof a.template){var i=$.get(a.template.action,a.template.data);i.success(function(e,t,i){s.html(e),n(s,a)}),i.error(function(e,t,a){var s=JSON.parse(e.responseText)||{};s.redirect&&(window.location=s.redirect)})}},e.submitCallback=function(e,t){return function(a){if(e.action){var s={};"object"==typeof e.data?s=e.data:"function"==typeof e.data&&(s=e.data(t)),t.find(".dialog-wait-message").html('<span class="text-info">'+e.message_processing+"</span>"),t.find(".dialog-wait").removeClass("hide"),$jqXHR=$.post(e.action,s),$jqXHR.error(function(a){e.failure(a),t.find(".dialog-wait").addClass("hide")}),$jqXHR.success(function(a){t.find(".dialog-wait-message").html('<span class="text-success">'+e.message_success+"</span>"),setTimeout(function(){t.modal("hide"),e.success&&e.success(a)},750)})}}},e.get_modal_elem=function(e,t){var a=$("#"+e);return 0===a.length&&$("<div/>",{id:e,"class":"modal hide fade "+t}).appendTo("body"),$("#"+e)},e.render_template=function(t,a,s,n){var i=function(e,t,a){e.html(t(a)),n()};if(e.templates[a])i(t,e.templates[a],s);else{var o=$("script#"+a);if(o.length>0)e.templates[a]=_.template(o.html());else{var l="/tmpl/"+a+".html",c=$.get(l);c.error(function(e){console.log("Failed to fetch template "+l)}),c.success(function(n){e.templates[a]=_.template(n),i(t,e.templates[a],s)})}}},e}();function render_image(e){Thingiverse.View.ajaxLoad(),"object"==typeof e&&(e=e.id);var i=$("#render_image_"+e);i.attr("disabled",!0),$.post("/ajax/render/resize_image",{id:e},function(){i.removeAttr("disabled"),Thingiverse.View.ajaxUnload()})}function reorder_thing_images(e,i){$.post("/ajax/things/orderimages",{thing_id:e,image_ids:i})}function delete_file(e){Thingiverse.View.ajaxLoad(),$("#delete_file_"+e).attr("disabled",!0),$("#managefiles").load("/ajax/things/deletefile",{file_id:e},Thingiverse.View.ajaxUnload)}function render_file(e){$.post("/ajax/things/renderfile",{file_id:e})}
Thingiverse.Event=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);if(this.constructMessage(),this.message){this.message=$("<span>").text(this.message).text();var s=this.message.substring(0,50);this.message.length>50&&(s+="..."),this.element=this.template({target_url:this.target.url,target_thumb:this.target.thumb,target_type:this.target.type.toLowerCase(),message:s})}},Thingiverse.Event.prototype.constructMessage=function(){this.template=_.template('<a href="<%= target_url %>" class="event"><img src="<%= target_thumb %>" class="<%= target_type %>-type"/><div class="message"><span><%= message %></span></div></a>');var e={download:"downloaded",comment:"commented on",publish:"published",make:"made a copy of",like:"liked",derive:"made a thing based on",collect:"collected",follow:"started following",update:"made an update to",feature:"featured",authorize:"started using",unauthorize:"stopped using"};if(!(this.user&&this.target&&this.user.name&&e[this.event_type]&&this.target.name))return void 0;var t=[];return t.push("feature"==this.event_type?"Thingiverse":this.user.name),t.push(e[this.event_type]),t.push(this.target.name),this.message=t.join(" "),this.message};Thingiverse.eventTopics={},jQuery.Topic=function(e){var i,r=e&&Thingiverse.eventTopics[e];return r||(i=jQuery.Callbacks(),r={publish:i.fire,subscribe:i.add,unsubscribe:i.remove},e&&(Thingiverse.eventTopics[e]=r)),r};var FormFileBttn=function(t){var e,n=function(t){e=jQuery,this.create(t),this.deconstruct()};return n.prototype={constructor:n,setTarget:function(t,n){if(void 0===t.external)return n(e(t.target));var r=e(t.external);r.load(function(){return n(r.contents().find(t.target))})},setNewElement:function(t,n,r){var i="__ffbttn_"+Math.floor(1e6*Math.random()+1),o="<"+t.type+' id="'+i+'" class="'+t.style+'"></'+t.type+">";return n.replaceWith(o),r(void 0!==t.external?e(t.external).contents().find("#"+i):e("#"+i))},create:function(t){var e=this;e.setTarget(t,function(n){n.css({visibility:"hidden",position:"absolute"}),e.setNewElement(t,n,function(e){e.html(n).append(t.html);var r=0;e.on("click",function(){var t=r+=1;1===t?n[0].click():r=0})})})},deconstruct:function(){}},n}();Thingiverse.FileDrop=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.settings.$progressContainer||(this.settings.$progressContainer=this.settings.$container),this.init(),this},Thingiverse.FileDrop.prototype.defaultSettings={$container:$(document)},Thingiverse.FileDrop.prototype.init=function(){var e=this;e.settings.$container.on("dragover",function(e){return e.preventDefault(),$(this).addClass("file-hover"),!1}).on("dragleave dragend",function(e){return e.preventDefault(),$(this).removeClass("file-hover"),!1}).on("drop",function(t){if(t.preventDefault(),$(this).removeClass("file-hover"),"function"==typeof e.settings.onDrop){var n,i=t.originalEvent.dataTransfer.files,r=i.length;for(n=0;r>n;n++)e.settings.onDrop(i[n])}return!1})};Thingiverse.FileUpload=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.init(),this},Thingiverse.FileUpload.prototype.defaultSettings={file:null,url:null,$progressContainer:null,finalizeUrl:null,$form:null,renderPreview:null,uploadComplete:null,onCancel:null,file_type:null},Thingiverse.FileUpload.prototype.init=function(){var e=this,n=e.settings.file,t=(0===n.type.indexOf("image/"),n.name),i=t.substr(t.lastIndexOf(".")+1),r={file:n,ext:i};e.uploading=!0,e.updateProgress(0),$.when(e.getUploadData(n)).done(function(n){if(e.uploading=!1,r.pendingUpload=n,e.settings.finalizeUrl||"function"!=typeof e.settings.uploadComplete||e.settings.uploadComplete(r),"function"==typeof e.settings.renderPreview&&n.is_image_file&&e.renderPreview(r),e.settings.finalizeUrl)$.when(e.notifyFinalizeEndpoint(n)).done(function(n){"function"==typeof e.settings.uploadComplete&&(r.finalizeData=n,e.settings.uploadComplete(r))}).fail(function(n){alert("There was a problem finalizing the file upload "+t),e.updateProgress(100)});else if(e.settings.$form){var i=$('<input type="hidden" name="pending_ids['+n.pending_upload_id+']" value="'+n.pending_upload_id+'">');e.settings.$form.append(i)}}).fail(function(n){alert("There was a problem uploading your file "+t),e.updateProgress(100)})},Thingiverse.FileUpload.prototype.renderPreview=function(e){var n=this,t=new FileReader;t.onloadend=function(){n.settings.renderPreview(t.result,e)},t.readAsDataURL(n.settings.file)},Thingiverse.FileUpload.prototype.updateProgress=function(e){var n=this,t=n.settings.$progressContainer.find(".progress-wrapper").length;n.settings.$progressContainer&&(n.$progress||(n.$progress=$('<span class="progress-wrapper" data-name="'+n.settings.file.name+'"><progress max="100" value="0" class="avatar-progress" data-name="'+n.settings.file.name+'"></progress> <span class="remove-item"></span></span>').appendTo(n.settings.$progressContainer),n.settings.$progressContainer.attr("data-count",t+1),n.$progress.find(".remove-item").on("click",function(){n.xhr.abort()})),n.$progress.find("progress").val(e),100===e&&(n.$progress.remove(),n.$progress=null,t=Math.max(t-1,0)),n.settings.$progressContainer.attr("data-count",t))},Thingiverse.FileUpload.prototype.getUploadData=function(e){var n=this,t=new $.Deferred;return $.ajax({url:n.settings.url,type:"POST",data:{name:e.name,size:e.size,type:e.type,file_type:n.settings.file_type}}).done(function(i){$.when(n.uploadFile(i,e)).done(function(e){e&&t.resolve(e)}).fail(function(e){t.reject(e)})}).fail(function(e){t.reject(e)}),t.promise()},Thingiverse.FileUpload.prototype.uploadFile=function(e,n){var t=this,i=new FormData,r=new $.Deferred,s=e.fields,a=e.pending_upload_id;for(var o in s)i.append(o,s[o]);if(i.append("file",n),a){var l=function(){r.resolve(e)},p=new XMLHttpRequest;t.xhr=p,p.upload.addEventListener("progress",function(e){var n=-1;e.lengthComputable&&(n=Math.round(100*e.loaded/e.total)),t.updateProgress(n)},!1),p.addEventListener("load",function(){l()},!1),p.addEventListener("error",function(){4===p.readyState&&0===p.status?l():r.reject()},!1),p.addEventListener("abort",function(){t.updateProgress(100),t.settings.onCancel&&t.settings.onCancel()},!1),p.open("POST","https://"+s.bucket+".s3.amazonaws.com/",!0),p.send(i)}else r.reject();return r.promise()},Thingiverse.FileUpload.prototype.notifyFinalizeEndpoint=function(e){var n=this,t=new $.Deferred,i=$.extend({},e.fields);i.pending_upload_id=e.pending_upload_id;var r=n.settings.isIframe?"html":"json";return $.ajax({url:n.settings.finalizeUrl,type:"POST",data:i,dataType:r}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()};Thingiverse.FixedPosition=function(t){return t&&"object"==typeof t||(t={}),this.settings=$.extend(!0,{},this.defaultSettings,t),this.init(),this},Thingiverse.FixedPosition.prototype.defaultSettings={$element:null,stopPosition:null,on:null},Thingiverse.FixedPosition.prototype.init=function(){var t=this;if(t.settings.$element){var i=t.settings.$element.offset().top,n=function(){var n=$(window).scrollTop(),e=null,o=null,l=typeof t.settings.stopPosition;t.settings.stopPosition&&("string"===l?o=$(t.settings.stopPosition):"number"===l?e=t.settings.stopPosition:"function"===l?e=t.settings.stopPosition():o=t.settings.stopPosition,o&&(e=o.offset().top)),n>i&&(null===e||e>n)?t.settings.$element.addClass("fixed"):s()},s=function(){t.settings.$element.removeClass("fixed")},e=function(){return null===t.settings.on?!0:t.settings.on()};$(window).scroll(function(){e()?n():s()}),e()?n():s()}};Thingiverse.Group=function(){},Thingiverse.Group.getUserGroups=function(e){$.ajax({url:"/ajax/user/groups",type:"POST",data:{user_id:e},dataType:"html",success:function(e,r,a){$(".groups-container").after(e),$("#view-more-groups").hide(),$("#view-fewer-groups").show()}})},Thingiverse.Group.addThing=function(e,r){var a={slug:e,thing_id:r};return $.post("/ajax/groupthings/add_thing",a)},Thingiverse.Group.removeThing=function(e,r){var a={slug:e,thing_id:r};return $.post("/ajax/groupthings/remove_thing",a)},Thingiverse.Group.removeUser=function(e,r){var a={slug:e,user_id:r};return $.post("/ajax/groupmembers/remove_user",a)},Thingiverse.Group.removeThingByElement=function(e,r){var a=r.data("id"),i="There was a problem removing this Thing from this Group";$.when(Thingiverse.Group.removeThing(e,a)).done(function(e){e=$.parseJSON(e),e.ok?r.remove():alert(e.error?e.error:i)}).fail(function(e){alert(i)})},Thingiverse.Group.removeUserByElement=function(e,r){var a=r.data("id"),i="There was a problem removing this User from this Group";$.when(Thingiverse.Group.removeUser(e,a)).done(function(e){e=$.parseJSON(e),e.ok?r.remove():alert(e.error?e.error:i)}).fail(function(e){alert(i)})},Thingiverse.Group.search=function(e){if(e){var r={type:"search",q:e,per_page:4,theme:"mini"};return $.post("/ajax/groups/groups",r)}},Thingiverse.Group.create={},Thingiverse.Group.create.form={rules:{remote:"/ajax/groups/validate"},valid:function(e){return $.post(this.rules.remote,this.serialize(e))},validate:function(e){var r=this,a=e.attr("name");$.when(this.valid(e)).done(function(i){i=$.parseJSON(i),i&&(i.ok||!i[a]?r.updateElementValid(e):i[a].error&&r.updateElementInvalid(e,i[a].error))}).fail(function(e){e.getAllResponseHeaders()&&alert("There was a problem with your request.")})},updateElementValid:function(e){e.removeClass("error").addClass("valid"),e.next(".alert-error").removeClass("active"),e.trigger("validated")},updateElementInvalid:function(e,r){e.removeClass("valid").addClass("error"),e.next(".alert-error").text(r).addClass("active")},submit:function(e){var r=!0;e.find("input, textarea").each(function(e,a){$(a).hasClass("error")&&(r=!1)});var a=e.find('[name="avatar"]');if(r){if(a.val()&&this.avatarUpload.uploading===!0)return!1;e[0].submit()}return!1}},Thingiverse.Group.create.slug={slug_url:"/ajax/groups/slug",generateSlug:function(e){return $.post(this.slug_url,{name:e})}},Thingiverse.Group.create.form.populateSlug=function(e){var r=e.find('input[name="name"]'),a=e.find('input[name="slug"]');r.hasClass("error")||a.val()||$.when(Thingiverse.Group.create.slug.generateSlug(r.val())).done(function(e){e=$.parseJSON(e),e&&(e.slug?a.val(e.slug).trigger("blur"):e.error&&alert(e.error))}).fail(function(e){e.getAllResponseHeaders()&&alert("There was a problem with your request.")})},Thingiverse.Group.create.form.serialize=function(e){var r={};return $.each(e.serializeArray(),function(){r[this.name]=this.value}),r},Thingiverse.Group.create.form.autoSuggestGroups=function(e,r){new Thingiverse.TextCallback({$element:e,callback:function(e){$.when(Thingiverse.Group.search(e)).done(function(e){Thingiverse.Group.create.form.populateGroups(e,r)})}})},Thingiverse.Group.create.form.populateGroups=function(e,r){e?r.html("<p>We've found some similar groups, why not join one of them?</p>"+e).addClass("active"):r.removeClass("active")},Thingiverse.Group.create.View=function(){var e=$('form[name="create-group"]'),r=e.find('input[type="text"], textarea'),a=e.find('[name="avatar"]');Thingiverse.Group.create.form.autoSuggestGroups(e.find('input[name="name"]'),$(".group-search-results")),a.on("change",function(r){Thingiverse.Group.create.form.avatarUpload=new Thingiverse.FileUpload({file:this.files[0],url:"/ajax/groups/upload_image",$progressContainer:$(".inline-upload"),$form:e,isIframe:!0,renderPreview:function(e){$(".avatar.img-preview").css("background-image","url("+e+")").addClass("active")}})}),r.on("blur",function(){Thingiverse.Group.create.form.validate($(this))}),e.find('input[name="name"]').on("validated",function(){Thingiverse.Group.create.form.populateSlug(e)}),e.find(".avatar-wrapper .edit-photo").on("click",function(){a.trigger("click")}),e.on("submit",function(e){e.preventDefault(),Thingiverse.Group.create.form.submit($(this))})};Thingiverse.GroupTopic=function(i){return i&&i.id?(this.id=i.id,this.comment_id=i.comment_id,this.$form=$("#topic-"+this.id),this.$name=this.$form.find('input[name="name"]'),this.$titleDisplay=this.$form.next(".topic-title"),this.init(),this):!1},Thingiverse.GroupTopic.prototype.init=function(){var i=this;this.$form.on("submit",function(){return!1}),$.Topic("commentEditFormLoaded"+this.comment_id).subscribe(function(t){i.showEdit(t)}),$.Topic("commentEdited"+this.comment_id).subscribe(function(t){i.edit(t)}),$.Topic("commentEditFormCancelled"+this.comment_id).subscribe(function(t){i.hideEdit(t)})},Thingiverse.GroupTopic.prototype.showEdit=function(i){this.$form.addClass("active")},Thingiverse.GroupTopic.prototype.hideEdit=function(i){this.$form.removeClass("active")},Thingiverse.GroupTopic.prototype.edit=function(){var i=this,t=this.$name.val(),e="There was a problem with your request.";$.ajax({url:"/ajax/grouptopics/edit",type:"POST",data:{id:this.id,name:t},dataType:"json"}).done(function(o,r,n){o.ok?i.updateName(t):(o.name&&o.name.error?e=o.name.error:o.error&&(e=o.error),alert(e))}).fail(function(i,t,e){alert(e)}).always(function(t,e,o){i.hideEdit()})},Thingiverse.GroupTopic.prototype.updateName=function(i){this.$titleDisplay.text(i)},Thingiverse.GroupTopic.View=function(){$(".cancel-create-topic").on("click",function(i){var t=$(".create-topic-form");t.hasClass("error")||(i.preventDefault(),t.removeClass("active").trigger("reset"))}),$(".create-topic").on("click",function(i){i.preventDefault(),$(".create-topic-form").addClass("active")}),$(".leave-group").on("click",function(){var i="Do you really want to leave this Group? All of your Things will be removed from the Group.";return window.confirm(i)?!0:!1})};Thingiverse.Home=function(){},Thingiverse.Home.View=function(e){var t;$("#spotlight .slides").carouFredSel({circular:!1,infinite:!1,responsive:!0,swipe:{onTouch:!0,options:{excludedElements:"button, input, select, textarea, .noSwipe",tap:function(e,t){window.open($(t).parent("a").attr("href"),"_self")}}},direction:"left",width:"100%",height:"100%",onWindowResize:"throttle",scroll:{items:1,duration:400,onAfter:function(){clearTimeout(t),$('#spotlight-controls > a[href$="#4"]').hasClass("selected")&&(t=setTimeout(function(){$(".circle.1").click()},6e3))}},auto:{play:!0,timeoutDuration:6e3,pauseOnHover:!0},items:{width:1},pagination:{container:"#spotlight-controls",anchorBuilder:function(e){return'<a href="#'+e+'"><div class="circle '+e+'"></div></a>'}}}),$(".explore-content .explore-slides").carouFredSel({auto:!1,circular:!1,infinite:!1,swipe:{onTouch:!0,options:{excludedElements:"button, input, select, textarea, .noSwipe",tap:function(e,t){window.open($(t).parent("a").attr("href"),"_self")}}},direction:"left",height:310,onWindowResize:"throttle",width:"100%",scroll:{duration:400},items:{visible:"variable",height:310,width:290},pagination:{container:".explore-controls",anchorBuilder:function(e){return'<a href="#'+e+'"><div class="circle '+e+'"></div></a>'}}}),$(".customizer-content .customizer-slides").carouFredSel({auto:!1,circular:!1,infinite:!1,swipe:{onTouch:!0,options:{excludedElements:"button, input, select, textarea, .noSwipe",tap:function(e,t){window.open($(t).parent("a").attr("href"),"_self")}}},direction:"left",height:310,onWindowResize:"throttle",width:"100%",scroll:{duration:400},items:{visible:"variable",height:310,width:290},pagination:{container:"#customizer-controls",anchorBuilder:function(e){return'<a href="#'+e+'"><div class="circle '+e+'"></div></a>'}}});for(var i=e.events,n=[],o=0;o<i.length&&n.length<6;o++){var r=new Thingiverse.Event(i[o]);r.element&&($(r.element).appendTo($(".feed-content")),n.push(r))}$(".explore").on("click",".nav.section-dropdown li",function(){var e=$(this);Thingiverse.Home.getThings(e.data("section"),e.data("name"),e.data("subheader"))})},Thingiverse.Home.getThings=function(e,t,i){Thingiverse.View.ajaxLoad(),$("#explore-content-"+e).load("/ajax/main/get_things",{section:e},function(){$(".explore-content").hide(),$(".explore-content."+e).show(),$("#explore-content-"+e+" .explore-slides").carouFredSel({auto:!1,circular:!1,infinite:!1,scroll:{items:"page",duration:400},swipe:{onTouch:!0,options:{excludedElements:"button, input, select, textarea, .noSwipe",tap:function(e,t){window.open($(t).parent("a").attr("href"),"_self")}}},direction:"left",height:310,width:"100%",onWindowResize:"throttle",items:{visible:"variable",height:310,width:290},pagination:{container:".explore-controls",anchorBuilder:function(e){return'<a href="#'+e+'"><div class="circle '+e+'"></div></a>'}}}),$(".selected-section").html(t),$(".selected-section-subheader").html(i),$(".subnav-wrapper.expanded").removeClass("expanded"),Thingiverse.View.ajaxUnload()})};Thingiverse.ImageEdit=function(t){return t&&"object"==typeof t||(t={}),this.settings=$.extend(!0,{},this.defaultSettings,t),this.init(),this},Thingiverse.ImageEdit.prototype.defaultSettings={$container:$(".img-wrapper"),$editTrigger:null,$uploadContainer:null,$iframe:null,formFileBttn:{external:"#upload-container",target:"#file",type:"div",style:"inline-btn",html:'<span id="upload_msg">Upload Your Own</span>'},complete:null},Thingiverse.ImageEdit.prototype.init=function(){var t=this;null===t.settings.$uploadContainer&&(t.settings.$uploadContainer=t.settings.$container.next(".inline-upload")),null===t.settings.$iframe&&(t.settings.$iframe=t.settings.$uploadContainer.find("iframe")),null===t.settings.$editTrigger&&(t.settings.$editTrigger=t.settings.$container.find(".edit-photo")),t.settings.$editTrigger.on("click",function(e){e.preventDefault(),t.toggleUploadContainers()}),$(document).on("imageUploaded",function(e,i){t.imageUploaded(e,i)})},Thingiverse.ImageEdit.prototype.toggleUploadContainers=function(){var t=this;t.settings.$uploadContainer.toggleClass("active"),t.settings.$container.toggleClass("active")},Thingiverse.ImageEdit.prototype.hideUploadContainers=function(){var t=this;t.settings.$container.removeClass("active"),t.settings.$uploadContainer.removeClass("active")},Thingiverse.ImageEdit.prototype.imageUploaded=function(t,e){var i=this;i.settings.$iframe&&i.settings.$iframe.attr("id")===e.iframe_id&&i.hideUploadContainers(),"function"==typeof i.settings.complete&&i.settings.complete()};Thingiverse.ItemChooser=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.init(),this},Thingiverse.ItemChooser.prototype.defaultSettings={$itemChooser:$("#item_chooser"),$chooserNav:$("#item_chooser .modal-nav"),$itemsContent:$("#item_chooser .modal_selector_content"),$closeChooser:$("#item_chooser span.close"),$chooserParent:$(".choose_item"),showChooserSelector:".select_item",chooseItemSelector:".template-micro",base_url:null,source_data:{},onChoose:null,$searchForm:$(".modal_selector form")},Thingiverse.ItemChooser.prototype.init=function(){var e=this;e.settings.$itemChooser.detach().appendTo("body"),e.settings.$chooserParent.on("click",e.settings.showChooserSelector,function(t){t.preventDefault(),e.trigger=$(this),e.showItemChooser()}),e.settings.$chooserNav.find("a").on("click",function(t){t.preventDefault();var s=$(this);return s.hasClass("active")?!1:(e.settings.$chooserNav.find(".active").removeClass("active"),s.addClass("active"),void e.populateItems())}),e.settings.$closeChooser.on("click",function(){e.hideItemChooser()}),e.settings.$itemsContent.on("click",e.settings.chooseItemSelector,function(t){e.chooseItem($(this))}),e.settings.$searchForm.on("submit",function(t){t.preventDefault();var s=$(this),o=s.find(".search-icon"),i=s.find('input[name="q"]').val(),n=e.serializeForm(s);e.populateItems(n),i?o.addClass("active"):o.removeClass("active")}),e.settings.$searchForm.find(".search-icon").on("click",function(){var e=$(this),t=e.closest("form"),s=t.find('input[name="q"]');s.val()&&e.hasClass("active")&&s.val(""),t.trigger("submit")})},Thingiverse.ItemChooser.prototype.showItemChooser=function(){var e=this;e.settings.$itemChooser.modal("show"),$("body","html").css({height:"100%",overflow:"hidden"}),e.populateItems()},Thingiverse.ItemChooser.prototype.hideItemChooser=function(){var e=this;$("body","html").css({height:"auto",overflow:"auto"}),e.settings.$itemChooser.modal("hide")},Thingiverse.ItemChooser.prototype.chooseItem=function(e){var t=this,s=e.data("type"),o=e.data("id"),i=$.extend(!0,t.settings.source_data,{type:s,model_id:o});$.get(t.settings.base_url,i,function(e){e&&"function"==typeof t.settings.onChoose&&t.settings.onChoose(t.trigger,i,e)},"html"),t.hideItemChooser()},Thingiverse.ItemChooser.prototype.populateItems=function(e){var t=this,s=t.settings.$chooserNav.find(".active"),o=s.data("type"),i=s.attr("href").split("#")[1];e=e?e:{},t.settings.$itemsContent.find(".active").removeClass("active"),t.settings.$itemsContent.addClass("loading");var n,a=t.settings.$itemsContent.find(".item_chooser_"+o),r=$.extend(!0,t.settings.source_data,e),h=t.settings.base_url+i;$.isEmptyObject(e)||a.removeClass("loaded").addClass("loading"),a.hasClass("loaded")?(t.settings.$itemsContent.removeClass("loading"),a.addClass("active")):(a.html("").append('<div class="results"></div>'),n=a.find(".results"),n.load(h,r,function(){t.settings.$itemsContent.removeClass("loading"),a.addClass("loaded active")})),t.scroller=new Thingiverse.Scroller({container:n,source:h,source_data:t.settings.source_data,scrollContainer:$(".modal_selector_content")})},Thingiverse.ItemChooser.prototype.serializeForm=function(e){var t={},s=e.serializeArray();return $.each(s,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t};Thingiverse.itemGallery=function(){var e={$thumbHolder:$(".thing-thumbs-holder"),$toggleThumbs:$(".toggle-thumbs"),$fsModal:$("#image-viewer"),$fsHolder:$(".fs-gallery-holder"),$fsThumbs:$(".fs-gallery-thumbs"),$fsSlideHolder:$(".thing-page-slider-fs"),$fsSlider:$(".thing-page-slider-fs").find(".thing-slides"),$thingiviewBtn:$(".thingiview-btn"),$imageViewerThingiviewBtn:$(".imageview-thingiview-btn")};return e.init=function(i){_.extend(e,i),e.numSlides=e.$fsSlider.find(".thing-page-image").length,e.thingiviewSample=e.$fsModal.find(".isthingiview").eq(0),e.loadImages(e.thingiviewSample),e.$toggleThumbs.on("click",function(){var i=$(this);i.toggleClass("active"),e.$fsHolder.toggleClass("active"),e.$fsThumbs.toggleClass("active"),i.hasClass("active")&&e.updateFeaturedImage(e.$fsModal.find(".thing-page-image").eq(0))}),e.$fsThumbs.on("click",".thing-page-image-thumb",function(){e.$toggleThumbs.trigger("click"),e.fullGallery&&e.fullGallery.trigger("slideTo",[$(this).index(),{fx:"none",duration:0}])}),e.$fsModal.find(".close").on("click",function(){$("body").removeClass("overlay-mode"),e.updateFeaturedImage(e.$fsModal.find(".thing-page-image").eq(0)),e.$toggleThumbs.hasClass("active")&&e.$toggleThumbs.trigger("click")}),$(".largeview-btn").on("click",function(){$("body").addClass("overlay-mode"),e.showImageViewerModal()}),$(".main-slider").on("click",".video-slide",function(i){i.preventDefault(),e.updateFeaturedImage($(this).closest(".thing-page-image"))});var l=0;$("#description a, #instructions a").each(function(i,t){var n=$(t).attr("href");n&&n.replace(/(youtu\.be\/|youtube.com\/watch\?v=)([\-_a-zA-Z0-9]+)/,function(i,n,a){var r=e.addImage({embedYoutube:a},l);$(t).on("click",function(i){return $(document).scrollTop(100),e.carousel?e.carousel.find('.thing-gallery-thumb[data-slideindex="'+r+'"]').trigger("click"):e.slider&&e.slider.trigger("slideTo",[r,{fx:"none",duration:0}]),!1}),l++})}),e.resizeTimer=null,$(window).on(Thingiverse.resizeEvent,function(){e.resizeTimer&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.onResize()},100)}),e.setUpGallery()},e.addImage=function(i,l){l="undefined"==typeof l?1:l;var t=0===e.numSlides?0:l+1,n="",a="",r='<img src="/img/default/rendering_thumb_small.jpg">',s='<img src="/img/default/Gears_preview_featured.jpg">',d='<img src="/img/default/Gears_preview_large.jpg">';i.previewUrl&&(n=i.previewUrl),i.embedYoutube&&(a=i.embedYoutube,r='<img src="http://img.youtube.com/vi/'+a+'/2.jpg"><i class="icon-play icon-white"></i>',s='<img src="http://img.youtube.com/vi/'+a+'/0.jpg" class="video-slide-img"><a href="http://www.youtube.com/watch?v='+a+'" target="_blank" class="video-slide"><i class="icon-play icon-white"></i></a>',d='<img src="http://img.youtube.com/vi/'+a+'/0.jpg"><i class="icon-play icon-white"></i>');var o='<div class="thing-gallery-thumb" data-preview-url="'+n+'" data-embed-youtube="'+a+'" data-slideindex="'+t+'">',g='<div class="thing-page-image featured" data-preview-url="'+n+'" data-embed-youtube="'+a+'">',h='<span class="thing-page-image-thumb" data-preview-url="'+n+'" data-embed-youtube="'+a+'"">';o=o+r+"</div>",g=g+s+"</div>",h=h+d+"</span>";var u=$(".thing-gallery-thumbs"),f=$(".thing-page-slider:not(.thing-page-slider-fs) .thing-slides");return 0===t?($(o).appendTo(u),f.html(g),$(g).append(e.$fsSlider),$(h).appendTo(e.$fsThumbs)):($(o).insertAfter(u.find(".thing-gallery-thumb:eq("+l+")")),$(g).insertAfter(f.find(".thing-page-image:eq("+l+")")),$(g).insertAfter(e.$fsSlider.find(".thing-page-image:eq("+l+")")),$(h).insertAfter(e.$fsThumbs.find(".thing-page-image-thumb:eq("+l+")"))),e.numSlides++,t},e.updateFeaturedImage=function(i){if(!e.isMobile){var l=i.closest(".thing-page-image-holder"),t={thingiviewUrl:i.data("thingiviewUrl"),embedYoutube:i.data("embedYoutube")},n=$(".thing-banner"),a=l.find(".largeview-btn"),r=$(".thing-about"),s=l.find(".video-holder").hide();$(".video-iframe").remove();var d=l.find(".thingiview-iframe");if(d.hide(),void 0!==t.embedYoutube){a.hide(),e.$thingiviewBtn.hide(),e.$imageViewerThingiviewBtn.hide();var o=s.width(),g=s.height();return o>800&&(o=800,g=450),s.css({width:o,height:g}).html('<iframe class="video-iframe" src="//www.youtube.com/embed/'+t.embedYoutube+'" frameborder="0" width="100%" height="100%"></iframe>').show(),n.length&&n.addClass("hide"),r.hide(),void s.show()}return n.length&&n.removeClass("hide"),r.show(),t.thingiviewUrl?(a.show(),e.$thingiviewBtn.show(),e.$imageViewerThingiviewBtn.show(),e.$thingiviewBtn.off("click"),e.$thingiviewBtn.click(function(){thingiview.visible?e.hideThingiview():(e.showThingiview(),thingiview.loadModelJson(t.thingiviewUrl))}),thingiview.visible&&(e.showThingiview(),thingiview.loadModelJson(t.thingiviewUrl)),e.$imageViewerThingiviewBtn.off("click"),void e.$imageViewerThingiviewBtn.click(function(){d.attr("src","/thingiview/thingiverse.html?file="+t.thingiviewUrl+"&width="+d.width()+"&height="+d.width()),d.off("load"),$(this).hide(),d.load(function(){d.show(),l.find("> img").hide(),d.each(function(e,i){i.contentWindow.thingiview.show(),i.style.marginTop="-"+i.clientHeight/2+"px",i.style.top="50%",i.style.position="relative",i.contentWindow.thingiview.hideButtons(),i.contentWindow.thingiview.resize=function(){}}),Thingiverse.View.track_event("Thing","Thingiview")})})):void(e.numSlides&&(e.hideThingiview(),a.show(),e.$thingiviewBtn.hide(),e.$imageViewerThingiviewBtn.hide()))}},e.showThingiview=function(){thingiview.show(),thingiview.clearScene(),Thingiverse.View.track_event(["Thing","Thingiview"]);var e=$(".largeview-btn");e.off("click")},e.hideThingiview=function(){"undefined"!=typeof thingiview&&(thingiview.hide(),thingiview.clearScene());var i=$(".largeview-btn");i.off("click"),i.on("click",function(){$("body").addClass("overlay-mode"),e.showImageViewerModal()})},e.showImageViewerModal=function(){if(e.$fsModal.modal("show"),e.slider)e.fullGallery?(e.sizeFullGalleryImg(),e.syncFullGallery()):e.setupFullGallery();else{e.sizeFullGalleryImg();var i=e.$fsSlider.find(".thing-page-image");e.loadImages(i),e.updateFeaturedImage(i.show())}e.loadImages(e.$fsThumbs)},e.setupFullGallery=function(){var i=!1;e.fullGallery&&(i=e.fullGallery.triggerHandler("currentPosition"),e.fullGallery.trigger("destroy",[!0]),e.fullGallery=null),e.sizeFullGalleryImg(),e.$fsSlider.carouFredSel({circular:!1,infinite:!1,auto:!1,fx:"fade",width:"100%",height:"100%",items:{width:"100%",height:"100%",visible:1,minimum:2},swipe:!0,next:{button:e.$fsModal.find(".thing-gallery-right"),key:39},prev:{button:e.$fsModal.find(".thing-gallery-left"),key:37},onCreate:function(l){e.fullGallery=$(this),i?e.fullGallery.trigger("slideTo",[i,{fx:"none",duration:0}]):e.syncFullGallery(),e.loadImages($(l.items))},scroll:{fx:"fade",onBefore:function(i){e.$fsModal.find(".thingiview-btn").hide(),e.loadImages($(i.items.visible))},onAfter:function(i){e.updateFeaturedImage(i.items.visible)}}})},e.sizeFullGalleryImg=function(){var i=e.$fsModal.find(".thing-page-header").height(),l=20,t=e.$fsModal.height()-i-l,n=e.$fsModal.width();e.$fsSlideHolder.css({height:t+"px"}).find(".thing-page-image").css({width:n+"px",height:t+"px","line-height":t+"px"}),$(".fullSizeContent").css({top:i+l+"px"});var a=!1,r=!1;if(e.thingiviewSample.length?(a=e.thingiviewSample.find("img"),r=t-a.height()+e.$fsModal.find(".thingiview-btn").height()+10):e.$fsModal.find(".video-slide-img").length&&(a=e.$fsModal.find(".video-slide-img"),r=t-a.height()),a){var s=a.height();e.$fsModal.find(".thing-page-image-opts").css({"line-height":r+"px"}),e.$fsModal.find(".thingiview-iframe, .video-holder").css({width:a.width()+"px",height:s+"px","margin-top":"-"+s/2+"px"}),e.$fsModal.find(".thing-page-image-opts").css({width:a.width()+"px"})}},e.syncFullGallery=function(){var i=e.slider.triggerHandler("currentPosition"),l=e.fullGallery.triggerHandler("currentPosition");i===l?e.updateFeaturedImage(e.fullGallery.find(".thing-page-image").eq(i)):e.fullGallery.trigger("slideTo",[i,{fx:"none",duration:0}])},e.onResize=function(){if(e.setUpGallery(),e.$fsModal.is(":visible")){var i=e.$fsSlideHolder.is(":visible");i||e.$fsHolder.addClass("active"),e.fullGallery?e.setupFullGallery():e.sizeFullGalleryImg(),i||e.$fsHolder.removeClass("active")}else e.fullGallery&&(e.fullGallery.trigger("destroy",[!0]),e.fullGallery=null)},e.loadImages=function(e){var i=e.find("img.load-delay");i.length&&i.each(function(e,i){var l=$(i);l.attr("src",l.data("img")).one("load",function(){$(this).removeClass("load-delay")})})},e.setUpGallery=function(){e.isMobile=$(".card-slider").is(":visible");var i=!1,l=!1;e.carousel&&(l=e.carousel.triggerHandler("currentPosition"),e.carousel.trigger("destroy",[!0]),e.carousel=null),e.slider&&(i=e.slider.triggerHandler("currentPosition"),e.slider.trigger("destroy",[!0]),e.slider=null);var t=$(".thing-page-slider:visible:not(.thing-page-slider-fs) .thing-slides"),n=$(".thing-gallery-holder:visible .thing-gallery-thumbs");e.numSlides<=1?(e.$thumbHolder.addClass("hidden"),$(".gallery-arrows").addClass("hidden"),0===e.numSlides&&$(".largeview-btn").hide()):(e.$thumbHolder.removeClass("hidden"),e.numSlides>7?e.$thumbHolder.find(".gallery-arrows").removeClass("hidden"):e.$fsSlideHolder.find(".gallery-arrows").removeClass("hidden")),e.numSlides>1?(t.length&&t.carouFredSel({circular:!1,infinite:!1,items:{visible:1,minimum:1},auto:!1,swipe:!0,pagination:{container:n,anchorBuilder:!1,fx:"fade",duration:200},onCreate:function(l){e.slider=$(this),e.loadImages($(l.items)),i?e.slider.trigger("slideTo",[i,{fx:"none",duration:0}]):e.updateFeaturedImage(l.items)},scroll:{onBefore:function(i){e.loadImages($(i.items.visible))},onAfter:function(i){e.updateFeaturedImage(i.items.visible)}}}),n.length&&n.carouFredSel({circular:!1,infinite:!1,items:{visible:7,minimum:8},auto:!1,next:e.$thumbHolder.find(".thing-gallery-right"),prev:e.$thumbHolder.find(".thing-gallery-left"),onCreate:function(i){e.carousel=$(this),l&&e.carousel.trigger("slideTo",[l,{fx:"none",duration:0}]),e.loadImages($(i.items))},scroll:{onBefore:function(i){e.loadImages($(i.items.visible))}}})):e.updateFeaturedImage(t.find(".thing-page-image"))},e}();Thingiverse.ItemRanker=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.init(),this},Thingiverse.ItemRanker.prototype.defaultSettings={$rankingsContainer:$(".items_rank"),itemSelector:".thing",$addItemTemplate:$(".select_item:last"),removeItemSelector:".thing .remove-btn"},Thingiverse.ItemRanker.prototype.itemsAdded={},Thingiverse.ItemRanker.prototype.itemsRemoved=[],Thingiverse.ItemRanker.prototype.init=function(){var e=this;e.settings.$rankingsContainer.on("click",e.settings.removeItemSelector,function(){e.removeItem($(this).closest(e.settings.itemSelector))})},Thingiverse.ItemRanker.prototype.addItem=function(e,t){var i=this,n=e.index()+1,r=t.type,a=t.model_id,d=i.settings.$rankingsContainer.find('.thing[data-type="'+r+'"][data-id="'+a+'"]');d.length&&i.removeItem(d),$.when(Thingiverse.loadThing({id:a,theme:"chooser"})).done(function(t){e.replaceWith(t)}).fail(function(e){alert("There was a problem with your request")}),i.itemsAdded[n]={type:r,id:a,rank:n}},Thingiverse.ItemRanker.prototype.removeItem=function(e){var t=this,i=e.data("type"),n=e.data("id"),r=e.index()+1;e.replaceWith(t.settings.$addItemTemplate.clone()),t.itemsRemoved.push({type:i,id:n,rank:0}),delete t.itemsAdded[r]},Thingiverse.ItemRanker.prototype.createInputs=function(e){var t,i=this,n=i.itemsRemoved.length;for(var r in i.itemsAdded)t=i.itemsAdded[r],e.append($('<input type="hidden" name="featured[add]['+t.type+"]["+t.id+']" value="'+t.rank+'">'));for(var a=0;n>a;a++)t=i.itemsRemoved[a],t&&e.append($('<input type="hidden" name="featured[remove]['+t.type+"]["+t.id+']" value="0">'))};Thingiverse.loadThing=function(a){return $.ajax({url:"/ajax/things/thing",data:a,dataType:"html"})};Thingiverse.MakeEdit=function(){},Thingiverse.MakeEdit.View=function(e){var n=this,i=$("#make_form"),t=i.serializeObject();i.on("keypress",":input:not(button):not(textarea)",function(e){13==e.which&&(e.preventDefault(),$(this).blur())});var a=0,r=150;document.addEventListener("invalid",function(e){$("html, body").animate({scrollTop:$(e.target).offset().top-r},a)},!0),i.on("submit",function(){i.find('button[type="submit"]').prop("disabled",!0),n.updateFileOrder(o);var e=i.serializeObject(),a=Thingiverse.Utilities.getObjectDifference(t,e);i.find("input").prop("disabled",!0);for(var r in a)$('input[name="'+r+'"]').prop("disabled",!1);$('input[name="[printer brand]"], input[name="[printer]"]').prop("disabled",!1),$('select[name="printer_type"], select[name="printer_models"], input[name="printer_name"]').prop("disabled",!0),n.componentFieldHandler()});var o=$(".imagelist"),l=$('<li class="sortable-placeholder remove-file"></li>').appendTo(o),d=$('<div class="make-cover sortable-placeholder"></div>'),s='<li class="sortable-placeholder"><div class="make-cover"></div></li>',p=null;l.on("dragenter",function(e){return e.preventDefault(),l.addClass("hover"),!1}).on("dragleave",function(e){return e.preventDefault(),l.removeClass("hover"),!1}).on("drop",function(e){return e.stopPropagation(),l.removeClass("hover"),p.addClass("remove"),!1}),o.sortable({placeholder:s,items:"li:not(.sortable-placeholder)"}).bind("sortstart",function(e,n){if(p=n.item,o.find("li:visible:not(.sortable-placeholder)").length>1){var i=o.find("li:visible:first"),t=p[0]===i[0]?i.nextAll("li:visible:first"):i;d.appendTo(t)}else d.addClass("hidden");o.addClass("active")}).bind("sortstop",function(e,i){p.hasClass("remove")&&(n.removeFile(p),n.updateFileOrder(i.startparent),p.appendTo(o),o.trigger("updated")),p=null,o.removeClass("active"),o.find("li").not(".removed").first().attr("data-rank",1)}),o.on("updated",function(){var n=o.find("li:not(.sortable-placeholder):not(.removed)").length;n?(o.addClass("visible"),n>e.manyImagesMax?o.addClass("many-images"):o.removeClass("many-images")):o.removeClass("visible")}),$(".upload-progress").appendTo("body");{var v={url:"/ajax/makes/upload",$progressContainer:$(".upload-progress"),finalizeUrl:e.id?"/ajax/makes/finalize_file?id="+e.id:null,$form:e.id?null:i,renderPreview:function(e,n){var i=o.find('[data-rank="0"]').not(".removed").first();i=i.length?i:o.find(".remove-file"),$('<li data-rank="0"><input type="hidden" data-pendingid="'+n.pendingUpload.pending_upload_id+'" name="pending_upload_ids[images]['+n.pendingUpload.pending_upload_id+'][position]" value=""><img src="'+e+'"></li>').insertBefore(i),o.sortable("reload"),o.trigger("updated")},uploadComplete:function(e){e.finalizeData&&o.find('input[data-pendingid="'+e.pendingUpload.pending_upload_id+'"]').attr("name","images["+e.finalizeData.id+"][position]")}};new Thingiverse.FileDrop({$container:$(".file-upload"),onDrop:function(e){v.file=e,new Thingiverse.FileUpload(v)}})}$('.file-upload input[type="file"]').on("change",function(e){var n,i=this.files.length;for(n=0;i>n;n++)v.file=this.files[n],new Thingiverse.FileUpload(v)}),window.addEventListener("dragover",function(e){e=e||event,e.preventDefault()},!1),window.addEventListener("drop",function(e){e=e||event,e.preventDefault()},!1),$(".thing-edit-page").on("click",".foldable",function(){$(this).toggleClass("folded").parents().andSelf().nextAll(".fold").slideToggle()}),$(".thing-components").on("click",".markdown-preview button",function(e){return e.preventDefault(),n.toggleMarkdownPreview($(this)),!1});var u=$(".thing-component.settings.active");u.length&&Thingiverse.MakeEdit.initPrinterSelect(u);var f=function(){return window.confirm("Are you sure?")?!0:!1};$(".delete-thing").on("click",f);new Thingiverse.FixedPosition({$element:$(".submit-buttons")});$(".submit-buttons a").on("click",f)},Thingiverse.MakeEdit.updateFileOrder=function(e){e.find('input[value!="-1"]').each(function(e,n){$(n).val(e+1)})},Thingiverse.MakeEdit.removeFile=function(e){e.addClass("removed").removeClass("remove").find("input").val("-1")},Thingiverse.MakeEdit.initPrinterSelect=function(e){var n={$printer_type_select:e.find('select[name="printer_type"]'),$printer_model_select:e.find('select[name="printer_models"]'),$printer_name_field:e.find('input[name="printer_name"]'),$brand_field:e.find('input[name="[printer brand]"]'),$printer:e.find('input[name="[printer]"]'),$parent:e};new Thingiverse.Printer.Select(n),n.$printer_name_field.on("blur",function(){n.$printer.val($(this).val())})},Thingiverse.MakeEdit.componentFieldHandler=function(){var e=$(".thing-component.active");e.each(function(e,n){var i=$(n),t=i.find(".subcomponent"),a=(i.data("component"),"components["+e+"]"),r=!1;t.each(function(e,n){var i=$(n).find(":input[name]:not(button):not(:disabled)");i.each(function(){var n=$(this);if(n.val()){var i=n.attr("name"),t=a+"[data]["+e+"]"+i;n.attr("name",t).prop("disabled",!1),r=!0}else n.prop("disabled",!0)})}),r&&(i.find('input[name="[name]"]').attr("name",a+"[name]").val($.trim(i.find("h1:first").text())).prop("disabled",!1),i.find('input[name="[type]"]').attr("name",a+"[type]").prop("disabled",!1))})},Thingiverse.MakeEdit.toggleMarkdownPreview=function(e){var n=e.hasClass("previewing")?!1:!0,i=e.closest("fieldset"),t=i.find(".edit"),a=i.find(".preview"),r=$.trim(t.val()),o=n?"Edit Text":"Preview Text";(n&&r||!n)&&(e.toggleClass("previewing").text(o),n?(e.prop("disabled",!0),$.when(Thingiverse.MakeEdit.parseMarkdown(r)).done(function(n){e.prop("disabled",!1),a.html(n),t.toggle(),a.toggle(),i.data("prevscroll",$(document).scrollTop())})):(a.toggle(),t.toggle(),$("html, body").animate({scrollTop:i.data("prevscroll")},500),i.removeData("prevscroll")))},Thingiverse.MakeEdit.parseMarkdown=function(e){return $.ajax({url:"/ajax/things/markdown",type:"POST",data:{markdown:e}})};Thingiverse.Makerware=function(){},Thingiverse.Makerware.isMakerware=!1,Thingiverse.Makerware.mw={appAttributeExists:function(e){return"undefined"!=typeof mwThingiverse&&"undefined"!=typeof mwThingiverse[e]}},Thingiverse.Makerware.View=function(){var e=this;e.isMakerware=!0;var t=!$("body").hasClass("loggedout");$("a").each(function(t,i){var n=$(i),a=n.attr("href");n.css("cursor","pointer"),a&&(a.match(/login/)&&(n.removeAttr("href"),n.click(function(){e.mw.appAttributeExists("signInRequest")&&mwThingiverse.signInRequest()})),a.match(/^http/)&&(n.removeAttr("href"),n.click(function(){e.mw.appAttributeExists("openUrl")&&mwThingiverse.openUrl(a)})),(a.match(/^\/\s*apps\/./)||"_blank"===n.attr("target"))&&(n.removeAttr("href"),n.click(function(){e.mw.appAttributeExists("openUrl")&&mwThingiverse.openUrl("http://www.thingiverse.com"+a)})))}),$(document).on("click",".view-in-library",function(t){e.mw.appAttributeExists("openInLibrary")&&mwThingiverse.openInLibrary("#thing/f:0/"+$(t.target).data("thingId"))}),$("button.thing-download-btn").html("Prepare").css("background-image","url(/img/makerware/prepare.png)"),$("#thing-files > .thing-page-right").hide(),$(".thing-download-zip > span").html(""),$("#thing-files > .thing-page-left").css("width","100%"),$("#thing-files > .thing-page-left .size-header").after($("<h4>Actions</h4>")),$(".thing-file .details").css({width:"270px","max-width":"270px"}),$("a.thing-file-download-link").each(function(i,n){if(n=$(n),"Download All Files"!=n.html()){n.removeAttr("href");var a=$(document.createElement("span"));n.attr("data-file-name").match(/\.stl$/i)||n.attr("data-file-name").match(/\.obj$/i)||n.attr("data-file-name").match(/\.thing$/i)?(a.html("<span class='btn btn-primary prepare'>Prepare</span>"),a.children(".prepare").click(function(){if(t){var i=["thing","prepare","file"],a=n.data("trackValue");a&&i.push(a),Thingiverse.View.track_event(i),e.mw.appAttributeExists("fileToPrepare")&&mwThingiverse.fileToPrepare(n.attr("data-thing-id"),n.attr("data-file-id"))}else e.mw.appAttributeExists("signInRequest")&&mwThingiverse.signInRequest()})):(a.html("<span class='btn btn-primary print'>Download</span>"),a.children(".print").click(function(){t?e.mw.appAttributeExists("fileToExport")&&mwThingiverse.fileToExport(n.attr("data-thing-id"),n.attr("data-file-id")):e.mw.appAttributeExists("signInRequest")&&mwThingiverse.signInRequest()})),a.children().css("margin-top","-25px"),n.children(".size").after(a)}}),e.mw.appAttributeExists("isMavericks")&&mwThingiverse.isMavericks&&$("*").css({fontFamily:'"Helvetica", "Helvetica Neue"'}),$('input.search-query[type="text"]').each(function(){var e=this.getAttribute("placeholder");e&&(""===this.value&&(this.value=e),$(this).on("keyup",function(){""===this.value&&(this.value=e)}).on("keydown",function(){this.value==this.getAttribute("placeholder")&&(this.value="")}))}),$(".thing-link").on("click",function(e){var t=$(this);$(e.target).is(":input")||t.toggleClass("active").find("input").select()}),$(".upgrade-notification .remove-item").click(function(){$(".upgrade-notification").removeClass("active"),document.cookie="hide_banner=true"})};Thingiverse.Messages=function(){},Thingiverse.Messages.View=function(e){var a=this;e.searchTerm&&a.HighlightResults(e.searchTerm),e.pagination&&(a.scroller=new Thingiverse.Scroller({container:$(".results-container"),source:e.pagination.source,source_data:e.pagination.source_data,page:e.pagination.page,per_page:e.pagination.per_page,minPage:e.pagination.page,finalPage:e.pagination.final_page,scrollContainer:$(".message-list"),updatePageNum:!1})),e.searchTerm||($(".messages .search-form input").on("focus",function(){$(this).parent().addClass("active")}),$(".messages .search-form input").on("blur",function(){var e=$(this);e.val()||$(this).parent().removeClass("active")}),$(".delete-icon").click(function(e){var a=confirm("Are you sure you want to delete that message?");return a===!0?!0:void e.preventDefault()})),$('[data-toggle="tooltip"]').tooltip()},Thingiverse.Messages.RepliesView=function(e){var a=this;e.pagination&&(a.repliesScroller=new Thingiverse.Scroller({container:$(".results-replies"),source:e.pagination.source,source_data:e.pagination.source_data,page:e.pagination.page,per_page:e.pagination.per_page,minPage:e.pagination.page,finalPage:e.pagination.final_page,scrollContainer:$(".replies-list"),updatePageNum:!0,prevButtonText:"Load Newer Messages",nextButtonText:"Load Older Messages"}));var i=$(".message-reply form"),n=$(".replies-list"),t=i.find("textarea"),s=t.outerHeight();Thingiverse.Utilities.expandTextarea(t,100,function(){var e=t.outerHeight();e!==s&&(n.css("height",n.outerHeight()+(s-e)),s=e)}),i.on("submit",function(e){$.when(Thingiverse.Comment.create(this,e)).done(function(e){location.reload()}).fail(function(e){})}),$("a.report-message").on("click",function(e){e.preventDefault(),$(".message-replies").toggleClass("flag-active")})},Thingiverse.Messages.ComposeView=function(){Thingiverse.Search.initUserAutocomplete($('input[name="to_user"]')[0])},Thingiverse.Messages.HighlightResults=function(e){$(".message-info, .reply-body").easymark("init",{partial:!0});var a=function(){$(".message-info, .reply-body").easymark("highlight",e)};a(),$(".results-container, .results-replies").on("makerbot.inserted",a)};Thingiverse.Monitor=function(){return this.time_series=[],this.start=new Date,this.end=new Date,this},Thingiverse.Chart=function(e,t){Thingiverse.Monitor.call(this),this.title="chart",this.xaxis={type:"datetime",title:{text:"",style:{fontSize:"14px",fontFamily:"Antenna, Verdana, sans-serif",color:"#000000",fontWeight:"bold"}},minPadding:.05,maxPadding:.05},this.tooltip={backgroundColor:"rgba(255,255,255,0.85)",borderWidth:0,borderRadius:4,headerFormat:'<span class="key_title">{point.key}</span><table>',pointFormat:'<tr><td class="key_name" style="color:{series.color};">{series.name}: </td><td class="key_value">{point.y}</td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0};for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);this.chart_element=e},Thingiverse.Chart.prototype=Object.create(Thingiverse.Monitor.prototype),Thingiverse.Monitor.prototype.addTimeSeries=function(e,t){this.time_series.push({metric:e,options:t})},Thingiverse.Monitor.parseDate=function(e){var t=e.value.split("-");return t.length<3?void(e.value=""):new Date(t[0],t[1]-1,t[2])},Thingiverse.Monitor.prototype.loadTimeSeries=function(){for(var e=this,t=Math.floor((new Date-this.start)/1e3/86400),i=Math.floor((new Date-this.end)/1e3/86400),r=i,a=t-i,s=0;s<this.time_series.length;s++){{var n=this.time_series[s].metric;this.time_series[s].options}$.ajax({type:"GET",url:"/ajax/admin/getTimeSeries",data:{metric:n,time_offset:r,time_period:a},dataType:"json",success:function(t){for(var i=e.lookupTimeSeries(t.metric),r=0;r<t.data.length;r++){var a=new Date(t.data[r].Timestamp);if(t.data[r].x=a,t.data[r].y=t.data[r].Average,"undefined"!=typeof t.data[r].printer_id)switch(t.data[r].printer_id){case"2":t.data[r].marker={symbol:"url(/img/icon-rep2.png)"};break;case"3":t.data[r].marker={symbol:"url(/img/icon-rep2x.png)"};break;case"5":t.data[r].marker={symbol:"url(/img/icon-platy.png)"};break;case"6":t.data[r].marker={symbol:"url(/img/icon-tink.png)"};break;case"7":t.data[r].marker={symbol:"url(/img/icon-moose.png)"}}}t.data.sort(function(e,t){return e.x.getTime()-t.x.getTime()}),i.data=t.data,i.name=t.metric,e.updateGraph()},error:function(e){console.log(e)}})}},Thingiverse.Monitor.prototype.lookupTimeSeries=function(e){for(var t=0;t<this.time_series.length;t++)if(this.time_series[t].metric==e)return this.time_series[t];return void 0},Thingiverse.Monitor.prototype.updateGraph=function(){if("undefined"!=typeof this.link_element){$(this.link_element).empty();for(var e=Math.floor((new Date-this.start)/1e3/86400),t=Math.floor((new Date-this.end)/1e3/86400),i=t,r=e-t,a=0;a<this.time_series.length;a++){var s=this.time_series[a].metric,n=(this.time_series[a].options,document.createElement("a"));n.setAttribute("target","_blank"),n.setAttribute("href","/ajax/admin/getTimeSeries?metric="+s+"&time_offset="+i+"&time_period="+r),n.style.display="block",n.innerHTML="export "+s,$(this.link_element).append(n)}}$(this.chart_element).highcharts({chart:{events:{load:function(){$("tspan").each(function(){"Highcharts.com"==$(this).html()&&$(this).hide()})}}},title:{text:"Slice Render Time",style:{fontSize:"24px",fontFamily:"Antenna, Verdana, sans-serif",color:"#000000",fontWeight:"bold"}},xAxis:this.xaxis,yAxis:{min:0,title:{text:"Slice Time (seconds)",style:{fontSize:"14px",fontFamily:"Antenna, Verdana, sans-serif",color:"#000000",fontWeight:"bold"}}},tooltip:this.tooltip,legend:{enabled:!1},series:this.time_series})};
function updateUrl(e){history.replaceState&&history.replaceState({url:e,page:1},"",e)}function updateFilters(e){var t=e.closest("div.subnav-wrapper"),a=t.nextAll("div.subnav-wrapper");a.removeClass("selected-child").find("li.active").removeClass("active"),a.find("span.selected-section").text("All"),t.find(".active").removeClass("active");var s=e.parent().data("child");s&&$("#"+s).addClass("selected-child"),t.removeClass("expanded").find("span.selected-section").text(e.text()),e.parent().addClass("active"),e.addClass("active")}"undefined"==typeof history.pushState&&(history.pushState=function(){return!0});Thingiverse.PollUpdates=function(){$.ajax("/ajax/user/poll_updates",{success:function(e){var n=e.dash_count>0,s=e.dash_count;s>99&&(s="&infin;"),$(".notification .badge").html(s).toggle(n);var t=e.msg_count>0;$(".badge.new-message").toggle(t),$(".message-count").toggle(t),$(".message-count .number").html(e.msg_count)}})};Thingiverse.Printer=function(){},Thingiverse.Printer.Select=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.init(),this},Thingiverse.Printer.Select.prototype.defaultSettings={$printer_type_select:$('select[name="printer_type"]'),$printer_model_select:$('select[name="printer_models"]'),$printer_name_field:$('input[name="printer_name"]'),$brand_field:$('input[name="printer_brand"]'),$printer:$('input[name="printer"]'),$parent:null},Thingiverse.Printer.Select.prototype.init=function(){var e=this;e.settings.$printer_type_select.on("change",function(){var t,n=$(this),r=n.find("option:selected"),i=n.val(),s=r.data("brand")?r.data("brand"):"";e.settings.$printer_model_select.removeClass("selected").val("").prop("required",!1),e.settings.$printer_name_field.removeClass("selected").val("").prop("required",!1),e.settings.$printer.val(""),e.settings.$brand_field.val(s),"other"===i?e.settings.$printer_name_field.addClass("selected").prop("required",!0):(t=e.settings.$parent?e.settings.$parent.find($(".printer-"+i)):$(".printer-"+i),t.addClass("selected").prop("required",!0))}),e.settings.$printer_model_select.on("change",function(){e.settings.$printer.val($(this).val())})};Thingiverse.Printshop=function(){},Thingiverse.Printshop.initAdminPage=function(){$("ul.things").sortable(),$("ul.things").on("sortstop",function(e,t){$.ajax({type:"POST",url:"/ajax/thingcollection/reorder_things",data:{id:t.item.attr("value"),prev_id:t.item.prev().attr("value"),next_id:t.item.next().attr("value")},complete:function(e){console.log(e.status+": "+e.responseText)},dataType:"json"})})},Thingiverse.Printshop.initEditPage=function(){$("ul.renders").sortable(),$("ul.images").sortable(),$("ul.images").on("sortstop",function(e,t){$.ajax({type:"POST",url:"/ajax/things/orderimages",data:{thing_id:document.getElementById("id").getAttribute("value"),image_ids:$("ul.images").sortable("toArray",{attribute:"value"}).filter(function(e){return e})},complete:function(e){console.log(e.status+": "+e.responseText)},dataType:"json"})})},Thingiverse.Printshop.save=function(e){for(var t=$(e).serializeArray(),o={},a=0;a<t.length;a++)if(void 0!==t[a]){if("collection_id"==t[a].name&&0===t[a].value)return void $("#select-collection-id").css({"border-color":"red"});o[t[a].name]=t[a].value}$("ul.renders")&&(o.image_id=$("ul.renders").sortable("toArray",{attribute:"value"})[0]),$.ajax({type:"POST",url:$(e).attr("action"),data:o,complete:function(e){console.log(e.status+": "+e.responseText),200==e.status&&(document.location="/admin/printshop/collection:"+o.collection_id)},dataType:"json"})},Thingiverse.Printshop.createLayout=function(){var e={};return e.id=$("#id").val(),e.printer_id=$("#create_layout_printer_id").val(),$("ul.renders")&&(e.object_id=$("ul.renders").sortable("toArray",{attribute:"file_id"})[0]),e.object_id?void $.ajax({type:"POST",url:"/ajax/printshopexplorethings/create_layout/",data:e,complete:function(e){console.log(e.status+": "+e.responseText),200==e.status&&document.location.reload()},dataType:"json"}):void alert("drag a model into the top-left box")},Thingiverse.Printshop.deleteLayout=function(e){var t={};t.layout_id=e,$.ajax({type:"POST",url:"/ajax/printshopexplorethings/delete_layout/",data:t,complete:function(e){console.log(e.status+": "+e.responseText),200==e.status&&document.location.reload()},dataType:"json"})},Thingiverse.Printshop.makePublic=function(e){var t={};t.file_id=e,$.ajax({type:"POST",url:"/ajax/printshopexplorethings/publish_slice_file/",data:t,complete:function(e){console.log(e.status+": "+e.responseText),200==e.status&&document.location.reload()},dataType:"json"})},Thingiverse.Printshop.updateSlice=function(e){var t=document.getElementById("layout_"+e+"_shells"),o=document.getElementById("layout_"+e+"_infill"),a={};t&&""!==t.value&&(a.shells=parseInt(t.value)),o&&""!==o.value&&(a.infill=parseFloat(o.value));var n={};n.layout_id=e,n.print_data=JSON.stringify(a),$.ajax({type:"POST",url:"/ajax/printshopexplorethings/update_slice/",data:n,complete:function(e){console.log(e.status+": "+e.responseText),200!=e.status&&alert("potential reslice error, check your log")},dataType:"json"})},Thingiverse.Printshop.render=function(e){$.ajax({type:"POST",url:"/ajax/printshopexplorethings/printshop_render",data:{object_id:e},complete:function(e){console.log(e.status+": "+e.responseText)},dataType:"json"})};Thingiverse.Profile=function(){},Thingiverse.Profile.View=function(e){Thingiverse.View.trackEvent("user",e.user_id,"view");var i=$(".user-search").find(".subnav-wrapper:not(.disabled)");$(".user-search-form input").on("focus",function(){$(this).parent().addClass("active"),i.addClass("disabled")}).on("blur",function(){var e=$(this);e.val()||(e.parent().removeClass("active"),i.removeClass("disabled"))}),$(".user-search-form:not(.active)").on("click",".search-icon:not(.active)",function(){$(".user-search-form input").focus(),$(this).parent().addClass("active")}),$(".user-search-form").on("click",".search-icon.active",function(){$(".user-search-form input").val("").blur(),e.search_term&&$(".user-search-form").submit()}),$("#view-more-groups").on("click",function(){$(".groups-container").length>1?($(".groups-container:nth-of-type(2)").show(),$("#view-more-groups").hide(),$("#view-fewer-groups").show()):($("#view-more-groups").html('<img src="/img/ajax-loader.gif"/>'),Thingiverse.Group.getUserGroups(e.user_id))}),$("#view-fewer-groups").on("click",function(){$(".groups-container:nth-of-type(2)").hide(),$("#view-fewer-groups").hide(),$("#view-more-groups").html("View More"),$("#view-more-groups").show()})},Thingiverse.Profile.Edit={Printer:{},Images:{},Type:{max:3},Programs:{}},Thingiverse.Profile.Edit.Images.init=function(e){var i=(new Thingiverse.ImageEdit({formFileBttn:new FormFileBttn({external:"#profile_image_iframe"}),$container:$(".avatar-wrapper")}),new Thingiverse.ImageEdit({formFileBttn:new FormFileBttn({external:"#header_image_iframe"}),$container:$(".cover-img-wrapper")})),n=$("#image_selector");n.detach().appendTo("body"),$(".choose-img").on("click",function(){t($(this).data("type"))}),n.find(".close").on("click",function(){a()}),n.find(".image_selector_cover img").on("click",function(){var i=$(this),n=i.data("covernumber");$.ajax({type:"POST",url:"/ajax/user/set_preselected_cover",data:{id:e.user_id,cover_id:n}}).done(function(e){1===e&&r(i.attr("src"))}).always(function(e){a()})});var t=function(e){var i=n.find(".image_selector_"+e);i.hasClass("active")||(n.find(".active").removeClass("active"),i.addClass("active")),n.modal("show")},a=function(){n.modal("hide"),i.hideUploadContainers()},r=function(e){$(".cover-img").css("background-image","url("+e+")")}},Thingiverse.Profile.Edit.Type.init=function(){var e=this,i=$('select[name="user_types"]'),n=i.parent().find("ul.taglist-edit"),t=new Thingiverse.TagList({$input:i,$container:n,itemTemplate:'<li><input type="checkbox" name="user_types[%value%]" checked><label>%display%</label></li>',onItemAdded:function(){$('select[name="user_types"] option').each(function(){return this.defaultSelected?(this.selected=!0,!1):void 0}),n.find(":checked").length===e.max&&i.prop("disabled",!0)}});i.on("change",function(){var e=$(this),i=e.find("option:selected");t.addItem({value:e.val(),display:i.text()})}),n.on("change",'input[type="checkbox"]',function(){i.prop("disabled",n.find(":checked").length===e.max)})},Thingiverse.Profile.Edit.Programs.init=function(){var e=$('select[name="programs"]'),i=new Thingiverse.TagList({$input:e,$container:$('ul.taglist-edit[data-for="programs"]'),itemTemplate:'<li><input type="checkbox" name="programs[%value%]" checked><label>%display%</label></li>',onItemAdded:function(){e.val("")}}),n=$('input[name="otherPrograms"]');e.on("change",function(){var e=$(this);"other"===e.val()?n.addClass("selected"):i.addItem({value:e.val(),display:e.find(":selected").text()})}),n.on("change",function(){var e=$(this);i.addItem({value:0,display:e.val()}),e.val("").removeClass("selected")}),n.on("keypress",function(e){return 13==e.which?($(this).trigger("change"),!1):void 0}),e.closest("form").on("submit",function(){$('input[name="programs[0]"]').each(function(e,i){var n=$(i);n.attr("name","programs[0]["+e+"]").val(n.parent().find("label").text())})})};Thingiverse.scroll=function(){var e={container:null,source:null,source_data:{},minPage:1,maxPage:1,finalPage:!1,loading:!1,scrolling:null,addButtons:!0,maxPages:5,backToTopHeight:0};return e.init=function(a){e.container=$(a.container),e.backToTopHeight=e.container.position().top,e.source=a.source,e.source_data=a.source_data?a.source_data:{},e.autoScroll=0===a.auto_scroll?!1:!0,a.hasOwnProperty("page")&&(e.minPage=a.page,e.maxPage=a.page),a.hasOwnProperty("final_page")&&(e.finalPage=a.final_page),a.hasOwnProperty("scrolling")&&(e.scrolling=a.scrolling),$("#back-to-top").css("display","block"),$("#back-to-top").click(e.backToTop),$(window).on("keyup.thingiverse.scroll",function(a){36==a.keyCode&&e.backToTop()}),e.addButtons&&($(e.createMoreButton()).insertBefore(e.container),$(e.createMoreButton()).insertAfter(e.container));var t=e.container.parent();e.prevPageButton=t.find(".view-more").first(),e.prevPageStatus=t.find(".view-more-status").first(),e.nextPageButton=t.find(".view-more").last(),e.nextPageStatus=t.find(".view-more-status").last(),e.minPage<=1&&e.prevPageButton.addClass("hidden"),e.finalPage&&e.finalPage==e.maxPage&&e.nextPageButton.addClass("hidden");var n=function(a){var t=$(window).scrollTop(),n=t+$(window).height(),r=e.nextPageButton.offset().top-200,o=e.prevPageButton.offset().top;e.autoScroll&&!e.loading&&(o>t&&e.minPage>1&&(e.prevPage(),e.scrolling&&e.scrolling(e.minPage)),n>r&&(!e.finalPage||e.maxPage<e.finalPage)&&(e.nextPage(),e.scrolling&&e.scrolling(e.maxPage))),t>e.backToTopHeight&&!$("#back-to-top").hasClass("in")?$("#back-to-top").addClass("in"):t<=e.backToTopHeight&&$("#back-to-top").hasClass("in")&&$("#back-to-top").removeClass("in")};$(window).scroll($.debounce(250,n)),e.nextPageButton.click(function(a){a.preventDefault(),e.nextPage()}),e.prevPageButton.click(function(a){a.preventDefault(),e.prevPage()});var r;1==e.minPage?(r=e.container.find("> *:not(script):first"),r.attr("data-page",e.minPage)):(r=e.getMarker(e.minPage),e.container.prepend(r),$(window).scrollTop(e.container.position().top))},e.reinitialize=function(a){a.source_data&&(e.source_data=a.source_data),a.hasOwnProperty("source")&&(e.source=a.source),a.hasOwnProperty("container")&&(e.container=$(a.container),e.backToTopHeight=e.container.position().top+100),a.hasOwnProperty("page")&&(e.minPage=a.page,e.maxPage=a.page,e.minPage<=1&&$(e.prevPageButton).addClass("hidden"),e.finalPage&&e.maxPage>=e.finalPage&&$(e.nextPageButton).addClass("hidden")),a.hasOwnProperty("scrolling")&&(e.scrolling=a.scrolling),e.container.find("> *:not(script):first").attr("data-page",e.maxPage),e.nextPage()},e.backToTop=function(){$(window).scrollTop(0),e.updatePageNum(1),e.minPage>1&&($(e.container).empty(),e.reinitialize({page:0}))},e.nextPage=function(){e.loading=!0,e.maxPage++,$(e.nextPageButton).addClass("hidden"),$(e.nextPageStatus).removeClass("hidden");var a=_.extend(e.source_data,{page:e.maxPage});$.ajax({url:e.source,type:"POST",data:a,success:function(a,t,n){if(jQuery.trim(a).length){var r=e.markNewContent(a,e.maxPage);r.appendTo(e.container),e.removeExtraPreviousPages(),e.resetScrollWatchers(),e.container.trigger("makerbot.inserted");var o=e.source_data.extra_path?e.source_data.extra_path:"",i=e.source_data.base_url+"page:"+e.source_data.page+o;Thingiverse.View.track_page(i),(!e.finalPage||e.maxPage<e.finalPage)&&($(e.nextPageButton).removeClass("hidden"),$(e.nextPageButton).text("View More"))}else e.maxPage--,e.finalPage=e.maxPage;e.loading=!1,$.event.trigger("pageLoaded")},error:function(){e.maxPage--,$(e.nextPageButton).text("Something went wrong.  Try again?")},complete:function(){$(e.nextPageStatus).addClass("hidden")}})},e.removeExtraPreviousPages=function(){var a=e.container.find("[data-page]");if(a.length>e.maxPages){var t=a.slice(-e.maxPages).first(),n=t.index(),r=$(e.container).height(),o=($(e.container).children().slice(0,n).remove(),$(e.container).height());$(window).scrollTop($(window).scrollTop()-(r-o)),e.minPage=t.data("page"),e.minPage>1&&(e.prevPageButton.removeClass("hidden"),e.prevPageButton.text("View More"))}},e.prevPage=function(){e.loading=!0,e.minPage--,e.prevPageButton.addClass("hidden"),e.prevPageStatus.removeClass("hidden");var a=_.extend(e.source_data,{page:e.minPage});$.ajax({url:e.source,type:"POST",data:a,success:function(a,t,n){if(jQuery.trim(a).length){var r=e.markNewContent(a,e.minPage),o=e.container.height();r.prependTo(e.container);var i=e.container.height();$(window).scrollTop($(window).scrollTop()+(i-o)),e.removeExtraNextPages(),e.resetScrollWatchers();var s=e.source_data.extra_path?e.source_data.extra_path:"",g=e.source_data.base_url+"page:"+e.source_data.page+s;Thingiverse.View.track_page(g),e.minPage>1&&(e.prevPageButton.removeClass("hidden"),e.prevPageButton.text("View More"))}e.loading=!1,$.event.trigger("pageLoaded")},error:function(){e.minPage++,e.prevPageButton.text("Something went wrong.  Try again?")},complete:function(){e.prevPageStatus.addClass("hidden")}})},e.removeExtraNextPages=function(){var a=e.container.find("[data-page]");if(a.length>e.maxPages){{var t=a.slice(0,e.maxPages+1).last(),n=t.index();$(e.container).children().slice(n).remove()}e.maxPage=t.data("page")-1,e.nextPageButton.removeClass("hidden"),e.nextPageButton.text("View More")}},e.resetScrollWatchers=function(){setTimeout(function(){Thingiverse.scrollMonitor.reset(),e.container.find("*[data-page]").each(function(a,t){Thingiverse.scrollMonitor.watchElement($(t),{callback:function(a){e.updatePageNum(a.element.data("page"))}})})},100)},e.markNewContent=function(a,t){var n,r=$(a);return 1==t?(n=r.filter("div").first(),n.attr("data-page",t)):(n=e.getMarker(t),r=$.merge(n,r)),r},e.getMarker=function(e){return $("<div />",{"class":"inf-scroll-separator","data-page":e,html:"<span class='banner-wrap'></span><span class='page-marker'>Page "+e+"</span>"})},e.updatePageNum=function(e){if(history.replaceState){var a=document.createElement("a");a.href=window.location.href;var t=a.search;a=a.pathname;var n=Thingiverse.isIE10?"/":"",r=/^(.*)\/page:([0-9])+/;if(r.test(a)){var o=r.exec(a);o[2]!=e&&history.replaceState({page:e},"",n+o[1]+"/page:"+e+t)}else/\/$/.test(a)&&(a=/^(.*)\//.exec(a)[1]),history.replaceState({page:e},"",n+a+"/page:"+e+t)}},e.createMoreButton=function(){return $("<div class='view-more'>View More</div><div class='view-more-status hidden'><img src='/img/ajax-loader.gif' /></div>")},e}();Thingiverse.Scroller=function(e){return e&&"object"==typeof e||(e={}),this.settings=$.extend(!0,{},this.defaultSettings,e),this.init(),this},Thingiverse.Scroller.prototype.defaultSettings={container:null,source:null,source_data:{},minPage:1,maxPage:1,finalPage:!1,loading:!1,scrolling:null,addButtons:!0,maxPages:5,backToTopHeight:0,autoScroll:!0,scrollContainer:$(window),updatePageNum:!1,prevButtonText:"View More",nextButtonText:"View More",offset:10},Thingiverse.Scroller.prototype.init=function(){var e=this;e.settings.backToTopHeight=e.settings.container.position().top,e.settings.addButtons&&($(e.createMoreButton("prev")).insertBefore(e.settings.container),$(e.createMoreButton("next")).insertAfter(e.settings.container));var t=e.settings.container.parent();e.settings.prevPageButton=t.find(".view-more").first(),e.settings.prevPageStatus=t.find(".view-more-status").first(),e.settings.nextPageButton=t.find(".view-more").last(),e.settings.nextPageStatus=t.find(".view-more-status").last(),e.settings.minPage<=1&&e.settings.prevPageButton.addClass("hidden"),e.settings.finalPage&&(e.settings.finalPage==e.settings.maxPage||e.settings.page&&e.settings.finalPage===e.settings.page)&&e.settings.nextPageButton.addClass("hidden"),e.settings.finalPage||e.preloadNext(),Thingiverse.scrollMonitor.scrollElement=e.settings.scrollContainer,Thingiverse.scrollMonitor.defaults.offset=e.settings.offset;var n=function(t){if(e.isScrolling=!0,e.isScrolling)return!1;var n=e.settings.scrollContainer.scrollTop(),s=n+e.settings.scrollContainer.height(),i=e.settings.nextPageButton.position().top-200,a=e.settings.prevPageButton.position().top;e.settings.autoScroll&&!e.settings.loading&&(n>a&&e.settings.minPage>1&&(e.prevPage(),e.settings.scrolling&&e.settings.scrolling(e.settings.minPage)),s>i&&(!e.settings.finalPage||e.settings.maxPage<e.settings.finalPage)&&(e.nextPage(),e.settings.scrolling&&e.settings.scrolling(e.settings.maxPage)))};e.settings.scrollContainer.scroll($.debounce(250,!0,n)),e.settings.scrollContainer.scroll($.debounce(275,function(){e.isScrolling=!1})),e.settings.nextPageButton.click(function(t){t.preventDefault(),e.nextPage()}),e.settings.prevPageButton.click(function(t){t.preventDefault(),e.prevPage()});var s;1==e.settings.minPage?(s=e.settings.container.find("> *:not(script):first"),s.attr("data-page",e.settings.minPage)):(s=e.getMarker(e.settings.minPage),e.settings.container.prepend(s),e.settings.scrollContainer.scrollTop(e.settings.container.position().top))},Thingiverse.Scroller.prototype.nextPage=function(){var e=this;e.settings.loading=!0,e.settings.maxPage++,$(e.settings.nextPageButton).addClass("hidden"),$(e.settings.nextPageStatus).removeClass("hidden");var t=_.extend(e.settings.source_data,{page:e.settings.maxPage});$.when(e.getPageContent(t)).done(function(t){if(jQuery.trim(t).length){var n=e.markNewContent(t,e.settings.maxPage);n.appendTo(e.settings.container),e.removeExtraPreviousPages(),e.resetScrollWatchers(),e.settings.container.trigger("makerbot.inserted"),Thingiverse.View.track_page(e.settings.source_data.base_url+"page:"+e.settings.source_data.page),(!e.settings.finalPage||e.settings.maxPage<e.settings.finalPage)&&$(e.settings.nextPageButton).removeClass("hidden").text(e.settings.nextButtonText)}else e.settings.maxPage--,e.settings.finalPage=e.settings.maxPage;e.settings.loading=!1,e.settings.finalPage||e.preloadNext()}).fail(function(){e.settings.maxPage--,$(e.settings.nextPageButton).text("Something went wrong. Try again?")}).always(function(){$(e.settings.nextPageStatus).addClass("hidden")})},Thingiverse.Scroller.prototype.getPageContent=function(e){var t=this,n=$.Deferred();return t.preloadedNext?(n.resolve(t.preloadedNext),n):$.ajax({url:t.settings.source,type:"POST",data:e})},Thingiverse.Scroller.prototype.removeExtraPreviousPages=function(){var e=this,t=e.settings.container.find("[data-page]");if(t.length>e.settings.maxPages){var n=t.slice(-e.settings.maxPages).first(),s=n.index(),i=$(e.settings.container).height(),a=($(e.settings.container).children().slice(0,s).remove(),$(e.settings.container).height());e.settings.scrollContainer.scrollTop(e.settings.scrollContainer.scrollTop()-(i-a)),e.settings.minPage=n.data("page"),e.settings.minPage>1&&e.settings.prevPageButton.removeClass("hidden").text(e.settings.prevButtonText)}},Thingiverse.Scroller.prototype.prevPage=function(){var e=this;e.settings.loading=!0,e.settings.minPage--,e.settings.prevPageButton.addClass("hidden"),e.settings.prevPageStatus.removeClass("hidden");var t=_.extend(e.settings.source_data,{page:e.settings.minPage});$.ajax({url:e.settings.source,type:"POST",data:t,success:function(t,n,s){if(jQuery.trim(t).length){var i=e.markNewContent(t,e.settings.minPage),a=e.settings.container.height();i.prependTo(e.settings.container);var r=e.settings.container.height();e.settings.scrollContainer.scrollTop(e.settings.scrollContainer.scrollTop()+(r-a)),e.removeExtraNextPages(),e.resetScrollWatchers(),Thingiverse.View.track_page(e.settings.source_data.base_url+"page:"+e.settings.source_data.page),e.settings.minPage>1&&e.settings.prevPageButton.removeClass("hidden").text(e.settings.prevButtonText)}e.settings.loading=!1},error:function(){e.settings.minPage++,e.settings.prevPageButton.text("Something went wrong.  Try again?")},complete:function(){e.settings.prevPageStatus.addClass("hidden")}})},Thingiverse.Scroller.prototype.removeExtraNextPages=function(){var e=this,t=e.settings.container.find("[data-page]");if(t.length>e.settings.maxPages){{var n=t.slice(0,e.settings.maxPages+1).last(),s=n.index();$(e.settings.container).children().slice(s).remove()}e.settings.maxPage=n.data("page")-1,e.settings.nextPageButton.removeClass("hidden").text(e.settings.nextButtonText)}},Thingiverse.Scroller.prototype.resetScrollWatchers=function(){var e=this;setTimeout(function(){Thingiverse.scrollMonitor.reset(),e.settings.container.find("*[data-page]").each(function(t,n){Thingiverse.scrollMonitor.watchElement($(n),{callback:function(t){e.updatePageNum(t.element.data("page"))}})})},100)},Thingiverse.Scroller.prototype.markNewContent=function(e,t){var n,s=this,i=$(e);return 1==t?(n=i.filter("div").first(),n.attr("data-page",t)):(n=s.getMarker(t),i=$.merge(n,i)),i},Thingiverse.Scroller.prototype.getMarker=function(e){return $("<div />",{"class":"inf-scroll-separator","data-page":e,html:"<span class='banner-wrap'></span><span class='page-marker'>Page "+e+"</span>"})},Thingiverse.Scroller.prototype.updatePageNum=function(e){var t=this;if(t.settings.updatePageNum&&e>0&&history.replaceState){var n=document.createElement("a");n.href=window.location.href;var s=n.search;n=n.pathname;var i=Thingiverse.isIE10?"/":"",a=/^(.*)\/page:([0-9])+/;if(a.test(n)){var r=a.exec(n);r[2]!=e&&history.replaceState({page:e},"",i+r[1]+"/page:"+e+s)}else/\/$/.test(n)&&(n=/^(.*)\//.exec(n)[1]),history.replaceState({page:e},"",i+n+"/page:"+e+s)}},Thingiverse.Scroller.prototype.createMoreButton=function(e){var t,n,s=this;return e&&(n="prev"===e,t=n?s.settings.prevButtonText:s.settings.nextButtonText),e&&(n="prev"===e,t=n?s.settings.prevButtonText:s.settings.nextButtonText),$("<div class='view-more'>"+t+"</div><div class='view-more-status hidden'><img src='/img/ajax-loader.gif' /></div>")},Thingiverse.Scroller.prototype.preloadNext=function(){var e=this,t=$.Deferred(),n=_.extend(e.settings.source_data,{page:e.settings.maxPage+1});return e.preloadedNext=null,$.when(e.getPageContent(n)).done(function(n){e.preloadedNext=n,n||e.settings.nextPageButton.addClass("hidden"),t.resolve()}).fail(function(){t.reject()}),t};Thingiverse.scrollMonitor=function(){var e={elements:$([]),scrollElement:$(window),body:$("body"),active:!1,defaults:{offset:10},activeTarget:null};return e.reset=function(){e.elements=$([])},e.watchElement=function(t,l){var n=$.extend({},e.defaults,l);t=$(t),n.top=t.position().top,n.element=t,e.elements.push(n),e.active||e.initialize()},e.initialize=function(){e.scrollElement.on("scroll.thingiverse.scroll-monitor",e.process),e.active=!0},e.process=function(){var t,l=e.scrollElement.scrollTop(),n=e.scrollElement[0].scrollHeight||e.body[0].scrollHeight||document.documentElement.scrollHeight,o=n-e.scrollElement.height();if(l>=o)return e.activeTarget!=(t=e.elements.last()[0])&&e.activate(t);for(t=e.elements.length;t--;){var s=e.activeTarget!=e.elements[t]&&l>e.elements[t].top-e.elements[t].offset&&(!e.elements[t+1]||l<=e.elements[t+1].top-e.elements[t+1].offset);s&&e.activate(e.elements[t])}},e.activate=function(t){e.activeTarget=t,t.callback&&t.callback(t)},e}();Thingiverse.Search=function(e){this.status_container=$("#search_status"),this.query_form=$("#search_query"),this.query_element=$("#edit_query"),this.start_date_element=$("#start_date"),this.stop_date_element=$("#stop_date"),this.search_mode_element=$("#search_mode"),this.order="relevant",this.type="things",this.initial_query="",this.start_date=null,this.stop_date=null;for(var t in e)e.hasOwnProperty(t)&&e[t]&&(this[t]=e[t]);this.updateBaseUrl();var a=this;"advanced"==this.search_mode_element.prop("value")&&a.toggleEditQuery(),$("#toggle_search_mode").on("click",function(){a.toggleEditQuery()}),this.edit_author_element=$("#edit_author"),this.edit_author_element.length&&Thingiverse.Search.initUserAutocomplete(this.edit_author_element),this.edit_tag_element=$("#edit_tag"),this.edit_tag_element.length&&Thingiverse.Search.initTagAutocomplete(this.edit_tag_element),this.edit_description_element=$("#edit_description"),this.edit_license_element=$("#edit_license")},Thingiverse.Search.prototype.updateBaseUrl=function(){this.query_form.attr("action","/search/"+this.order+"/"+this.type)},Thingiverse.Search.prototype.isExpanded=function(){return this.query_form.is(":visible")},Thingiverse.Search.prototype.toggleEditQuery=function(){this.status_container.toggle(),this.query_form.toggle(),this.isExpanded()&&this.query_element.focus();var e=$("#toggle-search-mode");this.isExpanded()?(e.html("Basic Search"),this.search_mode_element.prop("value","advanced")):(e.html("Advanced Search"),this.search_mode_element.prop("value","basic"))},Thingiverse.Search.prototype.searchQueryKeyDown=function(e){return this.query_element=$("#edit-query"),27==e.which?this.toggleEditQuery():!0},Thingiverse.Search.prototype.updateStartDate=function(e){var t=e.split("-");return t.length<3?(this.start_date=null,this.start_date_element.attr("value",""),void this.start_date_element.prop("disabled",!0)):(this.start_date=new Date(t[0],t[1]-1,t[2]),this.start_date_element.attr("value",this.start_date.getTime()/1e3),void this.start_date_element.prop("disabled",!1))},Thingiverse.Search.prototype.updateStopDate=function(e){var t=e.split("-");return t.length<3?(this.stop_date=null,this.stop_date_element.attr("value",""),void this.stop_date_element.prop("disabled",!0)):(this.stop_date=new Date(t[0],t[1]-1,t[2]),this.stop_date_element.attr("value",this.stop_date.getTime()/1e3),void this.stop_date_element.prop("disabled",!1))},Thingiverse.Search.prototype.updateOrder=function(e){this.order=e,this.updateBaseUrl()},Thingiverse.Search.prototype.updateType=function(e){this.type=e,this.updateBaseUrl()},Thingiverse.Search.initTagAutocomplete=function(e,t,a,i){e=$(e),e.length&&(e.autocomplete({delay:250,open:function(){"function"==typeof a&&a(this.value)},close:function(){"function"==typeof t&&t(this.value)},select:function(e,t){return"function"==typeof i&&i(t.item.value),!1},source:function(e,t){var a=e.term.replace(" ","_");$.ajax({url:"/search/autocomplete",dataType:"jsonp",data:{find:"tag",q:a},complete:function(e){var a=JSON.parse(e.responseText);t($.map(a,function(e){return{count:e.tag_count,value:e.tag}}))}})}}),e.data("ui-autocomplete")._renderItem=function(e,t){return t.value?$('<li class="tag">').append("<a>"+t.value+"<span class='pull-right'>"+t.count+"</span></a>").appendTo(e):""},e.data("autocomplete")._resizeMenu=function(){var e=this.menu.element;e.outerWidth(this.element.outerWidth())})},Thingiverse.Search.initUserAutocomplete=function(e,t,a){e=$(e),e.length&&(e.autocomplete({delay:250,open:function(){"function"==typeof a&&a(this.value)},close:function(){"function"==typeof t&&t(this.value)},source:function(e,t){$.ajax({url:"/search/autocomplete",dataType:"jsonp",data:{find:"user",q:e.term},complete:function(e){var a=JSON.parse(e.responseText);t($.map(a,function(e){return{image:e.thumb,value:e.username}}))}})}}),e.data("ui-autocomplete")._renderItem=function(e,t){return t.value?$('<li class="user">').append("<a><span class='name'>"+t.value+"</span><span class='profile-img-wrapper'><img src=\""+t.image+'"/></span></a>').appendTo(e):""},e.data("autocomplete")._resizeMenu=function(){var e=this.menu.element;e.outerWidth(this.element.outerWidth())})};
Thingiverse.Spotlight=function(){},Thingiverse.Spotlight.save=function(t){for(var e=$(t).serializeArray(),a={},r=0;r<e.length;r++)void 0!==e[r]&&(a[e[r].name]=e[r].value);$.ajax({type:"POST",url:$(t).attr("action"),data:a,complete:function(t){200==t.status&&(document.location="/admin/spotlight")},dataType:"json"})},Thingiverse.Spotlight.updatePreview=function(t){for(var e=$(t).serializeArray(),a={},r=0;r<e.length;r++)void 0!==e[r]&&(a[e[r].name]=e[r].value);$("#spotlight_0").parent().attr("class","spotlight "+a.theme+" "+a.color),$("#spotlight_0").attr("title",a.blurb).attr("href",a.url),$("#spotlight_0 .background").css("background-image","url("+a.background_url+")");var i=$("#spotlight_0").next(".detail");i.find(".text").html(a.text),i.find("img").attr("src","/img/"+a.theme+"_"+a.color+".png")},Thingiverse.Spotlight.textAddButton=function(t,e){t=$('textarea[name="text"]');var a=$('select[name="color"]').prop("value"),r="black";"black"==a&&(r="white");var i=t.prop("value");t.prop("value",i+"\n</br></br><a href='"+e+"'><span style='background:"+a+";color:"+r+";padding:10px;line-height:60px;border-radius:5px;font-weight:bold'>Learn More</span></a>"),Thingiverse.Spotlight.updatePreview("#spotlight_edit_form")};function unserialize(e){var a=this,t=function(e){var a=e.charCodeAt(0);return 128>a?0:2048>a?1:2},n=function(e,t,n,r){throw new a.window[e](t,n,r)},r=function(e,a,t){for(var r=2,s=[],o=e.slice(a,a+1);o!=t;)r+a>e.length&&n("Error","Invalid"),s.push(o),o=e.slice(a+(r-1),a+r),r+=1;return[s.length,s.join("")]},s=function(e,a,n){var r,s,o;for(o=[],r=0;n>r;r++)s=e.slice(a+(r-1),a+r),o.push(s),n-=t(s);return[o.length,o.join("")]},o=function(e,a){var t,i,c,d,l,u,h,p,f,m,v,g,_,w,$,y,b,k,x=0,C=function(e){return e};switch(a||(a=0),t=e.slice(a,a+1).toLowerCase(),i=a+2,t){case"i":C=function(e){return parseInt(e,10)},f=r(e,i,";"),x=f[0],p=f[1],i+=x+1;break;case"b":C=function(e){return 0!==parseInt(e,10)},f=r(e,i,";"),x=f[0],p=f[1],i+=x+1;break;case"d":C=function(e){return parseFloat(e)},f=r(e,i,";"),x=f[0],p=f[1],i+=x+1;break;case"n":p=null;break;case"s":m=r(e,i,":"),x=m[0],v=m[1],i+=x+2,f=s(e,i+1,parseInt(v,10)),x=f[0],p=f[1],i+=x+2,x!=parseInt(v,10)&&x!=p.length&&n("SyntaxError","String length mismatch");break;case"a":for(p={},c=r(e,i,":"),x=c[0],d=c[1],i+=x+2,u=parseInt(d,10),l=!0,g=0;u>g;g++)w=o(e,i),$=w[1],_=w[2],i+=$,y=o(e,i),b=y[1],k=y[2],i+=b,_!==g&&(l=!1),p[_]=k;if(l){for(h=new Array(u),g=0;u>g;g++)h[g]=p[g];p=h}i+=1;break;default:n("SyntaxError","Unknown / Unhandled data type(s): "+t)}return[t,i-a,C(p)]};return o(e+"",0)[2]}var SSO=function(e){"use strict";function a(){var a=$("#easycaptcha-user");return a.length||(a=$("#g-recaptcha-response")),"true"===e.testing?!0:!!a.val().trim().length}function t(){$("#easycaptcha-img").length?s.resetEasycaptcha():grecaptcha.reset(),s.hide_loading()}function n(e,a){return Math.floor(Math.random()*(a-e+1))+e}function r(){var e="thingiverse"+Date.now()+n(1,500);return{id:e,url:"http://www.easycaptchas.com/"+e+".captcha.gif"}}var s=this,o=$("#sso-account"),i=$(".loading-screen"),c=null,d=$("article.sso"),l=$("#sso-theme").val();this.redirect_payload=$("#sso-redirect").val();var u=this.redirect_payload?unserialize(atob(this.redirect_payload)):{};this.redirect_url=u.data,this.site_hostname=e?e.hostname:null,s.redirect=function(e){var a="/edit";/thingiverse/.test(document.location.hostname)&&(a="http://"+document.location.hostname.replace(new RegExp(/^accounts[.|-]/),"")),"undefined"!=typeof e?a=e:this.redirect_url?a=this.redirect_url:"?verified=1"===location.search?a+="/welcome":document.location.href.replace(/redirect=([^&]+)/,function(e,t){return a=atob(t).data,e}),document.location.href=a},s.countdown_on_complete=function(){var e=$(".merge-complete");if(e.length){var a=e.find(".redirecting .count"),t=parseInt(a.text(),10);t?(a.text(t-1),setTimeout(s.countdown_on_complete,1e3)):document.location.href=e.find(".continue").attr("href")}},d.on("change keyup","input.check-availability",function(e){if(13!=e.originalEvent.keyCode){var a,t=$(this),n=t.val(),r=t.closest("div"),s=r.find(".availability .wrap");if(clearTimeout(c),"tv_username"===t.attr("id")&&n.length<3)return void r.removeClass("available").addClass("unavailable");if(n.length<3||t.data("original")===n)return s.stop().slideUp("fast"),void r.removeClass("available").addClass("unavailable");var o=t.attr("id");switch(o){case"email":a="/email_available/"+encodeURIComponent(n);break;case"tv_username":a="/username_available/"+encodeURIComponent(n);break;default:a="/username_available/"+encodeURIComponent(n)}c=setTimeout(function(){$.ajax(a,{success:function(e,a,t){if("success"==a){var n=s.find(".avail-status"),o=e.available?"":"un",i=o+"available",c=i;e.message&&(c=i+": "+e.message),r.removeClass("available unavailable").addClass(i),n.text(c),s.slideDown("fast")}}})},750)}}),d.on("submit","#sso-sign-in-form",function(){return!1}),$(document).on("keypress",function(e){return 13!=e.which||$(e.target).hasClass("search-query")?void 0:($("#sso_sign_in").trigger("click"),!1)}),d.on("click","#sso_sign_in",function(e){return e.preventDefault(),s.show_loading("Signing you in..."),s.data={username:$("#username").val(),password:$("#password").val(),theme:l,redirect:this.redirect_payload},$.ajax({url:"/login",type:"POST",data:s.data,dataType:"json",success:function(e){s.hide_error();var a=function(){"undefined"!=typeof e.next?s.load_next_screen(e.next):"undefined"!=typeof e.redirect?s.redirect(e.redirect.url):s.redirect()};"undefined"!=typeof e.enabled_domains?s.set_cookies(e,function(){a()}):a()},error:function(e){e=JSON.parse(e.responseText),s.hide_loading(),s.show_error(e.error)}}),!1}),d.on("submit","#sso-register",function(n){if(n.preventDefault(),s.show_loading("Welcome to Makerbot..."),$("#password").val()!=$("#confirm-password").val())return t(),s.show_error("Passwords must match"),void $("label[for=confirm-password]").addClass("error");for(var r=[$("#country"),$("#industry")],o=r.length;o--;)if(!r[o].val())return r[o].addClass("error").one("click",function(){$(this).removeClass("error")}),$("html, body").scrollTop(r[o].offset().top-100),void t();return a()?(s.data={username:$("#tv_username").val(),password:$("#password").val(),"confirm-password":$("#confirm-password").val(),first_name:$("#first_name").val(),last_name:$("#last_name").val(),email:$("#email").val(),country:$("#country").val(),industry:$("#industry").val(),theme:l,redirect:this.redirect_payload,testing:e.testing},$("#newsletter-signup").prop("checked")&&(s.data["newsletter-signup"]=1),$("#easycaptcha-img").length?["easycaptcha-img","easycaptcha-user"].forEach(function(e){s.data[e]=$("#"+e).val().trim()}):s.data["g-recaptcha-response"]=$("#g-recaptcha-response").val(),$.ajax({url:"/register",type:"POST",data:s.data,dataType:"json",success:function(e){s.hide_error(),"undefined"!=typeof e.enabled_domains&&e.enabled_domains.length>0?s.set_cookies(e,function(){s.redirect(e.next_url)}):s.redirect(e.next_url)},error:function(e){e=JSON.parse(e.responseText),t(),s.show_error(e.error),$("#sso-register").find("input, select").each(function(a){for(var t=$(this),n=t.attr("name"),r=$("label[for="+n+"]"),s=!1,o=0;o<e.errors.length&&!(s=e.errors[o]==n);o++);s?r.addClass("error"):r.removeClass("error")})}}),!1):($("#captcha-error").css("display","inline-block"),void t())}),d.on("submit","#sso-merge-tv",function(e){return e.preventDefault(),s.load_next_screen({method:"POST",url:"/merge_tv",username:$("#tv_username").val(),password:s.data.password,theme:l,tv_password:$("#tv_password").val()},s.countdown_on_complete),!1}),d.on("click","#sso-merge-different-tv",function(e){return e.preventDefault(),s.load_next_screen({method:"GET",url:"/merge_tv",email:s.data.username,theme:l,message:"Please wait..."},s.countdown_on_complete),!1}),d.on("submit","#sso-choose-username",function(e){return e.preventDefault(),s.load_next_screen({method:"POST",url:"/choose_username",username:$("#tv_username").val(),password:s.data.password,tv_password:$("#tv_password").val(),theme:l,message:"Creating your Thingiverse account..."},s.countdown_on_complete),!1}),d.on("submit","#sso-change-username",function(e){e.preventDefault();var a={email:$("#sso-email-new").val()};return $.ajax({url:"/edit",type:"POST",data:a,success:function(e){$("#sso-change-username-status").html("<p>email updated</p>"),$("#sso-change-username-status").effect("highlight")},error:function(e){$("#sso-change-username-status").html("<p>error updating email, please try again</p>"),$("#sso-change-username-status").effect("highlight"),console.log(e)}}),!1}),d.on("submit","#sso-change-password",function(e){e.preventDefault();var a=$("#new_password").val();if(a!=$("#confirm_password").val())return $("#sso-change-password-status").html("<p>passwords do not match</p>"),$("#sso-change-password-status").effect("highlight"),!1;var t={password:a,old_password:old_password};return $.ajax({url:"/edit",type:"POST",data:t,success:function(e){$("#sso-change-password-status").html("<p>password updated</p>"),$("#sso-change-password-status").effect("highlight")},error:function(e){var a="error updating password, please try again";"undefined"!=typeof e.error&&(a=e.error),$("#sso-change-password-status").html("<p>"+a+"</p>"),$("#sso-change-password-status").effect("highlight"),console.log(e)}}),!1}),d.on("submit","#sso-reset-password",function(e){var a=$("#new_password").val();return a!=$("#confirm_password").val()?($("#sso-change-password-status").html("<p>passwords do not match</p>"),$("#sso-change-password-status").effect("highlight"),e.preventDefault(),!1):void 0});var h=o.find('[name="avatar_upload"]');h.on("change",function(a){h.prop("disabled",!0);new Thingiverse.FileUpload({file:this.files[0],url:"/upload",$progressContainer:$(".sso-avatar"),$form:o,isIframe:!0,finalizeUrl:"/finalize?username="+e.user.username,renderPreview:function(e){$(".avatar.img-preview").css("background-image","url("+e+")").addClass("active")},uploadComplete:function(){h.prop("disabled",!1)},onCancel:function(){h.prop("disabled",!1)}})}),o.find(".avatar-wrapper .edit-photo").on("click",function(){h.trigger("click")}),this.load_next_screen=function(e,a){"undefined"==typeof e.method&&(e.method="POST");var t={theme:l,redirect:this.redirect_payload,redirect_url:this.redirect_url,email:s.data.username,username:e.username};e.password&&(t.password=e.password),e.tv_password&&(t.tv_password=e.tv_password),$.ajax({url:e.url,type:e.method,data:t,success:function(e){d.html(e),s.hide_loading(),"function"==typeof a&&a()}})};var p=$("#add-device");p.find("#address_id").on("change",function(e){var a=p.find("#new_address");e.target.value?a.stop().slideUp(350):a.stop().slideDown(350)});var f=$(".tv_alert_box"),m=$(".tv_alert_wrapper");$(".popup_link").on("click",function(e){m.show(),"tv_where_info_bttn_rep"===e.target.id?($("#tv_alert_box_body_rep").show(),f.css("height","600px")):"tv_where_info_bttn_z18"===e.target.id&&($("#tv_alert_box_body_z18").show(),f.css("height","465px"))}),$(".tv_alert_box_close").on("click",function(){m.hide(),$(".tv_alert_box_body").hide()});var v=$(".purchase_makercare"),g=$(".activation_code");$("#third_party_yes").on("click",function(){v.hide(),g.show()}),$("#third_party_no").on("click",function(){g.hide(),v.show()}),this.set_cookies=function(e,a){s.domains_to_load=e.enabled_domains.length;var t,n,r=$("#sso-progress"),o=null,i=function(e){console.log("We spent too long waiting for a message from "+e+"!"),"function"==typeof a&&a()},c=window.addEventListener?"addEventListener":"attachEvent",d=window[c],l="attachEvent"==c?"onmessage":"message";r.show(),d(l,function(e){console.log("parent received message!:  ",e.data),"success"==e.data.split(":")[1]?s.domains_to_load--:console.log(e.data),s.domains_to_load||(clearTimeout(o),"function"==typeof a&&(console.log("Calling callback after logged in!"),a(t.token)))},!1);for(var u,h=0;h<e.enabled_domains.length;h++)t=e.enabled_domains[h],n=document.createElement("div"),u='<iframe id="'+t.name+'-iframe" name="'+t.name+'-iframe"></iframe>',u+='<form id="'+t.name+'-form" action="'+t.url+'" target="'+t.name+'-iframe" method="post">',u+='<input type="hidden" name="sso_token" value="'+t.token+'" />',void 0!==t.thingiverse_id&&(u+='<input type="hidden" name="thingiverse_id" value="'+t.thingiverse_id+'" />'),void 0!==t.full_name&&(u+='<input type="hidden" name="full_name" value="'+t.full_name+'" />'),void 0!==t.email&&(u+='<input type="hidden" name="email" value="'+t.email+'" />'),void 0!==t.avatar&&(u+='<input type="hidden" name="avatar" value="'+t.avatar+'" />'),u+="</form>",n.innerHTML=u,r.append(n),$("#"+t.name+"-form").submit(),o&&clearTimeout(o),console.log("Setting timer for ",t.name),o=setTimeout(i,5e3,t.name)},this.delete_token=function(e){$.ajax({url:"/delete_token",type:"POST",data:{id:e},success:function(a){$("#token_"+e).hide()}})},this.show_loading=function(e){i.find(".message").text(e),i.addClass("show")},this.hide_loading=function(){i.removeClass("show")},this.show_error=function(e){var a=$("div.error p");a.html(e),a.is(":visible")?a.effect("highlight"):a.closest("div").slideDown()},this.hide_error=function(){$("div.error p").slideUp()},this.triggerEasycaptcha=function(){var e=$(".g-recaptcha"),a=r();e.after('<img class="easycaptcha" src="'+a.url+'">','<label for="easycaptcha-user" class="easycaptcha-label">Enter the text above:</label>','<input type="text" id="easycaptcha-user" name="easycaptcha-user">','<input type="hidden" id="easycaptcha-img" name="easycaptcha-img" value="'+a.id+'">'),e.remove()},this.resetEasycaptcha=function(){var e=$("#easycaptcha-img");if(e.length){var a=r();e.val(a.id),$("#easycaptcha-user").val(""),$("img.easycaptcha").attr("src",a.url)}};var _="www.thingiverse.com"!==this.site_hostname&&location.search.indexOf("easycaptcha=1")>-1;return _?s.triggerEasycaptcha():"object"!=typeof window.grecaptcha&&setTimeout(function(){"object"!=typeof window.grecaptcha&&s.triggerEasycaptcha()},1e4),$.ajax({url:"https://api.ipinfodb.com/v3/ip-country?key=c70644e300af5c7dd767bf72692840907dee1c93e649f38e7884fe71c6aaa13b&format=json",success:function(e){var a=e.countryCode;a&&$("#country").val(a).trigger("change")},error:function(){$("#country").val("US").trigger("change")}}),s};"function"!=typeof atob&&(atob=function(e,a){a="undefined"==typeof a?!1:a;var t,n,r,s,o,i,c,d,l,u,h=[],p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u=a?Utf8.decode(e):e;for(var f=0;f<u.length;f+=4)s=p.indexOf(u.charAt(f)),o=p.indexOf(u.charAt(f+1)),i=p.indexOf(u.charAt(f+2)),c=p.indexOf(u.charAt(f+3)),d=s<<18|o<<12|i<<6|c,t=d>>>16&255,n=d>>>8&255,r=255&d,h[f/4]=String.fromCharCode(t,n,r),64==c&&(h[f/4]=String.fromCharCode(t,n)),64==i&&(h[f/4]=String.fromCharCode(t));return l=h.join(""),a?Utf8.decode(l):l}),SSO.Unverified=function(){},SSO.Unverified.View=function(e){$("#send_verification").click(function(){$.ajax({url:"/unverified/resend",type:"POST",data:{username:e.username},success:function(a){document.location.href="//accounts."+e.site_hostname+"?unverified=1"}})})};Thingiverse.tagger=function(t){var e={showFormButton:$(".thing-add-tag-link"),tagForm:$(".thing-add-tag-form"),tagContainer:$(".thing-detail-tags-container")};return e.init=function(t){e=_.extend(e,t),e.textField=e.tagForm.find("input[type=text]"),e.showFormButton.click(function(){e.showFormButton.hide(),e.tagForm.fadeIn(function(){e.textField.focus()})}),e.textField.on("keypress",function(t){var i=Thingiverse.Utilities.checkTagLength(e.textField.val());return 13===t.which?(i?(alert("Tags must be between 3-21 characters"),e.textField.addClass("tag-error")):(e.publicAddTags(),e.textField.removeClass("tag-error")),t.preventDefault(),t.stopPropagation(),!1):void e.textField.removeClass("tag-error")})},e.publicAddTags=function(){e.textField.attr("disabled","disabled"),e.tagContainer.load("/ajax/things/addtags",{id:e.thing_id,tags:e.textField.val(),"public":1},function(){e.showFormButton.show(),e.tagForm.hide(),e.textField.removeAttr("disabled"),e.textField.val("")})},e}();Thingiverse.TagList=function(t){return t&&"object"==typeof t||(t={}),this.settings=$.extend(!0,{},this.defaultSettings,t),this.init(),this},Thingiverse.TagList.prototype.defaultSettings={},Thingiverse.TagList.prototype.init=function(){var t=this;t.settings.$input.on("keypress",function(e){var i=$(this).val(),s=Thingiverse.Utilities.checkTagLength(i);return 13==e.which?(s?(alert("Tags must be between 3-21 characters"),$(this).addClass("tag-error")):(t.addItem({value:i,display:i}),$(this).removeClass("tag-error")),!1):void $(this).removeClass("tag-error")})},Thingiverse.TagList.prototype.addItem=function(t){var e=this;if(t.display=$("<div>").text($.trim(t.display)).html(),!t.display)return!1;var i={"%value%":t.value,"%display%":t.display},s=e.settings.itemTemplate.replace(/%\w+%/g,function(t){return null!==i[t]?i[t]:t}),n=$(s),r=$.trim(n.text()),a=e.settings.$container.children(":visible").filter(function(){return $.trim($(this).text())===r});a.length||e.settings.$container.append(n),"function"==typeof e.settings.onItemAdded&&e.settings.onItemAdded()};Thingiverse.TextCallback=function(t){return t&&"object"==typeof t||(t={}),this.settings=$.extend(!0,{},this.defaultSettings,t),this.init(),this},Thingiverse.TextCallback.prototype.defaultSettings={$element:null,callback:null,delay:250},Thingiverse.TextCallback.prototype.init=function(){var t=this;t.settings.$element.keyup($.debounce(t.settings.delay,function(){t.settings.callback(t.settings.$element.val())}))};function feature_thing(e){$("#feature-btn").load("/ajax/things/feature",{id:e})}function unfeature_thing(e){$("#feature-btn").load("/ajax/things/unfeature",{id:e})}function add_tags(e){Thingiverse.View.ajaxLoad(),$("#add_tags_button").attr("disabled",!0),$("#managetags").load("/ajax/things/addtags",{id:e,tags:$("#tags_to_add").val()},function(){Thingiverse.View.ajaxUnload(),$("#tags_to_add")[0].value="",$("#add_tags_button").removeAttr("disabled")})}function add_tag(e,i,t){Thingiverse.View.ajaxLoad(),$(e).hide(),$("#managetags").load("/ajax/things/addtags",{id:i,tags:t},Thingiverse.View.ajaxUnload)}function remove_tag(e,i){Thingiverse.View.ajaxLoad(),$("#managetags").load("/ajax/things/deletetag",{thing_id:e,tag_id:i},Thingiverse.View.ajaxUnload)}function update_thing_like(e){var i="Unlike",t="like",a=!e.hasClass("active"),n=$(".view-in-library");a?n.length&&n.addClass("is_liked"):(i="Like",t="unlike",n.length&&n.removeClass("is_liked")),Thingiverse.View.update_count(e.find(".interaction-count"),a),e.data("originalTitle",i).toggleClass("active"),Thingiverse.View.track_event(["thing",t])}function update_thing_collect(e){Thingiverse.View.update_count(e.find(".interaction-count"),!0),e.addClass("active")}function getThings(e,i){var t=e[0]?e[0]:"",a="/ajax/things/paginate_things/",n=$.Deferred(),o={newest:{},featured:{},popular:{},"made-things":{type:"instances"},derivatives:{},customizable:{},"random-things":{type:"random"},firehose:{},collections:{}},l=o[e[0]]?o[e[0]]:o.newest,s=l.url?l.url:a,c={type:l.type?l.type:t,per_page:i.per_page?i.per_page:"12",cat:e[1]?e[1]:"",subcat:e[2]?e[2]:"",base_url:i.base_url?i.base_url:""},r=i.start_page?i.start_page:1;return $.ajax({url:"/ajax/things/list_things/",type:"POST",data:{type:c.type,cat:c.cat,subcat:c.subcat,per_page:c.per_page,page:r}}).done(function(e){n.resolve(e),Thingiverse.View.track_page(c.base_url+"page:"+r),Thingiverse.scroll.container&&Thingiverse.scroll.init({container:".thing-list .things.instances",source:s,source_data:c,page:r})}).fail(function(e){n.reject(e)}),n.promise()}Thingiverse.Thing=function(){},Thingiverse.Thing.like_action_callback=function(e){e.preventDefault();var i,t=$(this),a=t.closest("div.thing-interaction-parent");return a.data("makeId")?(i=a.data("makeId"),thingType="makes"):a.data("collectionId")?(i=a.data("collectionId"),thingType="thingcollection"):(i=a.data("thingId"),thingType="things"),t.addClass("waiting"),$.when(Thingiverse.View.update_like(i,thingType)).done(function(e){update_thing_like(t)}).fail(function(e){}).always(function(e){t.removeClass("waiting")}),!1},Thingiverse.Thing.watch_action_callback=function(e){e.preventDefault();var i=$(this),t=i.closest("div.thing-interaction-parent").data("thingId"),a=!i.hasClass("active");return i.addClass("waiting"),$.when(Thingiverse.View.toggle_follow("thing",t,i)).done(function(e){Thingiverse.View.update_count(i.find(".interaction-count"),a)}).fail(function(e){}).always(function(e){i.removeClass("waiting")}),!1},Thingiverse.Thing.collect_action_callback=function(e){e.preventDefault();var i=$(this).closest(".thing-interaction-parent"),t=i.find("form.collect-form");if(collectionOpts){var a=t.find("select");a.html(collectionOpts).val(a.find("option").eq(-2).val()),t.find("div.new-collection-name").removeClass("active")}return t.toggleClass("active"),!1},Thingiverse.Thing.collect_cancel_callback=function(){var e=$(this).closest("form.collect-form");return e.removeClass("active"),!1},Thingiverse.Thing.collect_form_submit=function(){var e=this;return $.when(submit_collection_form(this)).done(function(i){$(e).prev(".thing-interact").children(".thing-collect").addClass("active"),$(e).parent(".thing-interact").children(".thing-collect").addClass("active"),Thingiverse.Makerware.isMakerware&&Thingiverse.Makerware.mw.appAttributeExists("refreshLibraryTab")&&(mwThingiverse.refreshLibraryTab(),$(".view-in-library").length&&$(".view-in-library").addClass("is_collected"))}).fail(function(e){}),!1},Thingiverse.Thing.collect_form_selection_changed=function(){var e=$(this),i=e.parent().find("div.new-collection-name");"-1"===e.val()?i.addClass("active"):i.removeClass("active")},$(document).on("click","span.thing-like:not(.disabled)",Thingiverse.Thing.like_action_callback).on("click","span.thing-watch:not(.disabled)",Thingiverse.Thing.watch_action_callback).on("click","span.thing-collect:not(.disabled)",Thingiverse.Thing.collect_action_callback).on("click","button.collection-cancel",Thingiverse.Thing.collect_cancel_callback).on("submit","form.collect-form",Thingiverse.Thing.collect_form_submit).on("change","form.collect-form select",Thingiverse.Thing.collect_form_selection_changed).on("click",".thing-about",function(e){if("a"!=e.target.tagName.toLowerCase()){var i=$(this).siblings("a.thing-img-wrapper");if(0!==i.length)return document.location=i.attr("href"),e.preventDefault(),!1}}),Thingiverse.Thing.View=function(e){$("#thing-page a.profile_nav_bttn:not(.disabled, .waiting), #thing-page .nav a").on("click",function(e){var i=$(this);if(!i.hasClass("profile_nav_bttn"))return i=$(".profile_edit_nav_container").find('a[data-tab="'+i.data("tab")+'"]').trigger("click"),!1;var t=i.index(),a=i.width(),n=$(window).scrollTop(),o=$("#thing-page").height();updateFilters($('.section-dropdown a[data-tab="'+i.data("tab")+'"]')),$(".profile_nav_bttn.active").removeClass("active"),i.addClass("active").closest(".profile_edit_nav_container").attr("data-activetab",t).find(".profile_nav_bttn_active").css({width:a,left:i.position().left}),$("div.tab-content-holder.active").removeClass("active");var l=i.data("ajax");l?($("#thing-page").css({height:o+"px"}),$.when(Thingiverse.View.getContent({url:l})).done(function(e){Thingiverse.View.updateContent(e,$("#ajax-loaded-content").addClass("active"))}).fail(function(e){}).always(function(e){$(window).scrollTop(n),$("#thing-page").css({height:""})})):$("#"+i.data("tab")).addClass("active"),updateUrl(i.attr("href")),e.preventDefault()}),$(".thingi-print").hide(),$(".thingi-print-label").hide(),$(".tab-thing-print").hide(),Thingiverse.Makerware.isMakerware&&$("#description a, #instructions a").each(function(e,i){var t=$(i),a=t.attr("href");t.css("cursor","pointer").removeAttr("href").on("click",function(){Thingiverse.Makerware.mw.appAttributeExists("openUrl")&&mwThingiverse.openUrl(a)})}),$(".modal").appendTo($("body")),Thingiverse.tagger.init({thing_id:e.thing_id}),Thingiverse.View.formatTime();var i=window.location.hash,t=!1;if(i){var a,n=i.split("/");/comment-/.test(n[0])?(a="#comments",t=n[0]):a=n[0],$('a.profile_nav_bttn[href="'+e.thing_url+"/"+a+'"]').trigger("click")}$(".view_tab").on("click",function(e){e.preventDefault(),$('[data-tab="'+$(this).data("viewtab")+'"]').trigger("click"),$("html,body").animate({scrollTop:$(".profile_edit_nav_container").offset().top},300)}),$("#thing-page a.profile_nav_bttn.active").trigger("click"),$(window).on(Thingiverse.resizeEvent,function(){$("#thing-page a.profile_nav_bttn.active").trigger("click")}),$(".has-tooltip").tooltip(),$(".thing-social-share-icons .close").on("click",function(e){e.stopPropagation(),$(this).closest(".thing-social-share-icons").removeClass("active")}),t&&(window.location.hash=t),Thingiverse.Search.initTagAutocomplete("#edit-tag"),e.limited_view||Thingiverse.itemGallery.init(),e.is_hubs&&Thingiverse.Thing.initHubs(),$ccModal=$("#cc-modal"),$bodyHtml=$("body, html"),$(".launch-modal").click(function(){$bodyHtml.animate({scrollTop:0}),$ccModal.modal("show"),$bodyHtml.addClass("disable-scroll")}),$("#cc-modal .remove-item").click(function(){$ccModal.modal("hide"),$bodyHtml.removeClass("disable-scroll")}),$("body").on("click",".modal-backdrop",function(){$bodyHtml.removeClass("disable-scroll")})},Thingiverse.Thing.initHubs=function(){var e=$("#hubs-order"),i=e.find("form"),t=e.find('button[type="submit"]'),a=e.find("input:checkbox"),n=e.find('input[type="number"]'),o=$(".hubs-count"),l=0;$("button.thing-hubs-btn").on("click",function(){e.modal("show"),0===l&&$(".hubs-select-all").click()}),e.on("show",function(){$("body","html").addClass("disable-scroll")}).on("hide",function(){$("body","html").removeClass("disable-scroll")}),e.on("show",function(){$("body","html").addClass("disable-scroll")}).on("hide",function(){$("body","html").removeClass("disable-scroll")}),$(".hubs-select-all").on("click",function(){var e=$(this);e.hasClass("selected")?(a.prop("checked",!1),n.val("1").prop("disabled",!0).parent().addClass("disabled")):(a.prop("checked",!0),n.prop("disabled",!1).parent().removeClass("disabled")),e.toggleClass("selected"),s()}),a.on("change",function(){s();var i=$(this),t=!i.prop("checked"),a=e.find('input[name="order['+i.val()+']"]').prop("disabled",t).parent();t?a.addClass("disabled"):a.removeClass("disabled")}),i.on("submit",function(){return t.hasClass("disabled")?(l||alert("Select the files you'd like printed"),!1):(c(),t.addClass("loading"),e.modal("hide"),t.removeClass("disabled"),t.removeClass("loading"),void 0)});var s=function(){l=e.find("input:checkbox:checked").length,o.text(l),l?t.removeClass("disabled"):c()},c=function(){t.addClass("disabled")}},Thingiverse.Thing.Edit={Images:{}},Thingiverse.Thing.Edit.Images.init=function(e){$(".manage-image > a").on("click",function(e){e.preventDefault()});var i=$(".manage-image")[0];i&&$("#thing-images").sortable({tolerance:"pointer",containment:"parent",handle:"> img",update:function(i,t){var a=$("#thing-images .manage-image").map(function(e,i){return i.id.replace("manage-image-","")}).toArray();reorder_thing_images(e.thing_id,a)}})};Thingiverse.ThingEdit=function(){},Thingiverse.ThingEdit.View=function(e){var i=this,n=$("#thing_form"),t=n.serializeObject(),a=$(".filelist"),o=a.find("ul");o.sortable({forcePlaceholderSize:!0,handle:".sortable-handle"}),o.on("mouseenter","li",function(){$(this).addClass("hover")}).on("mouseleave","li",function(){$(this).removeClass("hover")}),o.on("updated",function(){var e=o.find("li:not(.removed)").length,i=o.find('li[data-ext="scad"]:not(.removed)').length;e||a.removeClass("active"),!i&&s.is(":checked")&&s.prop("checked",!1),s.prop("disabled",!i)});var s=$('input[name="customizer"]');o.on("click",".remove-item",function(){i.removeFile($(this).closest("li")),o.trigger("updated")});var l=!1;$('button[name="is_published"]').on("click",function(){l=!0}),n.on("keypress",":input:not(button):not(textarea)",function(e){13==e.which&&(e.preventDefault(),$(this).blur())});var r=0,d=150;document.addEventListener("invalid",function(e){$("html, body").animate({scrollTop:$(e.target).offset().top-d},r)},!0),n.on("submit",function(){n.find('button[type="submit"]').prop("disabled",!0),i.updateFileOrder(c),i.updateFileOrder(o);var a=n.serializeObject(),s=Thingiverse.Utilities.getObjectDifference(t,a);n.find("input").prop("disabled",!0);for(var r in s)$('input[name="'+r+'"]').prop("disabled",!1);$('.taglist-edit input, :checkbox, [type="radio"], select[name="groups"], \n       input[name="name"], input[name="custom_hubs_tip"], .sources input').prop("disabled",!1),h&&$(".imagelist input").prop("disabled",!1),$('select[name="printer_type"], select[name="printer_models"], input[name="printer_name"]').prop("disabled",!0),i.componentFieldHandler(),i.programFieldHandler(),l&&(e.userIsNew?alert("New users must wait 24 hours before publishing. Your data will be saved."):n.append('<input type="hidden" name="is_published" value="1">'))});var c=$(".imagelist"),p=$('<li class="sortable-placeholder remove-file"></li>').appendTo(c),u=$('<div class="make-cover sortable-placeholder"></div>'),m='<li class="sortable-placeholder"><div class="make-cover"></div></li>',v=null;p.on("dragenter",function(e){return e.preventDefault(),p.addClass("hover"),!1}).on("dragleave",function(e){return e.preventDefault(),p.removeClass("hover"),!1}).on("drop",function(e){return e.stopPropagation(),p.removeClass("hover"),v.addClass("remove"),!1});var h=!1;c.sortable({placeholder:m,items:"li:not(.sortable-placeholder)"}).bind("sortstart",function(e,i){if(v=i.item,c.find("li:visible:not(.sortable-placeholder)").length>1){var n=c.find("li:visible:first"),t=v[0]===n[0]?n.nextAll("li:visible:first"):n;u.appendTo(t)}else u.addClass("hidden");c.addClass("active")}).bind("sortstop",function(e,n){v.hasClass("remove")&&(i.removeFile(v),i.updateFileOrder(n.startparent),v.appendTo(c),c.trigger("updated")),v=null,c.removeClass("active"),c.find("li").not(".removed").first().attr("data-rank",1),h=!0}),c.on("updated",function(){var i=c.find("li:not(.sortable-placeholder):not(.removed)").length;i?(c.addClass("visible"),i>e.manyImagesMax?c.addClass("many-images"):c.removeClass("many-images")):c.removeClass("visible")}),$('label[for="remix"] .info-icon').tooltip({placement:"bottom",title:$('label[for="remix"] .info-icon').html(),html:!0,trigger:"click"}),$('label[for="customizer"] .info-icon').tooltip({placement:"bottom",title:$('label[for="customizer"] .info-icon').html(),html:!0,trigger:"click"}),$(".modal").appendTo($("body"));var g=$("#guidelines");$("#guidelines-trigger").on("click",function(){g.modal("show")}),g.on("show",function(){$("body","html").addClass("disable-scroll")}).on("hide",function(){$("body","html").removeClass("disable-scroll")}),$("#close-guidelines").on("click",function(){g.modal("hide")});var f=$("#filetypes");$("#filetypes-trigger").hover(function(){f.show()},function(){f.hide()}),$(".upload-progress").appendTo("body");{var b={url:"/ajax/things/upload",$progressContainer:$(".upload-progress"),finalizeUrl:e.id?"/ajax/things/finalize_file?id="+e.id:null,$form:e.id?null:n,renderPreview:function(e,i){var n=c.find('[data-rank="0"]').not(".removed").first();n=n.length?n:c.find(".remove-file"),$('<li data-rank="0"><input type="hidden" data-pendingid="'+i.pendingUpload.pending_upload_id+'" name="pending_upload_ids[images]['+i.pendingUpload.pending_upload_id+'][position]" value=""><img src="'+e+'"></li>').insertBefore(n),c.sortable("reload"),c.trigger("updated")},uploadComplete:function(e){if(e.pendingUpload.is_image_file)e.finalizeData&&c.find('input[data-pendingid="'+e.pendingUpload.pending_upload_id+'"]').attr("name","images["+e.finalizeData.id+"][position]");else{var i=Thingiverse.Utilities.escapeHtml(e.file.name),n=Thingiverse.Utilities.formatFileSize(e.file.size,1),t=e.finalizeData?"files["+e.finalizeData.id+"]":"pending_upload_ids[files]["+e.pendingUpload.pending_upload_id+"]";$('<li data-ext="'+e.ext+'"><input type="hidden" data-pendingid="'+e.pendingUpload.pending_upload_id+'" name="'+t+'[position]" value=""><div class="sortable-wrapper"><div class="sortable-inner-wrapper"><div class="filedata image"><span><img src="http://thingiverse.dev/img/default/Gears_thumb_tiny.jpg"></span></div><div class="filedata name">'+i+'</div><div class="filedata size">'+n+'</div><div class="filedata date">Last Updated: <time datetime="">Just now</time></div><div class="filedata actions"><span class="sortable-handle"></span><span class="remove-item"></span></div></div></div></li>').appendTo(o),a.addClass("active"),o.sortable("reload"),o.trigger("updated")}}};new Thingiverse.FileDrop({$container:$(".file-upload"),onDrop:function(e){b.file=e,new Thingiverse.FileUpload(b)}})}$('.file-upload input[type="file"]').on("change",function(e){var i,n=this.files.length;for(i=0;n>i;i++)b.file=this.files[i],new Thingiverse.FileUpload(b)}),window.addEventListener("dragover",function(e){e=e||event,e.preventDefault()},!1),window.addEventListener("drop",function(e){e=e||event,e.preventDefault()},!1);var T=$('input[name="tags"]'),_=new Thingiverse.TagList({$input:T,$container:T.nextAll("ul.taglist-edit").first(),itemTemplate:'<li><input type="checkbox" name="tags[%value%]" checked><label>%display%</label></li>',onItemAdded:function(){T.val("")}});Thingiverse.Search.initTagAutocomplete(T,"","",function(e){_.addItem({value:e,display:e})});var w=new Thingiverse.TagList({$input:$('select[name="groups"]'),$container:$('select[name="groups"]').parent().nextAll("ul.taglist-edit").first(),itemTemplate:'<li><input type="checkbox" name="groups[%value%]" checked><label>%display%</label></li>',onItemAdded:function(){$('select[name="groups"]').val("")}});$('select[name="groups"]').on("change",function(){var e=$(this);w.addItem({value:e.val(),display:e.find(":selected").text()})}),$(".thing-edit-page").on("click",".foldable",function(){$(this).toggleClass("folded").parents().andSelf().nextAll(".fold").slideToggle()}),i.$sourceSection=$(".sourcelist"),$('input[name="remix"]').on("change",function(){$(this).is(":checked")?i.$sourceSection.addClass("active"):(i.$sourceSection.find(".sources").removeClass("active"),i.$sourceSection.removeClass("active").find("li").each(function(e,n){i.removeSource($(n))}))});var C=i.$sourceSection.find(".search-form"),k=C.find('input[name="q"]');k.next(".cancel-icon").on("click",function(){C.removeClass("active"),k.val(""),i.updateSourceResults()}),new Thingiverse.TextCallback({$element:k,callback:function(e){return(e=$.trim(e))?(i.$sourceSection.addClass("searching"),void $.ajax({url:"/search",dataType:"json",data:{q:e}}).done(function(n){i.updateSourceResults(e,n)})):void i.updateSourceResults()}}),$(".source-search-results").on("click","button",function(){return i.addSource($(this).closest("li")),!1}),k.on("input",function(){$(this).val()?C.addClass("active"):C.removeClass("active")}).on("keypress",function(e){return 13==e.which?($(this).trigger("change"),!1):void 0}),i.$sourceSection.find(".source-search-results").tooltip({selector:".button",placement:"bottom",title:"This license does not allow derivatives",trigger:"hover"}),$(".sources").on("click",".remove-item",function(){i.removeSource($(this).closest("li"))}),$(".thing-components").on("click",".markdown-preview button",function(e){return e.preventDefault(),i.toggleMarkdownPreview($(this)),!1}),$(".thing-components-list").on("click","li:not(.active)",function(){i.addComponent($(this))}),$(".thing-components").on("click",".thing-component > header .remove-item",function(){i.removeComponent($(this).closest(".thing-component"))});var y=$(".thing-component.settings.active");y.length&&Thingiverse.ThingEdit.initPrinterSelect(y),$(".thing-components").on("click",".subcomponent-options .subcomponent-icon",function(){i.addSubcomponent($(this))}),$(".thing-components").on("click",".subcomponent .remove-item",function(){i.removeSubcomponent($(this).closest(".subcomponent"))}),$.each($(".thing-component.active:not(.summary):not(.settings)"),function(){Thingiverse.ThingEdit.initSubcomponentSortable($(this))});var S='[contenteditable="true"][data-placeholder]';$(".thing-components").on("blur",S,function(){var e=$(this);$.trim(e.text())||e.text(e.data("placeholder"))}).on("click",".thing-component.custom > header h1 + span",function(){$(this).closest("header").find(S).focus()}),n.on("change",'.subcomponent input[type="file"]',function(i){var t=$(this),a=t.parent();new Thingiverse.FileUpload($.extend({},b,{url:e.id?"/ajax/things/upload?id="+e.id:"/ajax/things/upload",file:this.files[0],file_type:"asset",finalizeUrl:e.id?"/ajax/upload/finalize":null,renderPreview:function(e,i){a.before('<img src="'+e+'">')},uploadComplete:function(e){if(e.pendingUpload.is_image_file){var i=e.finalizeData?e.finalizeData.id:e.pendingUpload.pending_upload_id;$('<input type="hidden" name="[image_id]" value="'+i+'">').insertAfter(t),e.finalizeData?$('<input type="text" name="[image]" value="'+e.finalizeData.url+'">').insertBefore(t):n.append('<input type="hidden" data-pendingid="'+e.pendingUpload.pending_upload_id+'" name="pending_upload_ids[assets]['+e.pendingUpload.pending_upload_id+'][position]" value="1">'),t.remove()}}}))}),n.on("click",'.subcomponent[data-subcomponent="video"] button',function(){var e=$(this).closest(".subcomponent"),i=e.find('input[name="video-url"]'),n=Thingiverse.Utilities.loadVideoUrl(i.val());return n?(e.find(".video-holder").append($(n)).addClass("active"),$('<textarea name="[video]">'+n+"</textarea>").insertBefore(i),i.remove()):alert("Not a valid YouTube or Vimeo link"),!1}).on("keypress",'.subcomponent[data-subcomponent="video"] input[name="video-url"]',function(e){13==e.which&&$(this).next("button").trigger("click")});var x=new Thingiverse.TagList({$input:$('select[name="programs"]'),$container:$('select[name="programs"]').parent().nextAll("ul.taglist-edit").first(),itemTemplate:'<li><input type="checkbox" name="programs[%value%]" checked><label>%display%</label></li>',onItemAdded:function(){$('select[name="programs"]').val("")}}),E=$('input[name="otherPrograms"]');$('select[name="programs"]').on("change",function(){var e=$(this);"other"===e.val()?E.addClass("active"):x.addItem({value:e.val(),display:e.find(":selected").text()})}),E.on("change",function(){var e=$(this);x.addItem({value:0,display:e.val()}),e.val("").removeClass("active")}),E.on("keypress",function(e){return 13==e.which?($(this).trigger("change"),!1):void 0});var z=function(){return window.confirm("Are you sure?")?!0:!1};$(".delete-thing").on("click",z);new Thingiverse.FixedPosition({$element:$(".submit-buttons")});$(".submit-buttons a").on("click",z);new Thingiverse.FixedPosition({$element:$(".thing-components-list"),stopPosition:function(){var e=$(".thing-component.active").last();return e.offset().top+e.height()-100},on:function(){return $(".thing-component.active").length>1}})},Thingiverse.ThingEdit.addSource=function(e){var i=this,n=i.$sourceSection.find(".sources").addClass("active").find("ul");e.appendTo(n).find("input").prop("disabled",!1),i.updateSourceCounts();var t=i.$sourceSection.find(".source-search-results ul li").length;i.$sourceSection.find(".source-search-results h5 span").text(t+" Result"+(1===t?"":"s"))},Thingiverse.ThingEdit.updateSourceResults=function(e,i){var n=this,t=n.$sourceSection.find(".source-search-results");if(n.$sourceSection.removeClass("searching"),!e)return void t.removeClass("active");var a,o,s,l,r=i.length,d=t.find("ul");t.find("h5").html("<span>"+r+" Result"+(1===r?"":"s")+'</span> for "'+e+'"');var c="";for(a=0;r>a;a++){if(o=i[a],o.license.terms){var p,u=o.license.terms.length;for(s="",p=0;u>p;p++)s+='<img src="/img/cc/chooser_'+o.license.terms[p]+'.png"> '}else s=o.license.name;l=o.license.allows_derivatives?"<button>Add Source</button>":'<span class="button">Add Source</span>',c+='<li><input disabled type="hidden" name="sources['+o.id+']" value="'+o.id+'"><div class="image"><span><img src="'+o.thumbnail+'"></span></div><div class="name"><strong>'+o.name+"</strong> by "+o.creator+'</div><div class="license"><div class="thing-license" title="'+o.license.name+'"><div class="cc-licenses">'+s+'</div></div></div><div class="actions"><span class="remove-item"></span>'+l+"</div></li>"}d.html(c).parent().addClass("active")},Thingiverse.ThingEdit.removeSource=function(e){var i=this;e.remove(),i.updateSourceCounts()},Thingiverse.ThingEdit.updateSourceCounts=function(){var e=this,i=e.$sourceSection.find(".sources ul li").length;e.$sourceSection.find(".sources h5 span").text(i+" Thing"+(1===i?"":"s"))},Thingiverse.ThingEdit.updateFileOrder=function(e){e.find('input[value!="-1"]').each(function(e,i){$(i).val(e+1)})},Thingiverse.ThingEdit.removeFile=function(e){e.addClass("removed").removeClass("remove").find("input").val("-1")},Thingiverse.ThingEdit.programFieldHandler=function(){$('input[name="programs[0]"]').each(function(e,i){var n=$(i);n.attr("name","programs[0]["+e+"]").val(n.parent().find("label").text())})},Thingiverse.ThingEdit.addComponent=function(e){var i,n,t=e.data("component"),a=$(".thing-component."+t).first();i="settings"!==t?a.clone().append($(".thing-component.template").clone().find(".subcomponent").remove().end().html()):a.clone(),"custom"!==t?(n=a,e.addClass("active")):n=$(".thing-component").last(),i.insertAfter(n).addClass("active"),Thingiverse.ThingEdit.initSubcomponentSortable(i),$("html, body").animate({scrollTop:i.offset().top-($(".submit-buttons.fixed").outerHeight()+20)},450),"settings"===t&&Thingiverse.ThingEdit.initPrinterSelect(i)},Thingiverse.ThingEdit.removeComponent=function(e){var i=$(window),n=e.height(),t=i.scrollTop(),a=e.offset().top-$(".submit-buttons.fixed").outerHeight()-20;e.remove(),$(".thing-components-list ."+e.data("component")).removeClass("active"),t>=a&&i.scrollTop(t-n),i.trigger("scroll")},Thingiverse.ThingEdit.addSubcomponent=function(e){var i=e.data("subcomponent"),n=e.closest(".thing-component"),t=$('.thing-component.template div[data-subcomponent="'+i+'"]').clone(),a=(t.find(":input:not(button)"),n.find(".subcomponent-options"));a.length?t.insertBefore(a):t.appendTo(n.find(".fold")),t.closest(".fold").sortable()},Thingiverse.ThingEdit.removeSubcomponent=function(e){var i=e.find('[name="[image]"]').length;if(!i){var n=e.find('[name="[image_id]"]').val();$('[data-pendingid="'+n+'"]').val("-1")}e.remove()},Thingiverse.ThingEdit.initSubcomponentSortable=function(e){e.find(".fold").sortable({handle:".sortable-handle",forcePlaceholderSize:!0,items:".subcomponent"})},Thingiverse.ThingEdit.initPrinterSelect=function(e){var i={$printer_type_select:e.find('select[name="printer_type"]'),$printer_model_select:e.find('select[name="printer_models"]'),$printer_name_field:e.find('input[name="printer_name"]'),$brand_field:e.find('input[name="[printer brand]"]'),$printer:e.find('input[name="[printer]"]'),$parent:e};new Thingiverse.Printer.Select(i),i.$printer_name_field.on("blur",function(){i.$printer.val($(this).val())})},Thingiverse.ThingEdit.componentFieldHandler=function(){var e=$(".thing-component.active");e.each(function(e,i){var n=$(i),t=n.find(".subcomponent"),a=(n.data("component"),"components["+e+"]"),o=!1;t.each(function(e,i){var n=$(i).find(":input[name]:not(button)");n.each(function(){var i=$(this);if(i.val()){var n=i.attr("name"),t=a+"[data]["+e+"]"+n;i.attr("name",t).prop("disabled",!1),o=!0}else i.prop("disabled",!0)})}),o&&(n.find('input[name="[name]"]').attr("name",a+"[name]").val($.trim(n.find("h1:first").text())).prop("disabled",!1),n.find('input[name="[type]"]').attr("name",a+"[type]").prop("disabled",!1))})},Thingiverse.ThingEdit.toggleMarkdownPreview=function(e){var i=e.hasClass("previewing")?!1:!0,n=e.closest("fieldset"),t=n.find(".edit"),a=n.find(".preview"),o=$.trim(t.val()),s=i?"Edit Text":"Preview Text";(i&&o||!i)&&(e.toggleClass("previewing").text(s),i?(e.prop("disabled",!0),$.when(Thingiverse.ThingEdit.parseMarkdown(o)).done(function(i){e.prop("disabled",!1),a.html(i),t.toggle(),a.toggle(),n.data("prevscroll",$(document).scrollTop())})):(a.toggle(),t.toggle(),$("html, body").animate({scrollTop:n.data("prevscroll")},500),n.removeData("prevscroll")))},Thingiverse.ThingEdit.parseMarkdown=function(e){return $.ajax({url:"/ajax/things/markdown",type:"POST",data:{markdown:e}})};Thingiverse.Uploads=function(){return Thingiverse.Uploads=function(){},Thingiverse.Uploads.prototype={constructor:Thingiverse.Uploads,checkForm:function(e,i){var t=e[0].file;return 1===t.files.length?(e[0]["Content-Type"].value=t.files[0].type,e[0]["Content-Disposition"].value="application/octet-stream"!=t.files[0].type?"":"Content-disposition: attachment; filename="+t.files[0].name,i()):(alert("You must select a file!"),!1)},checkFile:function(e,i){return!1},createObjectURL:function(e,i){var t=void 0===window.url?window.webkitURL:window.url,n=void 0===t?window.URL:t;return i(void 0!==n?n.createObjectURL(e):!1)}},Thingiverse.Uploads}();Thingiverse.User=function(){var e={$profile_nav_bttn:$(".profile-edit-page .user-nav a"),$profile_view:$("div.profile_view"),$toggle_bttns:$("div.toggle_container"),$selected_section:$("span.selected-section"),$user_edit_form:$("#user_edit_form"),$auth_apps_revoke:$("div.app_interact"),$save_profile_bttn:$("#save_profile_bttn"),$cancel_profile_bttn:$("#cancel_profile_bttn"),tab_names:["thingiverse_settings","makerbot_account_settings","apps"],currentView:null,$favoritesContainer:$(".choose_item"),$things:$(".choose_item .thing:not(.add_item)"),$thingInteract:$(".thing-interact > *"),$favoriteSelector:$("#favorites_selector"),$favoritesNav:$(".modal-nav"),$favoritesContent:$(".modal_selector_content"),$favoritesClose:$("#favorites_selector span.close"),selectedFavoriteSpot:null,favoritesDeleted:[],favoritesAdded:{},$addFavoriteTemplate:$(".add_item:last"),$hubs_username:$('input[name="hubs_username"]'),$hubs_fixed:$('input[name="hubs_fixed"]'),$hubs_price:$('input[name="hubs_price"]'),$hubs:$(".hubs"),$inputs:$(":input"),isDirty:!1,$username:$('input[name="username"]')};return e.init=function(t){e.currentView=e.tab_names[0],e.user_id=t,new FormFileBttn({external:"iframe#profile_image_iframe",target:"#file",type:"div",style:"upload-btn",html:'<span id="upload_msg">Choose File</span>'}),new FormFileBttn({external:"iframe#profile_image_iframe-tv",target:"#file",type:"div",style:"upload-btn",html:'<span id="upload_msg">Choose File</span>'}),new FormFileBttn({external:"iframe#header_image_iframe",target:"#file",type:"div",style:"upload-btn",html:'<span id="upload_msg">Choose File</span>'}),e.$favoriteSelector.detach().appendTo("body"),e.$profile_nav_bttn.on("click",function(t){t.preventDefault(),e.changeView($(this),$(this).attr("data-view"))}),e.$toggle_bttns.on("click",function(){e.toggleBttn($(this)),e.isDirty=!0}),e.$auth_apps_revoke.on("click",function(){e.revokeAppAuth($(this))}),e.$save_profile_bttn.on("click",function(){return e.saveProfile(),!1}),e.$inputs.on("change",function(){e.isDirty=!0}),e.$cancel_profile_bttn.on("click",function(){e.cancelSave()}),e.$hubs_fixed.on("change",function(){e.$hubs_price.prop("disabled",function(e,t){return t||$(this).val(""),!t})}),e.$hubs_price.on("blur",function(){var e=$(this);e.val(parseFloat(e.val(),10).toFixed(2))}),e.$hubs_username.on("blur",function(){e.validateHubs(e.$hubs_username.val())}).on("keypress",function(e){return 13==e.which?($(this).trigger("blur"),!1):void 0}),hash=window.location.hash.replace(/#/,""),$.inArray(hash,e.tab_names)>-1&&e.changeView(e.$profile_nav_bttn.filter('[data-view="'+hash+'"]').first(),hash),e.$favoritesContainer.on("click",".add_item",function(){e.showFavoritesSelector($(this))}),e.$favoritesNav.find("a").on("click",function(t){t.preventDefault();var i=$(this);if(i.hasClass("active"))return!1;e.$favoritesNav.find(".active").removeClass("active"),i.addClass("active");var a=i.data("type");e.populateUserItems(a)}),e.$favoritesClose.on("click",function(){e.hideFavoritesSelector()}),e.$favoritesContent.on("click",".template-micro",function(t){e.addFavorite($(this))}),e.$favoritesContainer.on("click",".thing .remove-btn",function(){e.removeFavorite($(this).closest(".thing"))}),Thingiverse.Profile.Edit.Type.init(),Thingiverse.Profile.Edit.Programs.init()},e.changeView=function(t,i){return e.currentView===i?!1:(e.currentView=i,e.$profile_nav_bttn.filter(".active").removeClass("active"),e.$profile_nav_bttn.filter('[data-view="'+i+'"]').addClass("active"),e.$selected_section.text(t.text()),e.$profile_view.removeClass("selected_view"),$("#"+i+"_view").addClass("selected_view"),void(window.location.hash=i))},e.toggleBttn=function(e){var t=(e.children(":first"),e.hasClass("toggle_container_active")),i=e.next();t?(e.removeClass("toggle_container_active"),void 0!==i&&i.val(0)):(e.addClass("toggle_container_active"),void 0!==i&&i.val(1))},e.revokeAppAuth=function(e){var t=e.attr("data-revoke");void 0!==t&&$.get(t),e.closest(".thing").fadeOut(200,function(){$(this).remove()})},e.cancelSave=function(){(!e.isDirty||confirm("Discard changes?"))&&(window.location.href="/"+e.$username.val())},e.saveProfile=function(){if(e.isDirty){var t=$("#changepass1").val(),i=$("#changepass2").val();if(t!==i)return alert("Passwords must match!"),!1;var a=!$.isEmptyObject(e.favoritesAdded),o=e.favoritesDeleted.length;if(a||o){{var r={id:this.user_id,favorites:[]};e.favoritesDeleted.length}if(o)for(var n=0;o>n;n++)r.favorites.push(e.favoritesDeleted[n]);if(a)for(var s in e.favoritesAdded)r.favorites.push(e.favoritesAdded[s]);$.ajax({type:"POST",url:"/ajax/user/edit_favorites",data:r,complete:function(){e.$user_edit_form.submit()}})}else e.$user_edit_form.submit()}else window.location.href="/"+e.$username.val()},e.showFavoritesSelector=function(t){e.$selectedFavoriteSpot=t,e.$favoriteSelector.modal("show"),e.populateUserItems(e.$favoritesNav.find(".active").data("type"))},e.hideFavoritesSelector=function(){e.$favoriteSelector.modal("hide")},e.removeFavorite=function(t){var i=t.data("type"),a=t.data("id"),o=t.index()+1;t.replaceWith(e.$addFavoriteTemplate.clone()),e.favoritesDeleted.push({type:i,id:a,rank:0}),delete e.favoritesAdded[o],e.isDirty=!0},e.addFavorite=function(t){var i=t.data("type"),a=t.data("id"),o=e.$selectedFavoriteSpot.index()+1,r=e.$favoritesContainer.find('.thing[data-type="'+i+'"][data-id="'+a+'"]');r.length&&e.removeFavorite(r);$.get("/ajax/user/favoriteselector",{id:e.user_id,type:i,model_id:a},function(t){t&&e.$selectedFavoriteSpot.replaceWith(t)},"html"),e.isDirty=!0,e.favoritesAdded[o]={type:i,id:a,rank:o},this.hideFavoritesSelector()},e.populateUserItems=function(t){e.$favoritesContent.find(".active").removeClass("active"),e.$favoritesContent.addClass("loading");var i=e.$favoritesContent.find(".favorites_selector_"+t);i.hasClass("loaded")?(e.$favoritesContent.removeClass("loading"),i.addClass("active")):(i.html(""),i.load("/ajax/user/favoriteselector",{id:e.user_id,type:t},function(){e.$favoritesContent.removeClass("loading"),i.addClass("loaded active")}))},e.validateHubs=function(t){t&&$.post("/ajax/user/verify_hubs",{username:t}).done(function(t){t=$.parseJSON(t),t.ok?e.$hubs.addClass("active"):(alert(t.error?t.error:"There was a problem with your request"),e.$hubs.removeClass("active"))})},e}();Thingiverse.Utilities={},Thingiverse.Utilities.expandTextarea=function(e,i,t){i=i||100,$(document).on("input",e,function(){e.css("height","");var r=Math.min(e[0].scrollHeight,i);e.css("height",r),"function"==typeof t&&t()})},Thingiverse.Utilities.getObjectDifference=function(e,i){var t={};for(var r in e)r in i?e[r]!==i[r]&&(t[r]=i[r]):t[r]=void 0;for(r in i)r in e||(t[r]=i[r]);return t},Thingiverse.Utilities.formatFileSize=function(e){if(0===e)return"0 b";var i=["b","kb","mb","gb","tb","pb"],t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t))+" "+i[t]},Thingiverse.Utilities.escapeHtml=function(e){return $("<div>").text(e).html()},Thingiverse.Utilities.checkTagLength=function(e){var i=[3,21],t=e.length,r=t<i[0]||t>i[1];return r?!0:void 0},Thingiverse.Utilities.loadVideoUrl=function(e){var i=/(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(.+)/g,t=/(?:http?s?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?(.+)/g,r="";return i.test(e)&&(r='<iframe src="//player.vimeo.com/video/$1" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',r=e.replace(i,r)),t.test(e)&&(r='<iframe src="//www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>',r=e.replace(t,r)),r},$.tvparam=function(e){var i="",t=function(e,r){if("object"!=typeof e)""!==i&&(i+="&"),i+=r+"="+encodeURIComponent(e);else for(var n in e)e.hasOwnProperty(n)&&(void 0===r?t(e[n],n):t(e[n],r+"["+n+"]"))};return t(e),i};
Thingiverse.View=function(){},Thingiverse.View.ajaxLoad=function(){$("#ajax_loader").show()},Thingiverse.View.ajaxUnload=function(){$("#ajax_loader").hide()},Thingiverse.View.render_js_template=function(e,a){var t=$("#"+e).html();return _.template(t,a)},Thingiverse.View.formatTime=function(){$("time").each(function(e,a){var t=$(a),n=new Date(t.attr("datetime"));n.toLocaleDateString()==(new Date).toLocaleDateString()&&t.html(n.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}))})},Thingiverse.View.hideOffCanvas=function(){var e=$("#off-canvas").is(":visible");return e?!1:($("#wrapper").removeClass("show-menu"),$("#off-canvas").removeClass("show"),void $("div.login").removeClass("expanded"))},Thingiverse.View.textOverflows=function(e){var a=$(e.cloneNode(!0)).hide().css("position","absolute").css("overflow","visible").width("auto").height($(e).height());$(e).after(a);var t=e.innerHTML.length>0&&a.width()>$(e).width();return a.remove(),t},Thingiverse.View.getContent=function(e){var a="undefined"==typeof e.data?{}:a,t=$.Deferred();return $("body").addClass("loading"),$.ajax({url:e.url,type:"POST",data:a}).done(function(a){Thingiverse.View.track_page(e.url),t.resolve(a)}).fail(function(e){t.reject(e)}).always(function(e){$("body").removeClass("loading")}),t.promise()},Thingiverse.View.updateContent=function(e,a){a.html(e)},Thingiverse.View.updateResults=function(e,a,t){var n=$("body");void 0===t&&(t={}),(void 0===t.loadingAnimation||t.loadingAnimation)&&n.addClass("loading"),$.when(getThings(e,a)).done(function(e){$("div.things-page-content").first().replaceWith($(e).find("div.things-page-content"))}).fail(function(e){}).always(function(e){(void 0===t.loadingAnimation||t.loadingAnimation)&&setTimeout(function(){n.removeClass("loading")},250)})},Thingiverse.View.update_like=function(e,a){"undefined"==typeof a&&(a="things");var t="/ajax/"+a+"/toggle_like",n=$.ajax({url:t,data:{id:e}});return n},Thingiverse.View.update_count=function(e,a){var t=+e.text();t=a?t+1:t-1,t=0>t?0:t,"NaN"!=t.toString()&&e.text(t)},Thingiverse.View.toggle_follow=function(e,a,t){return Thingiverse.View.ajaxLoad(),"undefined"==typeof t&&(t=$("#follow_controls")),t.hasClass("is_following")?(t.removeClass("is_following").addClass("not_following").removeClass("active"),Thingiverse.View.track_event(["dashboard","unfollow",e,a])):(t.removeClass("not_following").addClass("is_following").addClass("active"),Thingiverse.View.track_event(["dashboard","follow",e,a])),$.post("/ajax/dashboard/set_subscribe_state",{action:"toggle",target_type:e,target_id:a},Thingiverse.View.ajaxUnload)},Thingiverse.View.seen_notification_banner=function(){return ajaxLoad(),$.post("/ajax/user/seen_notification",{},function(e){$(".notification-banner").css("display","none"),Thingiverse.View.ajaxUnload()}),!1},Thingiverse.View.track_event=function(e){return!1},Thingiverse.View.track_page=function(e){_gaq&&_gaq.push(["_trackPageview",e])},Thingiverse.View.printable_thing=function(e){$("#printable-btn").load("/ajax/things/printable",{id:e})},Thingiverse.View.unprintable_thing=function(e){$("#printable-btn").load("/ajax/things/unprintable",{id:e})},Thingiverse.View.isSupported=function(e){return e in document.body.style},Thingiverse.View.formDataToObject=function(e){for(var a=e.serializeArray(),t={},n=0;n<a.length;n++)void 0!==a[n]&&(t[a[n].name]=a[n].value);return t},Thingiverse.View.trackEvent=function(e,a,t){$.ajax({type:"POST",url:"/ajax/event/track",data:{target_type:e,target_id:a,event_type:t}})},$.fn.serializeObject=function(){var e={},a=this.serializeArray();return $.each(a,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e};var $document=$(document);$document.on("ready",function(){"undefined"!=typeof webshims&&$.webshims.polyfill("forms"),$(window).on("resize",Thingiverse.View.hideOffCanvas),$document.on("pageLoaded",Thingiverse.View.formatTime),$document.on("click",".track",function(e){function a(e){return t.data(e)&&t.data("trackCategory").constructor===Array}var t=$(this),n=[];if(a("trackCategory")&&a("trackAction"))for(var i=Math.max(t.data("trackCategory").length,t.data("trackAction").length),o=0;i>o;o++)t.data("trackCategory")[o]&&t.data("trackAction")[o]&&(n=[],n.push(t.data("trackCategory")[o]),n.push(t.data("trackAction")[o]),t.data("trackLabel")&&t.data("trackLabel")[o]&&n.push(t.data("trackLabel")[o]),t.data("trackValue")&&t.data("trackValue")[o]&&n.push(t.data("trackValue")[o]),t.data("trackNoninteraction")&&t.data("trackNoninteraction")[o]&&n.push(t.data("trackNoninteraction")[o]),Thingiverse.View.track_event(n));else t.data("trackCategory")&&t.data("trackAction")&&(n.push(t.data("trackCategory")),n.push(t.data("trackAction")),t.data("trackLabel")&&n.push(t.data("trackLabel")),t.data("trackValue")&&n.push(t.data("trackValue")),t.data("trackNoninteraction")&&n.push(t.data("trackNoninteraction")),Thingiverse.View.track_event(n))}),$document.on("click",".toggle_follow",function(){var e=$(this);Thingiverse.View.toggle_follow(e.data("type"),e.data("id"),e)}),$(".expandable").on("click",function(){var e=$(this);e.toggleClass("expanded"),e.next(".expand_content").toggleClass("expanded")}),$(".thing-share").on("click",function(e){var a=$(this).find(".thing-social-share-icons");return a.hasClass("active")?void 0:($(this).find(".thing-social-share-icons").addClass("active"),!1)}),$("#thing-page-content").on("click",".pagination a",function(){var e=$(this).attr("href"),a=$("a.profile_nav_bttn.active").data("ajax"),t=1,n=new RegExp("(page:)(\\d+)",["i"]),i=n.exec(e);return null!==i&&(t=i[2]),t?($.when(Thingiverse.View.getContent({url:a+"&page="+t})).done(function(e){Thingiverse.View.updateContent(e,$("#ajax-loaded-content").addClass("active"))}).fail(function(e){}).always(function(e){$("html,body").animate({scrollTop:$(".thing-page-detail").offset().top-300},150)}),!1):void 0});var e,a,t,n=!!$(".list-things-page.page").length,i=!!$("#dashboard-page").length;if(n&&(e="/explore/",a={},t=function(){var t=e,n={0:$("div.first-nav ul.section-dropdown li.active a").data("slug"),1:$("div.second-nav.selected-child ul.section-dropdown li.active a").data("slug"),2:$("div.third-nav.selected-child ul.section-dropdown li.active a").data("slug")};for(var i in n){var o=n[i];o&&(t=t+o+"/")}updateUrl(t),a.base_url=t,Thingiverse.View.updateResults(n,a)},$("ul.section-dropdown a").on("click",function(e){return updateFilters($(this)),t(),e.preventDefault(),!1})),i&&(e="/dashboard/",a={},t=function(){var t=e,n={0:$("div.first-nav ul.section-dropdown li.active a").data("slug")};for(var i in n){var o=n[i];o&&(t=t+o+"/")}updateUrl(t),a.base_url=t,updateEventResults(n,a)},$("ul.section-dropdown a").on("click",function(e){return updateFilters($(this)),t(),e.preventDefault(),!1})),$(".subnav-wrapper:not(.disabled)").on("click",function(){$(this).toggleClass("expanded"),$(".subnav-wrapper.expanded").not(this).removeClass("expanded")}),$("body").on("click",function(e){var a=$(e.target);$("#off-canvas-toggle").is(":visible")||(a.parents("div.login").length||$("div.login").removeClass("expanded"),a.parents("div.subnav-wrapper").length||$("div.subnav-wrapper").removeClass("expanded"))}),$("#dashboard-page").on("click","a.dismiss_notification",function(e){var a=$(this);a.closest("div.row_item").addClass("dismissed"),Thingiverse.View.isSupported("transition")||$(this).trigger("transitionend"),e.preventDefault();var t=a.attr("data-ids");$.ajax({url:"/ajax/dashboard/delete_event/",type:"POST",data:{event_ids:t}})}).on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd","div.dismissed",function(){$(this).remove()}),$("a.show_analytics").on("click",function(e){$(this).parent().toggleClass("expanded"),e.preventDefault()}),$("#off-canvas-toggle").on("click",function(e){var a=$(e.target);return a.parents("div.dropdown-menu").length?void 0:($("#wrapper").toggleClass("show-menu"),$("#off-canvas").toggleClass("show"),!1)}),$("div.login").on("click",function(e){var a=$(e.target);a.parents("div.dropdown-menu").length||$(this).toggleClass("expanded")}).on("keydown",function(e){(38==e.which||40==e.which)&&e.stopPropagation()}),$document.on("click",'a[href*="p.click"]',function(e){$(this).attr("href","#")}),$(".toggle-search-form").length){var o=$(".toggle-search-form"),r=o.find("input"),s=!!r.val();o.find(".search-icon").on("click",function(){s?(r.val(""),o.submit()):($(this).toggleClass("active").parent().toggleClass("active"),r.focus())})}$document.trigger("pageLoaded")});Thingiverse.Welcome=function(){},Thingiverse.Welcome.Home={},Thingiverse.Welcome.Home.init=function(){var e=$(".welcome-slides"),i=null,n=$(".welcome-slides-nav"),t=!1,o=function(){e.carouFredSel({auto:!1,circular:!1,infinite:!1,items:{visible:{min:1,max:3},width:320,height:306},swipe:{onTouch:!0},direction:"left",width:"100%",height:306,scroll:{duration:400},pagination:{container:".welcome-slides-nav",anchorBuilder:function(e){return'<a href="#'+e+'"><div class="circle '+e+'"></div></a>'}},onWindowResize:"throttle"})};$(window).on(Thingiverse.resizeEvent,function(){i&&clearTimeout(i),i=setTimeout(function(){"hidden"===n.css("visibility")?t&&(e.trigger("destroy"),t=!1):t||(o(),t=!0)},100)}).trigger(Thingiverse.resizeEvent)},Thingiverse.Welcome.Collect={},Thingiverse.Welcome.Collect.View=function(){var e=function(){$("div.thing a").attr("target","_blank"),$("div.thing-interact >:not(.thing-collect)").addClass("disabled").removeAttr("href")};$(document).on("pageLoaded",e)};//# sourceMappingURL=sourcemaps/scripts-min-0cd66ad71a.js.map